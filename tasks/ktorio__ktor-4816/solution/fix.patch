diff --git a/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/HttpCache.kt b/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/HttpCache.kt
index dee1ef0a4..556f06edf 100644
--- a/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/HttpCache.kt
+++ b/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/HttpCache.kt
@@ -240,6 +240,17 @@ public class HttpCache private constructor(
                         plugin.findAndRefresh(response.call.request, response) ?: throw InvalidCacheStateException(
                             response.call.request.url
                         )
+                    if (responseFromCache.varyKeys().size != response.varyKeys().size) {
+                        LOGGER.warn(
+                            "Vary header mismatch on cached response for ${response.call.request.url}. " +
+                                "Received 304 Not Modified with Vary: ${response.varyKeys()} " +
+                                "but cached response has Vary: ${responseFromCache.varyKeys()}. " +
+                                "According to RFC 7232 ยง4.1 and RFC 9111 ยง4.1, " +
+                                "the server must include the full Vary header in 304 responses. " +
+                                "Falling back to missing cache logic. " +
+                                "Consider reporting this issue to the server maintainers."
+                        )
+                    }
 
                     scope.monitor.raise(HttpResponseFromCache, responseFromCache)
                     proceedWith(responseFromCache)
@@ -329,10 +340,8 @@ public class HttpCache private constructor(
             else -> publicStorageNew
         }
 
-        val varyKeysFrom304 = response.varyKeys()
-        val cache = findResponse(storage, varyKeysFrom304, url, request) ?: return null
-        val newVaryKeys = varyKeysFrom304.ifEmpty { cache.varyKeys }
-        storage.store(request.url, cache.copy(newVaryKeys, response.cacheExpires(isSharedClient)))
+        val cache = findResponse(storage, response.varyKeys(), url, request) ?: return null
+        storage.store(request.url, cache.copy(cache.varyKeys, response.cacheExpires(isSharedClient)))
         return cache.createResponse(request.call.client, request, response.coroutineContext)
     }
 
diff --git a/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/HttpCacheLegacy.kt b/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/HttpCacheLegacy.kt
index ec592f4c3..84fdd7a2d 100644
--- a/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/HttpCacheLegacy.kt
+++ b/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/HttpCacheLegacy.kt
@@ -66,6 +66,17 @@ internal suspend fun PipelineContext<HttpResponse, Unit>.interceptReceiveLegacy(
     if (response.status == HttpStatusCode.NotModified) {
         val responseFromCache = plugin.findAndRefresh(response.call.request, response)
             ?: throw InvalidCacheStateException(response.call.request.url)
+        if (responseFromCache.varyKeys().size != response.varyKeys().size) {
+            LOGGER.warn(
+                "Vary header mismatch on cached response for ${response.call.request.url}. " +
+                    "Received 304 Not Modified with Vary: ${response.varyKeys()} " +
+                    "but cached response has Vary: ${responseFromCache.varyKeys()}. " +
+                    "According to RFC 7232 ยง4.1 and RFC 9111 ยง4.1, " +
+                    "the server must include the full Vary header in 304 responses. " +
+                    "Proceeding with cached response despite mismatch. " +
+                    "Consider reporting this issue to the server maintainers."
+            )
+        }
 
         scope.monitor.raise(HttpCache.HttpResponseFromCache, responseFromCache)
         proceedWith(responseFromCache)
@@ -116,10 +127,11 @@ private fun HttpCache.findAndRefresh(request: HttpRequest, response: HttpRespons
 
     val storage = if (CacheControl.PRIVATE in cacheControl) privateStorage else publicStorage
 
-    val varyKeysFrom304 = response.varyKeys()
-    val cache = findResponse(storage, varyKeysFrom304, url, request) ?: return null
-    val newVaryKeys = varyKeysFrom304.ifEmpty { cache.varyKeys }
-    storage.store(url, HttpCacheEntry(response.cacheExpires(isSharedClient), newVaryKeys, cache.response, cache.body))
+    val cache = findResponse(storage, response.varyKeys(), url, request) ?: return null
+    storage.store(
+        url,
+        HttpCacheEntry(response.cacheExpires(isSharedClient), cache.varyKeys, cache.response, cache.body)
+    )
     return cache.produceResponse()
 }
 
diff --git a/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/storage/UnlimitedCacheStorage.kt b/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/storage/UnlimitedCacheStorage.kt
index bc514e021..917c0d149 100644
--- a/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/storage/UnlimitedCacheStorage.kt
+++ b/ktor-client/ktor-client-core/common/src/io/ktor/client/plugins/cache/storage/UnlimitedCacheStorage.kt
@@ -23,7 +23,7 @@ internal class UnlimitedCacheStorage : HttpCacheStorage() {
     override fun find(url: Url, varyKeys: Map<String, String>): HttpCacheEntry? {
         val data = store.computeIfAbsent(url) { ConcurrentSet() }
         return data.find {
-            varyKeys.all { (key, value) -> it.varyKeys[key] == value } && varyKeys.size == it.varyKeys.size
+            varyKeys.all { (key, value) -> it.varyKeys[key] == value }
         }
     }
 
@@ -45,7 +45,7 @@ internal class UnlimitedStorage : CacheStorage {
     override suspend fun find(url: Url, varyKeys: Map<String, String>): CachedResponseData? {
         val data = store.computeIfAbsent(url) { ConcurrentSet() }
         return data.find {
-            varyKeys.all { (key, value) -> it.varyKeys[key] == value } && varyKeys.size == it.varyKeys.size
+            varyKeys.all { (key, value) -> it.varyKeys[key] == value }
         }
     }
 
diff --git a/ktor-client/ktor-client-core/jvm/src/io/ktor/client/plugins/cache/storage/FileCacheStorage.kt b/ktor-client/ktor-client-core/jvm/src/io/ktor/client/plugins/cache/storage/FileCacheStorage.kt
index ac17d1086..eaee95be8 100644
--- a/ktor-client/ktor-client-core/jvm/src/io/ktor/client/plugins/cache/storage/FileCacheStorage.kt
+++ b/ktor-client/ktor-client-core/jvm/src/io/ktor/client/plugins/cache/storage/FileCacheStorage.kt
@@ -47,7 +47,7 @@ internal class CachingCacheStorage(
         }
         val data = store.getValue(url)
         return data.find {
-            varyKeys.all { (key, value) -> it.varyKeys[key] == value } && varyKeys.size == it.varyKeys.size
+            varyKeys.all { (key, value) -> it.varyKeys[key] == value }
         }
     }
 
@@ -83,7 +83,7 @@ private class FileCacheStorage(
     override suspend fun find(url: Url, varyKeys: Map<String, String>): CachedResponseData? {
         val data = readCache(key(url))
         return data.find {
-            varyKeys.all { (key, value) -> it.varyKeys[key] == value } && varyKeys.size == it.varyKeys.size
+            varyKeys.all { (key, value) -> it.varyKeys[key] == value }
         }
     }
 
