diff --git a/mockwebserver-deprecated/src/main/kotlin/okhttp3/mockwebserver/bridge.kt b/mockwebserver-deprecated/src/main/kotlin/okhttp3/mockwebserver/bridge.kt
index 37aa8b71e..edc69af61 100644
--- a/mockwebserver-deprecated/src/main/kotlin/okhttp3/mockwebserver/bridge.kt
+++ b/mockwebserver-deprecated/src/main/kotlin/okhttp3/mockwebserver/bridge.kt
@@ -79,9 +79,8 @@ internal fun MockResponse.wrap(): mockwebserver3.MockResponse {
       result.inTunnel()
       KeepOpen
     }
-    else -> socketPolicy.wrap()
+    else -> wrapSocketPolicy()
   }
-  result.http2ErrorCode = http2ErrorCode
   result.throttleBody(throttleBytesPerPeriod, getThrottlePeriod(MILLISECONDS), MILLISECONDS)
   result.bodyDelay(getBodyDelay(MILLISECONDS), MILLISECONDS)
   result.headersDelay(getHeadersDelay(MILLISECONDS), MILLISECONDS)
@@ -113,8 +112,8 @@ internal fun mockwebserver3.RecordedRequest.unwrap(): RecordedRequest {
   )
 }
 
-private fun SocketPolicy.wrap(): mockwebserver3.SocketPolicy {
-  return when (this) {
+private fun MockResponse.wrapSocketPolicy(): mockwebserver3.SocketPolicy {
+  return when (val socketPolicy = socketPolicy) {
     SocketPolicy.SHUTDOWN_SERVER_AFTER_RESPONSE -> ShutdownServerAfterResponse
     SocketPolicy.KEEP_OPEN -> KeepOpen
     SocketPolicy.DISCONNECT_AT_END -> DisconnectAtEnd
@@ -122,13 +121,13 @@ private fun SocketPolicy.wrap(): mockwebserver3.SocketPolicy {
     SocketPolicy.DISCONNECT_AFTER_REQUEST -> DisconnectAfterRequest
     SocketPolicy.DISCONNECT_DURING_REQUEST_BODY -> DisconnectDuringRequestBody
     SocketPolicy.DISCONNECT_DURING_RESPONSE_BODY -> DisconnectDuringResponseBody
-    SocketPolicy.DO_NOT_READ_REQUEST_BODY -> DoNotReadRequestBody
+    SocketPolicy.DO_NOT_READ_REQUEST_BODY -> DoNotReadRequestBody(http2ErrorCode)
     SocketPolicy.FAIL_HANDSHAKE -> FailHandshake
     SocketPolicy.SHUTDOWN_INPUT_AT_END -> ShutdownInputAtEnd
     SocketPolicy.SHUTDOWN_OUTPUT_AT_END -> ShutdownOutputAtEnd
     SocketPolicy.STALL_SOCKET_AT_START -> StallSocketAtStart
     SocketPolicy.NO_RESPONSE -> NoResponse
-    SocketPolicy.RESET_STREAM_AT_START -> ResetStreamAtStart
-    else -> error("Unexpected SocketPolicy: $this")
+    SocketPolicy.RESET_STREAM_AT_START -> ResetStreamAtStart(http2ErrorCode)
+    else -> error("Unexpected SocketPolicy: $socketPolicy")
   }
 }
diff --git a/mockwebserver/api/mockwebserver3.api b/mockwebserver/api/mockwebserver3.api
index ef2f07f75..99a9f9659 100644
--- a/mockwebserver/api/mockwebserver3.api
+++ b/mockwebserver/api/mockwebserver3.api
@@ -13,15 +13,13 @@ public final class mockwebserver3/MockResponse {
 	public fun <init> (ILokhttp3/Headers;Ljava/lang/String;)V
 	public fun <init> (ILokhttp3/Headers;Ljava/lang/String;Z)V
 	public fun <init> (ILokhttp3/Headers;Ljava/lang/String;ZLmockwebserver3/SocketPolicy;)V
-	public fun <init> (ILokhttp3/Headers;Ljava/lang/String;ZLmockwebserver3/SocketPolicy;I)V
-	public synthetic fun <init> (ILokhttp3/Headers;Ljava/lang/String;ZLmockwebserver3/SocketPolicy;IILkotlin/jvm/internal/DefaultConstructorMarker;)V
+	public synthetic fun <init> (ILokhttp3/Headers;Ljava/lang/String;ZLmockwebserver3/SocketPolicy;ILkotlin/jvm/internal/DefaultConstructorMarker;)V
 	public synthetic fun <init> (Lmockwebserver3/MockResponse$Builder;Lkotlin/jvm/internal/DefaultConstructorMarker;)V
 	public final fun getBody ()Lmockwebserver3/MockResponseBody;
 	public final fun getBodyDelayNanos ()J
 	public final fun getCode ()I
 	public final fun getHeaders ()Lokhttp3/Headers;
 	public final fun getHeadersDelayNanos ()J
-	public final fun getHttp2ErrorCode ()I
 	public final fun getInTunnel ()Z
 	public final fun getInformationalResponses ()Ljava/util/List;
 	public final fun getMessage ()Ljava/lang/String;
@@ -59,7 +57,6 @@ public final class mockwebserver3/MockResponse$Builder : java/lang/Cloneable {
 	public final fun code (I)Lmockwebserver3/MockResponse$Builder;
 	public final fun getBody ()Lmockwebserver3/MockResponseBody;
 	public final fun getCode ()I
-	public final fun getHttp2ErrorCode ()I
 	public final fun getInTunnel ()Z
 	public final fun getInformationalResponses ()Ljava/util/List;
 	public final fun getPushPromises ()Ljava/util/List;
@@ -71,13 +68,11 @@ public final class mockwebserver3/MockResponse$Builder : java/lang/Cloneable {
 	public final fun getWebSocketListener ()Lokhttp3/WebSocketListener;
 	public final fun headers (Lokhttp3/Headers;)Lmockwebserver3/MockResponse$Builder;
 	public final fun headersDelay (JLjava/util/concurrent/TimeUnit;)Lmockwebserver3/MockResponse$Builder;
-	public final fun http2ErrorCode (I)Lmockwebserver3/MockResponse$Builder;
 	public final fun inTunnel ()Lmockwebserver3/MockResponse$Builder;
 	public final fun removeHeader (Ljava/lang/String;)Lmockwebserver3/MockResponse$Builder;
 	public final fun setBody (Lmockwebserver3/MockResponseBody;)V
 	public final fun setCode (I)V
 	public final fun setHeader (Ljava/lang/String;Ljava/lang/Object;)Lmockwebserver3/MockResponse$Builder;
-	public final fun setHttp2ErrorCode (I)V
 	public final fun setSocketPolicy (Lmockwebserver3/SocketPolicy;)V
 	public final fun setStatus (Ljava/lang/String;)V
 	public final fun setStreamHandler (Lmockwebserver3/StreamHandler;)V
@@ -204,7 +199,10 @@ public final class mockwebserver3/SocketPolicy$DisconnectDuringResponseBody : mo
 }
 
 public final class mockwebserver3/SocketPolicy$DoNotReadRequestBody : mockwebserver3/SocketPolicy {
-	public static final field INSTANCE Lmockwebserver3/SocketPolicy$DoNotReadRequestBody;
+	public fun <init> ()V
+	public fun <init> (I)V
+	public synthetic fun <init> (IILkotlin/jvm/internal/DefaultConstructorMarker;)V
+	public final fun getHttp2ErrorCode ()I
 }
 
 public final class mockwebserver3/SocketPolicy$FailHandshake : mockwebserver3/SocketPolicy {
@@ -224,7 +222,10 @@ public final class mockwebserver3/SocketPolicy$NoResponse : mockwebserver3/Socke
 }
 
 public final class mockwebserver3/SocketPolicy$ResetStreamAtStart : mockwebserver3/SocketPolicy {
-	public static final field INSTANCE Lmockwebserver3/SocketPolicy$ResetStreamAtStart;
+	public fun <init> ()V
+	public fun <init> (I)V
+	public synthetic fun <init> (IILkotlin/jvm/internal/DefaultConstructorMarker;)V
+	public final fun getHttp2ErrorCode ()I
 }
 
 public final class mockwebserver3/SocketPolicy$ShutdownInputAtEnd : mockwebserver3/SocketPolicy {
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt b/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
index 826912907..ad33db3c7 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
@@ -61,13 +61,6 @@ class MockResponse {
 
   val socketPolicy: SocketPolicy
 
-  /**
-   * Sets the [HTTP/2 error code](https://tools.ietf.org/html/rfc7540#section-7) to be
-   * returned when resetting the stream. This is only valid with
-   * [SocketPolicy.ResetStreamAtStart] and [SocketPolicy.DoNotReadRequestBody].
-   */
-  val http2ErrorCode: Int
-
   val bodyDelayNanos: Long
   val headersDelayNanos: Long
 
@@ -82,7 +75,6 @@ class MockResponse {
     body: String = "",
     inTunnel: Boolean = false,
     socketPolicy: SocketPolicy = KeepOpen,
-    http2ErrorCode: Int = -1,
   ) : this(Builder()
     .apply {
       this.code = code
@@ -90,7 +82,6 @@ class MockResponse {
       if (inTunnel) inTunnel()
       this.body(body)
       this.socketPolicy = socketPolicy
-      this.http2ErrorCode = http2ErrorCode
     }
   )
 
@@ -106,7 +97,6 @@ class MockResponse {
     this.throttleBytesPerPeriod = builder.throttleBytesPerPeriod
     this.throttlePeriodNanos = builder.throttlePeriodNanos
     this.socketPolicy = builder.socketPolicy
-    this.http2ErrorCode = builder.http2ErrorCode
     this.bodyDelayNanos = builder.bodyDelayNanos
     this.headersDelayNanos = builder.headersDelayNanos
     this.pushPromises = builder.pushPromises.toList()
@@ -181,8 +171,6 @@ class MockResponse {
 
     var socketPolicy: SocketPolicy
 
-    var http2ErrorCode: Int
-
     internal var bodyDelayNanos: Long
 
     internal var headersDelayNanos: Long
@@ -205,7 +193,6 @@ class MockResponse {
       this.throttleBytesPerPeriod = Long.MAX_VALUE
       this.throttlePeriodNanos = 0L
       this.socketPolicy = KeepOpen
-      this.http2ErrorCode = -1
       this.bodyDelayNanos = 0L
       this.headersDelayNanos = 0L
       this.pushPromises = mutableListOf()
@@ -224,7 +211,6 @@ class MockResponse {
       this.throttleBytesPerPeriod = mockResponse.throttleBytesPerPeriod
       this.throttlePeriodNanos = mockResponse.throttlePeriodNanos
       this.socketPolicy = mockResponse.socketPolicy
-      this.http2ErrorCode = mockResponse.http2ErrorCode
       this.bodyDelayNanos = mockResponse.bodyDelayNanos
       this.headersDelayNanos = mockResponse.headersDelayNanos
       this.pushPromises = mockResponse.pushPromises.toMutableList()
@@ -341,11 +327,6 @@ class MockResponse {
       this.socketPolicy = socketPolicy
     }
 
-    /** Sets the HTTP/2 error code and returns this. */
-    fun http2ErrorCode(http2ErrorCode: Int) = apply {
-      this.http2ErrorCode = http2ErrorCode
-    }
-
     /**
      * Throttles the request reader and response writer to sleep for the given period after each
      * series of [bytesPerPeriod] bytes are transferred. Use this to simulate network behavior.
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt b/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
index a3783e9ef..331e845fb 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
@@ -587,7 +587,7 @@ class MockWebServer : Closeable {
 
       // See warnings associated with these socket policies in SocketPolicy.
       when (response.socketPolicy) {
-        DisconnectAtEnd, DoNotReadRequestBody -> {
+        DisconnectAtEnd, is DoNotReadRequestBody -> {
           socket.close()
           return false
         }
@@ -682,7 +682,7 @@ class MockWebServer : Closeable {
       ).buffer()
       requestBodySink.use {
         when {
-          policy.socketPolicy == DoNotReadRequestBody -> {
+          policy.socketPolicy is DoNotReadRequestBody -> {
             // Ignore the body completely.
           }
 
@@ -771,7 +771,7 @@ class MockWebServer : Closeable {
       extensions = WebSocketExtensions.parse(webSocketResponse.headers),
       minimumDeflateSize = 0L // Compress all messages if compression is enabled.
     )
-    webSocketResponse.webSocketListener!!.onOpen(webSocket, fancyResponse)
+    webSocketResponse.webSocketListener.onOpen(webSocket, fancyResponse)
     val name = "MockWebServer WebSocket ${request.path!!}"
     webSocket.initReaderAndWriter(name, streams)
     try {
@@ -909,9 +909,9 @@ class MockWebServer : Closeable {
     @Throws(IOException::class)
     override fun onStream(stream: Http2Stream) {
       val peekedResponse = dispatcher.peek()
-      if (peekedResponse.socketPolicy === ResetStreamAtStart) {
+      if (peekedResponse.socketPolicy is ResetStreamAtStart) {
         dispatchBookkeepingRequest(sequenceNumber.getAndIncrement(), socket)
-        stream.close(ErrorCode.fromHttp2(peekedResponse.http2ErrorCode)!!, null)
+        stream.close(ErrorCode.fromHttp2(peekedResponse.socketPolicy.http2ErrorCode)!!, null)
         return
       }
 
@@ -941,8 +941,8 @@ class MockWebServer : Closeable {
         DisconnectAtEnd -> {
           stream.connection.shutdown(ErrorCode.NO_ERROR)
         }
-        DoNotReadRequestBody -> {
-          stream.close(ErrorCode.fromHttp2(response.http2ErrorCode)!!, null)
+        is DoNotReadRequestBody -> {
+          stream.close(ErrorCode.fromHttp2(socketPolicy.http2ErrorCode)!!, null)
         }
         else -> {
         }
@@ -985,7 +985,7 @@ class MockWebServer : Closeable {
       val body = Buffer()
       val requestLine = "$method $path HTTP/1.1"
       var exception: IOException? = null
-      if (readBody && peek.streamHandler == null && peek.socketPolicy != DoNotReadRequestBody) {
+      if (readBody && peek.streamHandler == null && peek.socketPolicy !is DoNotReadRequestBody) {
         try {
           val contentLengthString = headers["content-length"]
           val requestBodySink = body.withThrottlingAndSocketPolicy(
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/SocketPolicy.kt b/mockwebserver/src/main/kotlin/mockwebserver3/SocketPolicy.kt
index 288dc5927..408be99a2 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/SocketPolicy.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/SocketPolicy.kt
@@ -77,10 +77,12 @@ sealed interface SocketPolicy {
 
   /**
    * Process the response without even attempting to reading the request body. For HTTP/2 this will
-   * send [MockResponse.getHttp2ErrorCode] after the response body or trailers. For HTTP/1 this will
-   * close the socket after the response body or trailers.
+   * send [http2ErrorCode] after the response body or trailers. For HTTP/1 this will close the
+   * socket after the response body or trailers.
    */
-  object DoNotReadRequestBody : SocketPolicy
+  class DoNotReadRequestBody(
+    val http2ErrorCode: Int = 0,
+  ) : SocketPolicy
 
   /** Don't trust the client during the SSL handshake. */
   object FailHandshake : SocketPolicy
@@ -112,7 +114,9 @@ sealed interface SocketPolicy {
   object NoResponse : SocketPolicy
 
   /**
-   * Fail HTTP/2 requests without processing them by sending an [MockResponse.http2ErrorCode].
+   * Fail HTTP/2 requests without processing them by sending [http2ErrorCode].
    */
-  object ResetStreamAtStart : SocketPolicy
+  class ResetStreamAtStart(
+    val http2ErrorCode: Int = 0,
+  ) : SocketPolicy
 }
