diff --git a/platforms/core-configuration/base-diagnostics/src/integTest/groovy/org/gradle/api/tasks/diagnostics/TaskGraphIntegrationTest.groovy b/platforms/core-configuration/base-diagnostics/src/integTest/groovy/org/gradle/api/tasks/diagnostics/TaskGraphIntegrationTest.groovy
index a8f2152e45c..876b8ed2a02 100644
--- a/platforms/core-configuration/base-diagnostics/src/integTest/groovy/org/gradle/api/tasks/diagnostics/TaskGraphIntegrationTest.groovy
+++ b/platforms/core-configuration/base-diagnostics/src/integTest/groovy/org/gradle/api/tasks/diagnostics/TaskGraphIntegrationTest.groovy
@@ -33,7 +33,7 @@ Tasks graph for: root
 \\--- :root (org.gradle.api.DefaultTask)
      +--- :leaf1 (org.gradle.api.DefaultTask)
      \\--- :middle (org.gradle.api.DefaultTask)
-          +--- :leaf1 (*)
+          +--- :leaf1 (org.gradle.api.DefaultTask) (*)
           \\--- :leaf2 (org.gradle.api.DefaultTask)
 
 (*) - details omitted (listed previously)
@@ -66,10 +66,10 @@ Tasks graph for: root r2
 +--- :root (org.gradle.api.DefaultTask)
 |    +--- :leaf1 (org.gradle.api.DefaultTask)
 |    \\--- :middle (org.gradle.api.DefaultTask)
-|         +--- :leaf1 (*)
+|         +--- :leaf1 (org.gradle.api.DefaultTask) (*)
 |         \\--- :leaf2 (org.gradle.api.DefaultTask)
 \\--- :root2 (org.gradle.api.DefaultTask)
-     \\--- :leaf2 (*)
+     \\--- :leaf2 (org.gradle.api.DefaultTask) (*)
 
 (*) - details omitted (listed previously)
 """)
@@ -114,7 +114,7 @@ Tasks graph for: root r2
 +--- :root (org.gradle.api.DefaultTask)
 |    +--- :leaf1 (org.gradle.api.DefaultTask)
 |    \\--- :middle (org.gradle.api.DefaultTask)
-|         +--- :leaf1 (*)
+|         +--- :leaf1 (org.gradle.api.DefaultTask) (*)
 |         \\--- :leaf2 (org.gradle.api.DefaultTask)
 \\--- :root2 (org.gradle.api.DefaultTask)
      \\--- other build task :included:fromIncluded (org.gradle.api.DefaultTask)
@@ -174,7 +174,7 @@ Tasks graph for: :included:fromIncluded
      +--- :included:leaf2 (org.gradle.api.DefaultTask)
      +--- :included:middle (org.gradle.api.DefaultTask)
      |    +--- :included:leaf1 (org.gradle.api.DefaultTask)
-     |    \\--- :included:leaf2 (*)
+     |    \\--- :included:leaf2 (org.gradle.api.DefaultTask) (*)
      \\--- :included:leaf3 (org.gradle.api.DefaultTask, finalizer)
 
 (*) - details omitted (listed previously)
@@ -196,7 +196,7 @@ Tasks graph for: fromIncluded
      +--- :leaf2 (org.gradle.api.DefaultTask)
      +--- :middle (org.gradle.api.DefaultTask)
      |    +--- :leaf1 (org.gradle.api.DefaultTask)
-     |    \\--- :leaf2 (*)
+     |    \\--- :leaf2 (org.gradle.api.DefaultTask) (*)
      \\--- :leaf3 (org.gradle.api.DefaultTask, finalizer)
 
 (*) - details omitted (listed previously)
@@ -218,7 +218,7 @@ Tasks graph for: root
 \\--- :root (org.gradle.api.DefaultTask)
      +--- :leaf1 (org.gradle.api.DefaultTask)
      \\--- :middle (org.gradle.api.DefaultTask)
-          +--- :leaf1 (*)
+          +--- :leaf1 (org.gradle.api.DefaultTask) (*)
           \\--- :leaf2 (org.gradle.api.DefaultTask)
 
 (*) - details omitted (listed previously)
@@ -266,7 +266,7 @@ Tasks graph for: jar
      |    +--- :compileJava (org.gradle.api.tasks.compile.JavaCompile)
      |    |    \\--- :buildSorcerer (org.gradle.api.DefaultTask)
      |    \\--- :processResources (org.gradle.language.jvm.tasks.ProcessResources)
-     \\--- :compileJava (*)
+     \\--- :compileJava (org.gradle.api.tasks.compile.JavaCompile) (*)
 
 (*) - details omitted (listed previously)
 """)
@@ -315,7 +315,7 @@ Tasks graph for: root
 \\--- :root (org.gradle.api.DefaultTask)
      +--- :leaf1 (org.gradle.api.DefaultTask)
      \\--- :middle (org.gradle.api.DefaultTask)
-          +--- :leaf1 (*)
+          +--- :leaf1 (org.gradle.api.DefaultTask) (*)
           \\--- :leaf2 (org.gradle.api.DefaultTask)
 
 (*) - details omitted (listed previously)
@@ -342,16 +342,16 @@ Tasks graph for: jar
      |    |         \\--- :generatePluginAdapters (org.gradle.plugin.devel.internal.precompiled.GeneratePluginAdaptersTask)
      |    |              \\--- :extractPluginRequests (org.gradle.plugin.devel.internal.precompiled.ExtractPluginRequestsTask)
      |    +--- :compileGroovyPlugins (org.gradle.plugin.devel.internal.precompiled.CompileGroovyScriptPluginsTask)
-     |    |    +--- :compileGroovy (*)
-     |    |    \\--- :compileJava (*)
-     |    +--- :compileJava (*)
-     |    +--- :extractPluginRequests (*)
+     |    |    +--- :compileGroovy (org.gradle.api.tasks.compile.GroovyCompile) (*)
+     |    |    \\--- :compileJava (org.gradle.api.tasks.compile.JavaCompile) (*)
+     |    +--- :compileJava (org.gradle.api.tasks.compile.JavaCompile) (*)
+     |    +--- :extractPluginRequests (org.gradle.plugin.devel.internal.precompiled.ExtractPluginRequestsTask) (*)
      |    \\--- :processResources (org.gradle.language.jvm.tasks.ProcessResources)
      |         \\--- :pluginDescriptors (org.gradle.plugin.devel.tasks.GeneratePluginDescriptors)
-     +--- :compileGroovy (*)
-     +--- :compileGroovyPlugins (*)
-     +--- :compileJava (*)
-     \\--- :extractPluginRequests (*)
+     +--- :compileGroovy (org.gradle.api.tasks.compile.GroovyCompile) (*)
+     +--- :compileGroovyPlugins (org.gradle.plugin.devel.internal.precompiled.CompileGroovyScriptPluginsTask) (*)
+     +--- :compileJava (org.gradle.api.tasks.compile.JavaCompile) (*)
+     \\--- :extractPluginRequests (org.gradle.plugin.devel.internal.precompiled.ExtractPluginRequestsTask) (*)
 
 (*) - details omitted (listed previously)
 """)
@@ -396,7 +396,7 @@ Tasks graph for: root
 \\--- :root (org.gradle.api.DefaultTask)
      +--- :leaf1 (org.gradle.api.DefaultTask)
      \\--- :middle (org.gradle.api.DefaultTask, disabled)
-          +--- :leaf1 (*)
+          +--- :leaf1 (org.gradle.api.DefaultTask) (*)
           \\--- :leaf2 (org.gradle.api.DefaultTask)
 
 (*) - details omitted (listed previously)
@@ -436,7 +436,7 @@ Tasks graph for: root root2
 |         +--- :leaf1 (org.gradle.api.DefaultTask)
 |         \\--- :leaf2 (org.gradle.api.DefaultTask)
 \\--- :root2 (org.gradle.api.DefaultTask)
-     \\--- :leaf1 (*)
+     \\--- :leaf1 (org.gradle.api.DefaultTask) (*)
 
 (*) - details omitted (listed previously)
 """)
@@ -474,7 +474,7 @@ Tasks graph for: root root2
 |         +--- :leaf1 (org.gradle.api.DefaultTask)
 |         \\--- :leaf2 (org.gradle.api.DefaultTask)
 \\--- :root2 (org.gradle.api.DefaultTask)
-     +--- :leaf1 (*)
+     +--- :leaf1 (org.gradle.api.DefaultTask) (*)
      \\--- :leaf4 (org.gradle.api.DefaultTask, finalizer)
           \\--- :leaf3 (org.gradle.api.DefaultTask)
 
@@ -501,7 +501,7 @@ Tasks graph for: clean root
 \\--- :root (org.gradle.api.DefaultTask)
      +--- :leaf1 (org.gradle.api.DefaultTask)
      \\--- :middle (org.gradle.api.DefaultTask)
-          +--- :leaf1 (*)
+          +--- :leaf1 (org.gradle.api.DefaultTask) (*)
           \\--- :leaf2 (org.gradle.api.DefaultTask)
 
 (*) - details omitted (listed previously)
@@ -775,7 +775,7 @@ Tasks graph for: root
      |         \\--- :lib:libleaf1 (org.gradle.api.DefaultTask)
      +--- :app:leaf1 (org.gradle.api.DefaultTask)
      \\--- :app:middle (org.gradle.api.DefaultTask)
-          +--- :app:leaf1 (*)
+          +--- :app:leaf1 (org.gradle.api.DefaultTask) (*)
           \\--- :app:leaf2 (org.gradle.api.DefaultTask)
 
 (*) - details omitted (listed previously)
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorsClassPath.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorsClassPath.kt
index adc8699d2b3..9e9cee4d417 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorsClassPath.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorsClassPath.kt
@@ -73,6 +73,7 @@ import org.jetbrains.org.objectweb.asm.signature.SignatureReader
 import org.jetbrains.org.objectweb.asm.signature.SignatureVisitor
 import java.io.Closeable
 import java.io.File
+import java.util.concurrent.ConcurrentHashMap
 import javax.inject.Inject
 
 
@@ -86,19 +87,28 @@ class ProjectAccessorsClassPathGenerator @Inject internal constructor(
     private val asyncIO: AsyncIOScopeFactory,
 ) {
 
-    fun projectAccessorsClassPath(scriptTarget: ExtensionAware, classPath: ClassPath): AccessorsClassPath =
-        scriptTarget.getOrCreateProperty("gradleKotlinDsl.accessorsClassPath") {
-            buildAccessorsClassPathFor(scriptTarget, classPath)
+    private
+    val classPathCache = ConcurrentHashMap<ClassLoaderScope, AccessorsClassPath>()
+
+    fun projectAccessorsClassPath(scriptTarget: ExtensionAware, classPath: ClassPath): AccessorsClassPath {
+        val classLoaderScope = classLoaderScopeOf(scriptTarget)
+        if (classLoaderScope == null) {
+            return AccessorsClassPath.empty
+        }
+        return classPathCache.computeIfAbsent(classLoaderScope) {
+            buildAccessorsClassPathFor(classLoaderScope, scriptTarget, classPath)
                 ?: AccessorsClassPath.empty
         }
-
+    }
 
     private
-    fun buildAccessorsClassPathFor(scriptTarget: Any, classPath: ClassPath): AccessorsClassPath? =
-        classLoaderScopeOf(scriptTarget)
-            ?.let { classLoaderScope ->
-                configuredProjectSchemaOf(scriptTarget, classLoaderScope)
-            }?.let { scriptTargetSchema ->
+    fun buildAccessorsClassPathFor(
+        classLoaderScope: ClassLoaderScope,
+        scriptTarget: Any,
+        classPath: ClassPath
+    ): AccessorsClassPath? =
+        configuredProjectSchemaOf(scriptTarget, classLoaderScope)
+            ?.let { scriptTargetSchema ->
                 val work = GenerateProjectAccessors(
                     scriptTarget,
                     scriptTargetSchema,
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/BuildScopeServices.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/BuildScopeServices.kt
index c74c6a038c8..56595d19d3a 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/BuildScopeServices.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/BuildScopeServices.kt
@@ -17,6 +17,7 @@
 package org.gradle.kotlin.dsl.accessors
 
 import org.gradle.api.internal.file.FileCollectionFactory
+import org.gradle.internal.build.BuildState
 import org.gradle.internal.execution.ExecutionEngine
 import org.gradle.internal.execution.InputFingerprinter
 import org.gradle.internal.hash.ClassLoaderHierarchyHasher
@@ -35,13 +36,15 @@ object BuildScopeServices : ServiceRegistrationProvider {
         fileCollectionFactory: FileCollectionFactory,
         executionEngine: ExecutionEngine,
         inputFingerprinter: InputFingerprinter,
-        workspaceProvider: KotlinDslWorkspaceProvider
+        workspaceProvider: KotlinDslWorkspaceProvider,
+        buildState: BuildState
     ) = Stage1BlocksAccessorClassPathGenerator(
         classLoaderHierarchyHasher,
         fileCollectionFactory,
         executionEngine,
         inputFingerprinter,
-        workspaceProvider
+        workspaceProvider,
+        buildState
     )
 
     @Provides
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/SingletonProperties.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/SingletonProperties.kt
deleted file mode 100644
index 1debe3202da..00000000000
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/SingletonProperties.kt
+++ /dev/null
@@ -1,31 +0,0 @@
-/*
- * Copyright 2017 the original author or authors.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.gradle.kotlin.dsl.accessors
-
-import org.gradle.api.plugins.ExtensionAware
-
-import org.gradle.kotlin.dsl.extra
-
-
-internal
-inline fun <reified T : Any> ExtensionAware.getOrCreateProperty(
-    property: String,
-    crossinline create: () -> T
-): T = extra.run {
-    if (has(property)) get(property) as T
-    else create().also { set(property, it) }
-}
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/Stage1BlocksAccessorClassPath.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/Stage1BlocksAccessorClassPath.kt
index 4294565490e..c8fee51c522 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/Stage1BlocksAccessorClassPath.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/Stage1BlocksAccessorClassPath.kt
@@ -21,6 +21,7 @@ import org.gradle.api.internal.catalog.ExternalModuleDependencyFactory
 import org.gradle.api.internal.file.FileCollectionFactory
 import org.gradle.api.internal.initialization.ClassLoaderScope
 import org.gradle.api.internal.project.ProjectInternal
+import org.gradle.internal.build.BuildState
 import org.gradle.internal.classpath.DefaultClassPath
 import org.gradle.internal.execution.ExecutionEngine
 import org.gradle.internal.execution.ImmutableUnitOfWork
@@ -60,18 +61,26 @@ class Stage1BlocksAccessorClassPathGenerator @Inject internal constructor(
     private val fileCollectionFactory: FileCollectionFactory,
     private val executionEngine: ExecutionEngine,
     private val inputFingerprinter: InputFingerprinter,
-    private val workspaceProvider: KotlinDslWorkspaceProvider
+    private val workspaceProvider: KotlinDslWorkspaceProvider,
+    private val buildState: BuildState,
 ) {
-    fun stage1BlocksAccessorClassPath(project: ProjectInternal): AccessorsClassPath =
-        project.owner.owner.projects.rootProject.mutableModel.let { rootProject ->
-            rootProject.getOrCreateProperty("gradleKotlinDsl.stage1AccessorsClassPath") {
-                val buildSrcClassLoaderScope = baseClassLoaderScopeOf(rootProject)
-                val classLoaderHash = requireNotNull(classLoaderHierarchyHasher.getClassLoaderHash(buildSrcClassLoaderScope.exportClassLoader))
-                val versionCatalogAccessors = generateVersionCatalogAccessors(rootProject, buildSrcClassLoaderScope, classLoaderHash)
-                val pluginSpecBuildersAccessors = generatePluginSpecBuildersAccessors(rootProject, buildSrcClassLoaderScope, classLoaderHash)
-                versionCatalogAccessors + pluginSpecBuildersAccessors
-            }
+
+    private
+    val stage1BlocksAccessorClassPath by lazy {
+        val rootProject = buildState.projects.rootProject.mutableModel
+        val buildSrcClassLoaderScope = baseClassLoaderScopeOf(rootProject)
+        val classLoaderHash = requireNotNull(classLoaderHierarchyHasher.getClassLoaderHash(buildSrcClassLoaderScope.exportClassLoader))
+        val versionCatalogAccessors = generateVersionCatalogAccessors(rootProject, buildSrcClassLoaderScope, classLoaderHash)
+        val pluginSpecBuildersAccessors = generatePluginSpecBuildersAccessors(rootProject, buildSrcClassLoaderScope, classLoaderHash)
+        versionCatalogAccessors + pluginSpecBuildersAccessors
+    }
+
+    fun stage1BlocksAccessorClassPath(project: ProjectInternal): AccessorsClassPath {
+        require(project.owner.owner === buildState) {
+            "$project belongs to a different build."
         }
+        return stage1BlocksAccessorClassPath
+    }
 
     private
     fun baseClassLoaderScopeOf(rootProject: Project) =
diff --git a/platforms/documentation/docs/src/docs/release/notes.md b/platforms/documentation/docs/src/docs/release/notes.md
index e85ab34ce7f..6b0c5bb0221 100644
--- a/platforms/documentation/docs/src/docs/release/notes.md
+++ b/platforms/documentation/docs/src/docs/release/notes.md
@@ -237,7 +237,7 @@ Tasks graph for: root r2
 |         +--- :leaf1 (org.gradle.api.DefaultTask)
 |         \--- :leaf2 (org.gradle.api.DefaultTask, disabled)
 \--- :root2 (org.gradle.api.DefaultTask)
-    +--- :leaf1 (*)
+    +--- :leaf1 (org.gradle.api.DefaultTask) (*)
     |--- other build task :included:fromIncluded (org.gradle.api.DefaultTask)
     \--- :leaf4 (org.gradle.api.DefaultTask, finalizer)
          \--- :leaf3 (org.gradle.api.DefaultTask)
diff --git a/platforms/native/platform-native/src/main/java/org/gradle/nativeplatform/internal/NativeDependentBinariesResolutionStrategy.java b/platforms/native/platform-native/src/main/java/org/gradle/nativeplatform/internal/NativeDependentBinariesResolutionStrategy.java
index d372e419e8c..4e7f0a4d42a 100644
--- a/platforms/native/platform-native/src/main/java/org/gradle/nativeplatform/internal/NativeDependentBinariesResolutionStrategy.java
+++ b/platforms/native/platform-native/src/main/java/org/gradle/nativeplatform/internal/NativeDependentBinariesResolutionStrategy.java
@@ -231,7 +231,7 @@ private List<DependentBinariesResolvedResult> doBuildResolvedResult(final Native
     private void onCircularDependencies(final State state, final Deque<NativeBinarySpecInternal> stack, NativeBinarySpecInternal target) {
         GraphNodeRenderer<NativeBinarySpecInternal> nodeRenderer = new GraphNodeRenderer<NativeBinarySpecInternal>() {
             @Override
-            public void renderTo(NativeBinarySpecInternal node, StyledTextOutput output, boolean alreadySeen) {
+            public void renderTo(NativeBinarySpecInternal node, StyledTextOutput output) {
                 String name = DependentComponentsUtils.getBuildScopedTerseName(node.getId());
                 output.withStyle(StyledTextOutput.Style.Identifier).text(name);
             }
diff --git a/subprojects/composite-builds/src/main/java/org/gradle/composite/internal/DefaultBuildController.java b/subprojects/composite-builds/src/main/java/org/gradle/composite/internal/DefaultBuildController.java
index fb12ea62229..e0271a87cf2 100644
--- a/subprojects/composite-builds/src/main/java/org/gradle/composite/internal/DefaultBuildController.java
+++ b/subprojects/composite-builds/src/main/java/org/gradle/composite/internal/DefaultBuildController.java
@@ -152,7 +152,7 @@ private static void checkForCyclesFor(TaskInternal task, Set<TaskInternal> visit
             List<Set<TaskInternal>> cycles = graphWalker.findCycles();
             Set<TaskInternal> cycle = cycles.get(0);
 
-            DirectedGraphRenderer<TaskInternal> graphRenderer = new DirectedGraphRenderer<>((node, output, alreadySeen) -> output.withStyle(StyledTextOutput.Style.Identifier).text(node.getIdentityPath()), (node, values, connectedNodes) -> visitDependenciesOf(node, dep -> {
+            DirectedGraphRenderer<TaskInternal> graphRenderer = new DirectedGraphRenderer<>((node, output) -> output.withStyle(StyledTextOutput.Style.Identifier).text(node.getIdentityPath()), (node, values, connectedNodes) -> visitDependenciesOf(node, dep -> {
                 if (cycle.contains(dep)) {
                     connectedNodes.add(dep);
                 }
diff --git a/subprojects/core/src/main/java/org/gradle/execution/plan/DetermineExecutionPlanAction.java b/subprojects/core/src/main/java/org/gradle/execution/plan/DetermineExecutionPlanAction.java
index 1d1390854a6..410f3f1ce92 100644
--- a/subprojects/core/src/main/java/org/gradle/execution/plan/DetermineExecutionPlanAction.java
+++ b/subprojects/core/src/main/java/org/gradle/execution/plan/DetermineExecutionPlanAction.java
@@ -307,7 +307,7 @@ private StringWriter renderOrderingCycle(Set<Node> nodes) {
         List<Node> cycle = sortedListOf(nodes);
 
         DirectedGraphRenderer<Node> graphRenderer = new DirectedGraphRenderer<>(
-            (it, output, alreadySeen) -> output.withStyle(StyledTextOutput.Style.Identifier).text(it),
+            (it, output) -> output.withStyle(StyledTextOutput.Style.Identifier).text(it),
             (it, values, connectedNodes) -> {
                 for (Node dependency : cycle) {
                     Set<Node> successors = Sets.newHashSet(it.getHardSuccessors());
diff --git a/subprojects/core/src/main/java/org/gradle/internal/execution/TaskGraphBuildExecutionAction.java b/subprojects/core/src/main/java/org/gradle/internal/execution/TaskGraphBuildExecutionAction.java
index c0bf5b7acc0..856574a03f5 100644
--- a/subprojects/core/src/main/java/org/gradle/internal/execution/TaskGraphBuildExecutionAction.java
+++ b/subprojects/core/src/main/java/org/gradle/internal/execution/TaskGraphBuildExecutionAction.java
@@ -83,16 +83,14 @@ public ExecutionResult<Void> execute(GradleInternal gradle, FinalizedExecutionPl
     private static class NodeRenderer implements GraphNodeRenderer<TaskInfo> {
 
         @Override
-        public void renderTo(TaskInfo node, StyledTextOutput output, boolean alreadySeen) {
+        public void renderTo(TaskInfo node, StyledTextOutput output) {
             output
                 .withStyle(StyledTextOutput.Style.Identifier).text(node.getId());
 
-            if (!alreadySeen) {
-                String description = node.getDescription();
-                if (!description.isEmpty()) {
-                    output.text(" ");
-                    output.withStyle(StyledTextOutput.Style.Description).text(description);
-                }
+            String description = node.getDescription();
+            if (!description.isEmpty()) {
+                output.text(" ");
+                output.withStyle(StyledTextOutput.Style.Description).text(description);
             }
         }
     }
diff --git a/subprojects/core/src/main/java/org/gradle/internal/graph/DirectedGraphRenderer.java b/subprojects/core/src/main/java/org/gradle/internal/graph/DirectedGraphRenderer.java
index a3343017821..54c668d1002 100644
--- a/subprojects/core/src/main/java/org/gradle/internal/graph/DirectedGraphRenderer.java
+++ b/subprojects/core/src/main/java/org/gradle/internal/graph/DirectedGraphRenderer.java
@@ -16,14 +16,10 @@
 package org.gradle.internal.graph;
 
 import org.gradle.api.Action;
-import org.gradle.internal.logging.text.StreamingStyledTextOutput;
 import org.gradle.internal.logging.text.StyledTextOutput;
+import org.gradle.internal.logging.text.StreamingStyledTextOutput;
 
-import java.util.ArrayList;
-import java.util.Collection;
-import java.util.HashSet;
-import java.util.List;
-import java.util.Set;
+import java.util.*;
 
 import static org.gradle.internal.logging.text.StyledTextOutput.Style.Info;
 
@@ -58,7 +54,7 @@ private void renderTo(final N node, GraphRenderer graphRenderer, Collection<N> r
         graphRenderer.visit(new Action<StyledTextOutput>() {
             @Override
             public void execute(StyledTextOutput output) {
-                nodeRenderer.renderTo(node, output, alreadySeen);
+                nodeRenderer.renderTo(node, output);
                 if (alreadySeen) {
                     output.text(" (*)");
                 }
diff --git a/subprojects/core/src/main/java/org/gradle/internal/graph/GraphNodeRenderer.java b/subprojects/core/src/main/java/org/gradle/internal/graph/GraphNodeRenderer.java
index 4df5701e280..652ee095a3d 100644
--- a/subprojects/core/src/main/java/org/gradle/internal/graph/GraphNodeRenderer.java
+++ b/subprojects/core/src/main/java/org/gradle/internal/graph/GraphNodeRenderer.java
@@ -18,5 +18,5 @@
 import org.gradle.internal.logging.text.StyledTextOutput;
 
 public interface GraphNodeRenderer<N> {
-    void renderTo(N node, StyledTextOutput output, boolean alreadySeen);
+    void renderTo(N node, StyledTextOutput output);
 }
diff --git a/subprojects/core/src/test/groovy/org/gradle/internal/graph/DirectedGraphRendererTest.groovy b/subprojects/core/src/test/groovy/org/gradle/internal/graph/DirectedGraphRendererTest.groovy
index 690600f8793..0c9b1989ac8 100644
--- a/subprojects/core/src/test/groovy/org/gradle/internal/graph/DirectedGraphRendererTest.groovy
+++ b/subprojects/core/src/test/groovy/org/gradle/internal/graph/DirectedGraphRendererTest.groovy
@@ -23,7 +23,7 @@ import spock.lang.Specification
 class DirectedGraphRendererTest extends Specification {
     final DirectedGraph<String, Void> graph = Mock(DirectedGraph)
     final GraphNodeRenderer<String> nodeRenderer = Stub(GraphNodeRenderer) {
-        renderTo(_, _, _) >> { String node, StyledTextOutput output, boolean seen -> output.text("[$node]${seen ? "(seen)" : ""}")}
+        renderTo(_, _) >> { String node, StyledTextOutput output -> output.text("[$node]")}
     }
     final DirectedGraphRenderer<String> renderer = new DirectedGraphRenderer<String>(nodeRenderer, graph)
     final TestStyledTextOutput output = new TestStyledTextOutput()
@@ -75,7 +75,7 @@ class DirectedGraphRendererTest extends Specification {
 {info}+--- {normal}[2]
 {info}|    \\--- {normal}[4]
 {info}\\--- {normal}[3]
-{info}     \\--- {normal}[2](seen) (*)
+{info}     \\--- {normal}[2] (*)
 
 {info}(*) - details omitted (listed previously){normal}
 """
@@ -94,8 +94,8 @@ class DirectedGraphRendererTest extends Specification {
         output.value == """[1]
 {info}+--- {normal}[2]
 {info}|    \\--- {normal}[3]
-{info}|         \\--- {normal}[2](seen) (*)
-{info}\\--- {normal}[3](seen) (*)
+{info}|         \\--- {normal}[2] (*)
+{info}\\--- {normal}[3] (*)
 
 {info}(*) - details omitted (listed previously){normal}
 """
@@ -110,7 +110,7 @@ class DirectedGraphRendererTest extends Specification {
 
         then:
         output.value == """[1]
-{info}\\--- {normal}[1](seen) (*)
+{info}\\--- {normal}[1] (*)
 
 {info}(*) - details omitted (listed previously){normal}
 """
diff --git a/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/IsolatedProjectsGradleceptionSyncTest.groovy b/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/IsolatedProjectsGradleceptionSyncTest.groovy
index 0a8579f4b7e..6b54b6be1e7 100644
--- a/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/IsolatedProjectsGradleceptionSyncTest.groovy
+++ b/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/IsolatedProjectsGradleceptionSyncTest.groovy
@@ -33,7 +33,9 @@ class IsolatedProjectsGradleceptionSyncTest extends AbstractIdeSyncTest {
 
         then:
         fixture.assertHtmlReportHasProblems {
-            totalProblemsCount = 211
+            // In gradle/gradle total problems count depends on amount of subprojects.
+            // We want to avoid useless test failures
+            ignoreTotalProblemsCount = true
             withLocatedProblem("Build file 'testing/architecture-test/build.gradle.kts'", "Project ':architecture-test' cannot access 'Project.tasks' functionality on another project ':'")
             withLocatedProblem("Plugin class 'JetGradlePlugin'", "Project ':' cannot access 'Project.extensions' functionality on subprojects via 'allprojects'")
         }
diff --git a/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/fixtures/HasConfigurationCacheProblemsInReportSpec.groovy b/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/fixtures/HasConfigurationCacheProblemsInReportSpec.groovy
index 205ba233b73..2cb18918b88 100644
--- a/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/fixtures/HasConfigurationCacheProblemsInReportSpec.groovy
+++ b/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/fixtures/HasConfigurationCacheProblemsInReportSpec.groovy
@@ -29,6 +29,8 @@ class HasConfigurationCacheProblemsInReportSpec {
     @Nullable
     Integer totalProblemsCount
 
+    boolean ignoreTotalProblemsCount
+
     void validateSpec() {
         def totalCount = totalProblemsCount ?: locationsWithProblems.size()
         if (totalCount < locationsWithProblems.size()) {
diff --git a/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/fixtures/IsolatedProjectsIdeSyncFixture.groovy b/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/fixtures/IsolatedProjectsIdeSyncFixture.groovy
index 30a5c3f2175..e4ffaed425b 100644
--- a/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/fixtures/IsolatedProjectsIdeSyncFixture.groovy
+++ b/testing/smoke-ide-test/src/smokeIdeTest/groovy/org/gradle/ide/sync/fixtures/IsolatedProjectsIdeSyncFixture.groovy
@@ -59,7 +59,9 @@ class IsolatedProjectsIdeSyncFixture {
             Pair.of(location, message)
         }.unique()
 
-        assert jsModel.totalProblemCount == spec.totalProblemsCount
+        if (!spec.ignoreTotalProblemsCount) {
+            assert jsModel.totalProblemCount == spec.totalProblemsCount
+        }
         assert actualLocationsWithProblems.size() == spec.locationsWithProblems.size()
         assert actualLocationsWithProblems.every { actualLocation ->
             spec.locationsWithProblems.any { expectedLocation ->
