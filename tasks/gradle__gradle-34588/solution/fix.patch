diff --git a/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/ChecksumAndSignatureVerificationOverride.java b/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/ChecksumAndSignatureVerificationOverride.java
index dfeb431d4e1..6885f84e5e6 100644
--- a/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/ChecksumAndSignatureVerificationOverride.java
+++ b/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/ChecksumAndSignatureVerificationOverride.java
@@ -102,7 +102,7 @@ public ChecksumAndSignatureVerificationOverride(
             this.verifier = DependencyVerificationsXmlReader.readFromXml(
                 new FileInputStream(observed(verificationsFile))
             );
-            this.reportWriter = new DependencyVerificationReportWriter(gradleUserHome.toPath(), documentationRegistry, verificationsFile, verifier.getSuggestedWriteFlags(), reportsDirectory, gradlePropertiesFactory);
+            this.reportWriter = new DependencyVerificationReportWriter(gradleUserHome.toPath(), documentationRegistry, verificationsFile, verifier.getSuggestedWriteFlags(), reportsDirectory, gradlePropertiesFactory, verifier.getConfiguration().isUseKeyServers());
         } catch (FileNotFoundException e) {
             throw UncheckedException.throwAsUncheckedException(e);
         } catch (DependencyVerificationException e) {
diff --git a/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/report/DependencyVerificationReportWriter.java b/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/report/DependencyVerificationReportWriter.java
index b6e4854a0ba..624f7ff5783 100644
--- a/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/report/DependencyVerificationReportWriter.java
+++ b/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/report/DependencyVerificationReportWriter.java
@@ -58,12 +58,13 @@ public DependencyVerificationReportWriter(
         File verificationFile,
         List<String> writeFlags,
         File htmlReportOutputDirectory,
-        Factory<GradleProperties> gradlePropertiesProvider
+        Factory<GradleProperties> gradlePropertiesProvider,
+        boolean useKeyServers
     ) {
         this.gradleUserHome = gradleUserHome;
         this.rendererInitializer = () -> {
             this.summaryRenderer = createConsoleRenderer(gradleUserHome, documentationRegistry, gradlePropertiesProvider.create());
-            this.htmlRenderer = new HtmlDependencyVerificationReportRenderer(documentationRegistry, verificationFile, writeFlags, htmlReportOutputDirectory);
+            this.htmlRenderer = new HtmlDependencyVerificationReportRenderer(documentationRegistry, verificationFile, writeFlags, htmlReportOutputDirectory, useKeyServers);
         };
     }
 
diff --git a/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/report/HtmlDependencyVerificationReportRenderer.java b/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/report/HtmlDependencyVerificationReportRenderer.java
index 9f4f575375b..d690a240889 100644
--- a/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/report/HtmlDependencyVerificationReportRenderer.java
+++ b/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/ivyservice/ivyresolve/verification/report/HtmlDependencyVerificationReportRenderer.java
@@ -55,12 +55,15 @@ class HtmlDependencyVerificationReportRenderer implements DependencyVerification
     private final File verificationFile;
     private final List<String> writeFlags;
     private final File htmlReportOutputDirectory;
+    private boolean hasMissingKeys = false;
+    private boolean useKeyServers;
 
-    HtmlDependencyVerificationReportRenderer(DocumentationRegistry documentationRegistry, File verificationFile, List<String> writeFlags, File htmlReportOutputDirectory) {
+    HtmlDependencyVerificationReportRenderer(DocumentationRegistry documentationRegistry, File verificationFile, List<String> writeFlags, File htmlReportOutputDirectory, boolean useKeyServers) {
         this.documentationRegistry = documentationRegistry;
         this.verificationFile = verificationFile;
         this.writeFlags = writeFlags;
         this.htmlReportOutputDirectory = htmlReportOutputDirectory;
+        this.useKeyServers = useKeyServers;
     }
 
     @Override
@@ -187,10 +190,17 @@ private void registerStickyTip() {
             .append("            <p>Please review the errors reported above carefully.")
             .append("            Click on the icons near to the error descriptions for information about how to fix a particular problem.")
             .append("            It is recommended that you edit the ").append(verificationFileLink()).append(" manually. ")
-            .append("            However, if you are confident that those are false positives, Gradle can help you by generating the missing verification metadata.")
-            .append("            In this case, you can run with the following command-line:</p>")
-            .append("            <pre>gradle --write-verification-metadata ").append(verificationOptions()).append(" help</pre>")
-            .append("            <p>In any case you <b>must review the result</b> of this operation.")
+            .append("            However, if you are confident that those are false positives, Gradle can help you by generating the missing verification metadata.");
+
+            if (!useKeyServers && hasMissingKeys) {
+                contents.append("            In this case, you can ask Gradle to export all keys it used for verification of this build to the keyring with the following command-line:</p>")
+                        .append("            <pre>./gradlew --write-verification-metadata ").append(verificationOptions()).append(" --export-keys help</pre>");
+            } else {
+                contents.append("            In this case, you can run with the following command-line:</p>")
+                        .append("            <pre>./gradlew --write-verification-metadata ").append(verificationOptions()).append(" help</pre>");
+            }
+
+            contents.append("            <p>In any case you <b>must review the result</b> of this operation.")
             .append("            <p>Please refer to the <a href=\"").append(documentationRegistry.getDocumentationFor("dependency_verification")).append("\" target=\"_blank\">documentation</a> for more information.</p>\n")
             .append("        </div>\n")
             .append("    </div>\n");
@@ -392,6 +402,7 @@ private void reportSignatureProblems(VerificationFailure vf) {
                     case MISSING_KEY:
                         reason = warning("Key " + keyInfo + " couldn't be found in any key server so verification couldn't be performed");
                         reportItem(reason, "missing-key", "warning");
+                        hasMissingKeys = true;
                         break;
                 }
             });
