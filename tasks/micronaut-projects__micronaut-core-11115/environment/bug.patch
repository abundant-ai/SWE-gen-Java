diff --git a/.github/workflows/release.yml b/.github/workflows/release.yml
index 9efeb20405..f4bfd84acb 100644
--- a/.github/workflows/release.yml
+++ b/.github/workflows/release.yml
@@ -160,6 +160,6 @@ jobs:
       - name: Upload assets
         # Upload the artifacts to the existing release. Note that the SLSA provenance will
         # attest to each artifact file and not the aggregated ZIP file.
-        uses: softprops/action-gh-release@de2c0eb89ae2a093876385947365aca7b0e5f844 # v0.1.15
+        uses: softprops/action-gh-release@c062e08bd532815e2082a85e87e3ef29c3e6d191 # v2.0.8
         with:
           files: artifacts.zip
diff --git a/gradle.properties b/gradle.properties
index cfa6c8c104..a415efaa67 100644
--- a/gradle.properties
+++ b/gradle.properties
@@ -1,4 +1,4 @@
-projectVersion=4.6.3-SNAPSHOT
+projectVersion=4.6.4-SNAPSHOT
 projectGroupId=io.micronaut
 projectDesc=Core components supporting the Micronaut Framework
 title=Micronaut Core
diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
index 3fb363bbd4..07c85e5ba1 100644
--- a/gradle/libs.versions.toml
+++ b/gradle/libs.versions.toml
@@ -37,7 +37,7 @@ logback = "1.5.7"
 logbook-netty = "2.16.0"
 log4j = "2.23.1"
 micronaut-aws = "4.6.0"
-micronaut-build-plugins="7.2.0"
+micronaut-build-plugins="7.2.1"
 micronaut-groovy = "4.3.0"
 micronaut-session = "4.3.0"
 micronaut-sql = "5.3.0"
diff --git a/gradle/wrapper/gradle-wrapper.jar b/gradle/wrapper/gradle-wrapper.jar
index 2c3521197d..a4b76b9530 100644
Binary files a/gradle/wrapper/gradle-wrapper.jar and b/gradle/wrapper/gradle-wrapper.jar differ
diff --git a/gradle/wrapper/gradle-wrapper.properties b/gradle/wrapper/gradle-wrapper.properties
index 09523c0e54..9355b41557 100644
--- a/gradle/wrapper/gradle-wrapper.properties
+++ b/gradle/wrapper/gradle-wrapper.properties
@@ -1,6 +1,6 @@
 distributionBase=GRADLE_USER_HOME
 distributionPath=wrapper/dists
-distributionUrl=https\://services.gradle.org/distributions/gradle-8.9-bin.zip
+distributionUrl=https\://services.gradle.org/distributions/gradle-8.10-bin.zip
 networkTimeout=10000
 validateDistributionUrl=true
 zipStoreBase=GRADLE_USER_HOME
diff --git a/http-netty/src/main/java/io/micronaut/http/netty/body/NettyJsonHandler.java b/http-netty/src/main/java/io/micronaut/http/netty/body/NettyJsonHandler.java
index 019c94cb9e..ccee0728d6 100644
--- a/http-netty/src/main/java/io/micronaut/http/netty/body/NettyJsonHandler.java
+++ b/http-netty/src/main/java/io/micronaut/http/netty/body/NettyJsonHandler.java
@@ -20,6 +20,7 @@ import io.micronaut.context.annotation.Replaces;
 import io.micronaut.context.annotation.Requires;
 import io.micronaut.core.annotation.Internal;
 import io.micronaut.core.annotation.NonNull;
+import io.micronaut.core.annotation.Order;
 import io.micronaut.core.io.buffer.ByteBuffer;
 import io.micronaut.core.io.buffer.ByteBufferFactory;
 import io.micronaut.core.type.Argument;
@@ -56,6 +57,7 @@ import java.io.OutputStream;
  *
  * @param <T> The type
  */
+@Order(JsonMessageHandler.ORDER)
 @Singleton
 @Internal
 @Replaces(JsonMessageHandler.class)
diff --git a/http-netty/src/test/groovy/io/micronaut/http/netty/body/DefaultStringHandlerSpec.groovy b/http-netty/src/test/groovy/io/micronaut/http/netty/body/DefaultHandlerSpec.groovy
similarity index 80%
rename from http-netty/src/test/groovy/io/micronaut/http/netty/body/DefaultStringHandlerSpec.groovy
rename to http-netty/src/test/groovy/io/micronaut/http/netty/body/DefaultHandlerSpec.groovy
index 4c88da10d1..7c9536a6c6 100644
--- a/http-netty/src/test/groovy/io/micronaut/http/netty/body/DefaultStringHandlerSpec.groovy
+++ b/http-netty/src/test/groovy/io/micronaut/http/netty/body/DefaultHandlerSpec.groovy
@@ -22,11 +22,41 @@ import spock.lang.Specification
 import spock.lang.Unroll
 
 @MicronautTest
-class DefaultStringHandlerSpec extends Specification {
+class DefaultHandlerSpec extends Specification {
 
     @Inject
     DefaultMessageBodyHandlerRegistry bodyHandlerRegistry
 
+    void "test default writer / reader for ALL type"() {
+        when:
+            def writer = bodyHandlerRegistry.findWriter(Argument.listOf(SomeBean), MediaType.ALL_TYPE)
+
+        then:
+            writer.isPresent()
+            writer.get() instanceof NettyJsonHandler
+
+        when:
+            def reader = bodyHandlerRegistry.findReader(Argument.listOf(SomeBean), MediaType.ALL_TYPE)
+
+        then:
+            reader.isPresent()
+            reader.get() instanceof NettyJsonHandler
+    }
+
+    void "test default writer / reader for missing type"() {
+        when:
+            def writer = bodyHandlerRegistry.findWriter(Argument.listOf(SomeBean))
+
+        then:
+            writer.isEmpty()
+
+        when:
+            def reader = bodyHandlerRegistry.findReader(Argument.listOf(SomeBean))
+
+        then:
+            reader.isEmpty()
+    }
+
     @Unroll
     void "test string body handlers"() {
         when:
@@ -113,4 +143,6 @@ class DefaultStringHandlerSpec extends Specification {
         }
     }
 
+    class SomeBean {}
+
 }
diff --git a/http-server-netty/src/main/java/io/micronaut/http/server/netty/body/InputStreamBodyWriter.java b/http-server-netty/src/main/java/io/micronaut/http/server/netty/body/InputStreamBodyWriter.java
index b3ace0b391..04789a8456 100644
--- a/http-server-netty/src/main/java/io/micronaut/http/server/netty/body/InputStreamBodyWriter.java
+++ b/http-server-netty/src/main/java/io/micronaut/http/server/netty/body/InputStreamBodyWriter.java
@@ -31,7 +31,6 @@ import io.micronaut.http.netty.body.NettyWriteContext;
 import io.micronaut.http.server.netty.configuration.NettyHttpServerConfiguration;
 import io.micronaut.scheduling.TaskExecutors;
 import io.netty.handler.codec.http.DefaultHttpResponse;
-import io.netty.handler.codec.http.HttpHeaderNames;
 import jakarta.inject.Named;
 import jakarta.inject.Singleton;
 
@@ -59,7 +58,6 @@ public final class InputStreamBodyWriter extends AbstractFileBodyWriter implemen
 
     @Override
     public void writeTo(HttpRequest<?> request, MutableHttpResponse<InputStream> outgoingResponse, Argument<InputStream> type, MediaType mediaType, InputStream object, NettyWriteContext nettyContext) throws CodecException {
-        outgoingResponse.getHeaders().setIfMissing(HttpHeaderNames.CONTENT_TYPE, mediaType);
         if (outgoingResponse instanceof NettyMutableHttpResponse<?> nettyResponse) {
             final DefaultHttpResponse finalResponse = new DefaultHttpResponse(
                 nettyResponse.getNettyHttpVersion(),
diff --git a/http-server-netty/src/main/java/io/micronaut/http/server/netty/body/NettyBodyAdapter.java b/http-server-netty/src/main/java/io/micronaut/http/server/netty/body/NettyBodyAdapter.java
index 05a5d85ff2..6e6649add0 100644
--- a/http-server-netty/src/main/java/io/micronaut/http/server/netty/body/NettyBodyAdapter.java
+++ b/http-server-netty/src/main/java/io/micronaut/http/server/netty/body/NettyBodyAdapter.java
@@ -115,10 +115,10 @@ public final class NettyBodyAdapter implements BufferConsumer.Upstream, Subscrib
     @Override
     public void onSubscribe(Subscription s) {
         this.subscription = s;
-        long demand = this.demand.get();
-        s.request(demand);
         if (cancelled) {
             s.cancel();
+        } else {
+            s.request(1);
         }
     }
 
@@ -130,8 +130,11 @@ public final class NettyBodyAdapter implements BufferConsumer.Upstream, Subscrib
     }
 
     private void onNext0(ByteBuf bytes) {
-        demand.addAndGet(-bytes.readableBytes());
+        long newDemand = demand.addAndGet(-bytes.readableBytes());
         sharedBuffer.add(bytes);
+        if (newDemand > 0) {
+            subscription.request(1);
+        }
     }
 
     @Override
diff --git a/http-server-netty/src/main/java/io/micronaut/http/server/netty/handler/MultiplexedServerHandler.java b/http-server-netty/src/main/java/io/micronaut/http/server/netty/handler/MultiplexedServerHandler.java
index c27b9474a5..34adb5b5fb 100644
--- a/http-server-netty/src/main/java/io/micronaut/http/server/netty/handler/MultiplexedServerHandler.java
+++ b/http-server-netty/src/main/java/io/micronaut/http/server/netty/handler/MultiplexedServerHandler.java
@@ -298,11 +298,9 @@ abstract class MultiplexedServerHandler {
                     }
 
                     private void complete0() {
-                        if (!responseDone) {
+                        if (finish()) {
                             writeData(Unpooled.EMPTY_BUFFER, true, ctx.voidPromise());
-                            if (finish()) {
-                                flush();
-                            }
+                            flush();
                         }
                     }
 
diff --git a/http-server-netty/src/main/java/io/micronaut/http/server/netty/handler/PipeliningServerHandler.java b/http-server-netty/src/main/java/io/micronaut/http/server/netty/handler/PipeliningServerHandler.java
index 195ecc08da..bda0d6d987 100644
--- a/http-server-netty/src/main/java/io/micronaut/http/server/netty/handler/PipeliningServerHandler.java
+++ b/http-server-netty/src/main/java/io/micronaut/http/server/netty/handler/PipeliningServerHandler.java
@@ -1108,9 +1108,8 @@ public final class PipeliningServerHandler extends ChannelInboundHandlerAdapter
             }
 
             if (!removed) {
-                int n = buf.readableBytes();
                 writeCompressing(new DefaultHttpContent(buf), true, false);
-                incompleteWrittenBytes += n;
+                incompleteWrittenBytes += buf.readableBytes();
                 if (ctx.channel().isWritable()) {
                     writeSome();
                 }
diff --git a/http-server-netty/src/test/groovy/io/micronaut/http/server/netty/CompressionSpec.groovy b/http-server-netty/src/test/groovy/io/micronaut/http/server/netty/CompressionSpec.groovy
index b242ec85e1..3988309baa 100644
--- a/http-server-netty/src/test/groovy/io/micronaut/http/server/netty/CompressionSpec.groovy
+++ b/http-server-netty/src/test/groovy/io/micronaut/http/server/netty/CompressionSpec.groovy
@@ -10,7 +10,6 @@ import io.micronaut.http.annotation.Body
 import io.micronaut.http.annotation.Controller
 import io.micronaut.http.annotation.Get
 import io.micronaut.http.annotation.Post
-import io.micronaut.http.annotation.Produces
 import io.micronaut.http.client.HttpClient
 import io.micronaut.http.client.netty.NettyClientCustomizer
 import io.micronaut.http.netty.channel.ChannelPipelineCustomizer
@@ -145,44 +144,6 @@ class CompressionSpec extends Specification {
         HttpHeaderValues.SNAPPY    | new SnappyFrameEncoder()
     }
 
-    def compressionStream(ChannelHandler decompressor, CharSequence contentEncoding) {
-        given:
-        EmbeddedServer server = ApplicationContext.run(EmbeddedServer, ['spec.name': 'CompressionSpec'] + serverOptions())
-
-        byte[] uncompressed = new byte[100000]
-        ThreadLocalRandom.current().nextBytes(uncompressed)
-        server.applicationContext.getBean(Ctrl).data = uncompressed
-
-        def client = server.applicationContext.createBean(HttpClient, server.URI).toBlocking()
-
-        when:
-        byte[] compressed = client.retrieve(HttpRequest.GET("/compress-stream").header("Accept-Encoding", contentEncoding.toString()), byte[])
-        def compChannel = new EmbeddedChannel(decompressor)
-        compChannel.writeInbound(Unpooled.copiedBuffer(compressed))
-        compChannel.finish()
-        ByteBuf decompressed = Unpooled.buffer()
-        while (true) {
-            ByteBuf o = compChannel.readInbound()
-            if (o == null) {
-                break
-            }
-            decompressed.writeBytes(o)
-            o.release()
-        }
-        then:
-        ByteBufUtil.getBytes(decompressed) == uncompressed
-
-        cleanup:
-        client.close()
-        server.stop()
-
-        where:
-        contentEncoding            | decompressor
-        HttpHeaderValues.GZIP      | ZlibCodecFactory.newZlibDecoder(ZlibWrapper.GZIP)
-        HttpHeaderValues.DEFLATE   | ZlibCodecFactory.newZlibDecoder(ZlibWrapper.ZLIB)
-        HttpHeaderValues.SNAPPY    | new SnappyFrameDecoder()
-    }
-
     @Requires(property = "spec.name", value = "CompressionSpec")
     @Controller
     static class Ctrl {
@@ -197,12 +158,6 @@ class CompressionSpec extends Specification {
         void receive(@Body byte[] data) {
             this.data = data
         }
-
-        @Get("/compress-stream")
-        @Produces("text/plain")
-        InputStream sendStream() {
-            return new ByteArrayInputStream(data)
-        }
     }
 
     // the code below disables the automatic decompression in the http client so that we can see the compressed data in the test
diff --git a/http-server-netty/src/test/groovy/io/micronaut/http/server/netty/body/NettyBodyAdapterSpec.groovy b/http-server-netty/src/test/groovy/io/micronaut/http/server/netty/body/NettyBodyAdapterSpec.groovy
new file mode 100644
index 0000000000..029875c08c
--- /dev/null
+++ b/http-server-netty/src/test/groovy/io/micronaut/http/server/netty/body/NettyBodyAdapterSpec.groovy
@@ -0,0 +1,40 @@
+package io.micronaut.http.server.netty.body
+
+import io.netty.buffer.ByteBuf
+import io.netty.buffer.Unpooled
+import io.netty.channel.embedded.EmbeddedChannel
+import reactor.core.publisher.Flux
+import spock.lang.Specification
+
+class NettyBodyAdapterSpec extends Specification {
+    def 'empty buffers'() {
+        given:
+        def flux = Flux.just(Unpooled.EMPTY_BUFFER, Unpooled.wrappedBuffer(new byte[] {1, 2, 3}))
+        def adapter = NettyBodyAdapter.adapt(flux, new EmbeddedChannel().eventLoop())
+        def received = Unpooled.buffer()
+        def upstream = adapter.primary(new BufferConsumer() {
+            @Override
+            void add(ByteBuf buf) {
+                received.writeBytes(buf)
+                buf.release()
+            }
+
+            @Override
+            void complete() {
+            }
+
+            @Override
+            void error(Throwable e) {
+            }
+        })
+
+        expect:
+        !received.isReadable()
+
+        when:
+        upstream.start()
+        then:
+        received.isReadable()
+        received.readByte() == (byte) 1
+    }
+}
diff --git a/http/src/main/java/io/micronaut/http/MediaType.java b/http/src/main/java/io/micronaut/http/MediaType.java
index 97e7352934..a6f398d5b1 100644
--- a/http/src/main/java/io/micronaut/http/MediaType.java
+++ b/http/src/main/java/io/micronaut/http/MediaType.java
@@ -886,11 +886,38 @@ public class MediaType implements CharSequence {
         if (expectedContentType == this) {
             return true;
         }
-        String expectedType = expectedContentType.getType();
-        String expectedSubtype = expectedContentType.getSubtype();
-        boolean typeMatch = type.equals(WILDCARD) || type.equalsIgnoreCase(expectedType);
-        boolean subtypeMatch = subtype.equals(WILDCARD) || subtype.equalsIgnoreCase(expectedSubtype);
-        return typeMatch && subtypeMatch;
+        return matchesType(expectedContentType.getType()) && matchesSubtype(expectedContentType.getSubtype());
+    }
+
+    /**
+     * Check if the subtype matches.
+     *
+     * @param matchSubtype The subtype to match
+     * @return true if matches
+     * @since 4.6.3
+     */
+    public boolean matchesSubtype(String matchSubtype) {
+        return subtype.equals(WILDCARD) || subtype.equalsIgnoreCase(matchSubtype);
+    }
+
+    /**
+     * Check if the type matches.
+     * @param matchType The type to match
+     * @return true if matches
+     * @since 4.6.3
+     */
+    public boolean matchesType(String matchType) {
+        return type.equals(WILDCARD) || type.equalsIgnoreCase(matchType);
+    }
+
+    /**
+     * Check if the extension matches.
+     * @param matchExtension The extension to match
+     * @return true if matches
+     * @since 4.6.3
+     */
+    public boolean matchesExtension(String matchExtension) {
+        return extension.equalsIgnoreCase(ALL_TYPE.extension) || extension.equals(WILDCARD) || extension.equalsIgnoreCase(matchExtension);
     }
 
     /**
diff --git a/http/src/main/java/io/micronaut/http/body/DefaultMessageBodyHandlerRegistry.java b/http/src/main/java/io/micronaut/http/body/DefaultMessageBodyHandlerRegistry.java
index 0c72a2df53..7e64572407 100644
--- a/http/src/main/java/io/micronaut/http/body/DefaultMessageBodyHandlerRegistry.java
+++ b/http/src/main/java/io/micronaut/http/body/DefaultMessageBodyHandlerRegistry.java
@@ -134,6 +134,7 @@ public final class DefaultMessageBodyHandlerRegistry extends AbstractMessageBody
         @Override
         public <K extends BeanType<T>> Collection<K> filter(Class<T> beanType, Collection<K> candidates) {
             List<K> all = new ArrayList<>(candidates.size());
+            candidatesLoop:
             for (K candidate : candidates) {
                 String[] applicableTypes = candidate.getAnnotationMetadata().stringValues(annotationType);
                 if (applicableTypes.length == 0) {
@@ -141,9 +142,12 @@ public final class DefaultMessageBodyHandlerRegistry extends AbstractMessageBody
                     continue;
                 }
                 for (String mt : applicableTypes) {
-                    if (mediaTypes.contains(new MediaType(mt))) {
-                        all.add(candidate);
-                        break;
+                    MediaType mediaType = new MediaType(mt);
+                    for (MediaType m : mediaTypes) {
+                        if (m.matches(mediaType)) {
+                            all.add(candidate);
+                            continue candidatesLoop;
+                        }
                     }
                 }
             }
diff --git a/http/src/main/java/io/micronaut/http/body/TextPlainObjectBodyReader.java b/http/src/main/java/io/micronaut/http/body/TextPlainObjectBodyReader.java
index 75eebb3273..51bd22f8fe 100644
--- a/http/src/main/java/io/micronaut/http/body/TextPlainObjectBodyReader.java
+++ b/http/src/main/java/io/micronaut/http/body/TextPlainObjectBodyReader.java
@@ -62,7 +62,7 @@ public final class TextPlainObjectBodyReader<T> implements TypedMessageBodyReade
 
     @Override
     public boolean isReadable(Argument<T> type, MediaType mediaType) {
-        return mediaType == MediaType.TEXT_PLAIN_TYPE;
+        return mediaType != null && mediaType.matches(MediaType.TEXT_PLAIN_TYPE);
     }
 
     @Override
diff --git a/json-core/src/main/java/io/micronaut/json/body/JsonMessageHandler.java b/json-core/src/main/java/io/micronaut/json/body/JsonMessageHandler.java
index 878b235d50..505ffd9e3c 100644
--- a/json-core/src/main/java/io/micronaut/json/body/JsonMessageHandler.java
+++ b/json-core/src/main/java/io/micronaut/json/body/JsonMessageHandler.java
@@ -18,6 +18,7 @@ package io.micronaut.json.body;
 import io.micronaut.context.annotation.BootstrapContextCompatible;
 import io.micronaut.core.annotation.Experimental;
 import io.micronaut.core.annotation.NonNull;
+import io.micronaut.core.annotation.Order;
 import io.micronaut.core.io.buffer.ByteBuffer;
 import io.micronaut.core.io.buffer.ReferenceCounted;
 import io.micronaut.core.type.Argument;
@@ -52,6 +53,7 @@ import static java.lang.annotation.RetentionPolicy.RUNTIME;
  * @author Jonas Konrad
  * @since 4.0.0
  */
+@Order(JsonMessageHandler.ORDER)
 @Experimental
 @Singleton
 @JsonMessageHandler.ProducesJson
@@ -59,6 +61,11 @@ import static java.lang.annotation.RetentionPolicy.RUNTIME;
 @BootstrapContextCompatible
 public final class JsonMessageHandler<T> implements MessageBodyHandler<T> {
 
+    /**
+     * The JSON handler should be preferred if for any type.
+     */
+    public static final int ORDER = -10;
+
     private final JsonMapper jsonMapper;
 
     public JsonMessageHandler(JsonMapper jsonMapper) {
@@ -77,7 +84,7 @@ public final class JsonMessageHandler<T> implements MessageBodyHandler<T> {
 
     @Override
     public boolean isReadable(@NonNull Argument<T> type, MediaType mediaType) {
-        return mediaType != null && mediaType.getExtension().equals(MediaType.EXTENSION_JSON);
+        return mediaType != null && mediaType.matchesExtension(MediaType.EXTENSION_JSON);
     }
 
     private static CodecException decorateRead(Argument<?> type, IOException e) {
@@ -114,7 +121,7 @@ public final class JsonMessageHandler<T> implements MessageBodyHandler<T> {
 
     @Override
     public boolean isWriteable(@NonNull Argument<T> type, MediaType mediaType) {
-        return mediaType != null && mediaType.getExtension().equals(MediaType.EXTENSION_JSON);
+        return mediaType != null && mediaType.matchesExtension(MediaType.EXTENSION_JSON);
     }
 
     private static CodecException decorateWrite(Object object, IOException e) {
