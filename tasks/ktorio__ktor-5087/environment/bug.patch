diff --git a/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.api b/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.api
index 782586a57..ab79c66f8 100644
--- a/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.api
+++ b/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.api
@@ -385,14 +385,14 @@ public final class io/ktor/server/auth/OAuthAuthenticationProvider : io/ktor/ser
 
 public final class io/ktor/server/auth/OAuthAuthenticationProvider$Config : io/ktor/server/auth/AuthenticationProvider$Config {
 	public field client Lio/ktor/client/HttpClient;
-	public field providerLookup Lkotlin/jvm/functions/Function2;
-	public field urlProvider Lkotlin/jvm/functions/Function3;
+	public field providerLookup Lkotlin/jvm/functions/Function1;
+	public field urlProvider Lkotlin/jvm/functions/Function2;
 	public final fun getClient ()Lio/ktor/client/HttpClient;
-	public final fun getProviderLookup ()Lkotlin/jvm/functions/Function2;
-	public final fun getUrlProvider ()Lkotlin/jvm/functions/Function3;
+	public final fun getProviderLookup ()Lkotlin/jvm/functions/Function1;
+	public final fun getUrlProvider ()Lkotlin/jvm/functions/Function2;
 	public final fun setClient (Lio/ktor/client/HttpClient;)V
-	public final fun setProviderLookup (Lkotlin/jvm/functions/Function2;)V
-	public final fun setUrlProvider (Lkotlin/jvm/functions/Function3;)V
+	public final fun setProviderLookup (Lkotlin/jvm/functions/Function1;)V
+	public final fun setUrlProvider (Lkotlin/jvm/functions/Function2;)V
 }
 
 public abstract class io/ktor/server/auth/OAuthCallback {
diff --git a/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.klib.api b/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.klib.api
index 88ea30f65..cadc6c1c0 100644
--- a/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.klib.api
+++ b/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.klib.api
@@ -242,11 +242,11 @@ final class io.ktor.server.auth/OAuthAuthenticationProvider : io.ktor.server.aut
             final fun <get-client>(): io.ktor.client/HttpClient // io.ktor.server.auth/OAuthAuthenticationProvider.Config.client.<get-client>|<get-client>(){}[0]
             final fun <set-client>(io.ktor.client/HttpClient) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.client.<set-client>|<set-client>(io.ktor.client.HttpClient){}[0]
         final var providerLookup // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup|{}providerLookup[0]
-            final fun <get-providerLookup>(): kotlin.coroutines/SuspendFunction1<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings?> // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup.<get-providerLookup>|<get-providerLookup>(){}[0]
-            final fun <set-providerLookup>(kotlin.coroutines/SuspendFunction1<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings?>) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup.<set-providerLookup>|<set-providerLookup>(kotlin.coroutines.SuspendFunction1<io.ktor.server.application.ApplicationCall,io.ktor.server.auth.OAuthServerSettings?>){}[0]
+            final fun <get-providerLookup>(): kotlin/Function1<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings?> // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup.<get-providerLookup>|<get-providerLookup>(){}[0]
+            final fun <set-providerLookup>(kotlin/Function1<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings?>) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup.<set-providerLookup>|<set-providerLookup>(kotlin.Function1<io.ktor.server.application.ApplicationCall,io.ktor.server.auth.OAuthServerSettings?>){}[0]
         final var urlProvider // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider|{}urlProvider[0]
-            final fun <get-urlProvider>(): kotlin.coroutines/SuspendFunction2<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings, kotlin/String> // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider.<get-urlProvider>|<get-urlProvider>(){}[0]
-            final fun <set-urlProvider>(kotlin.coroutines/SuspendFunction2<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings, kotlin/String>) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider.<set-urlProvider>|<set-urlProvider>(kotlin.coroutines.SuspendFunction2<io.ktor.server.application.ApplicationCall,io.ktor.server.auth.OAuthServerSettings,kotlin.String>){}[0]
+            final fun <get-urlProvider>(): kotlin/Function2<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings, kotlin/String> // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider.<get-urlProvider>|<get-urlProvider>(){}[0]
+            final fun <set-urlProvider>(kotlin/Function2<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings, kotlin/String>) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider.<set-urlProvider>|<set-urlProvider>(kotlin.Function2<io.ktor.server.application.ApplicationCall,io.ktor.server.auth.OAuthServerSettings,kotlin.String>){}[0]
     }
 }
 
diff --git a/ktor-server/ktor-server-plugins/ktor-server-auth/common/src/io/ktor/server/auth/OAuthProcedure.kt b/ktor-server/ktor-server-plugins/ktor-server-auth/common/src/io/ktor/server/auth/OAuthProcedure.kt
index b259c6c4d..6ebea5d2b 100644
--- a/ktor-server/ktor-server-plugins/ktor-server-auth/common/src/io/ktor/server/auth/OAuthProcedure.kt
+++ b/ktor-server/ktor-server-plugins/ktor-server-auth/common/src/io/ktor/server/auth/OAuthProcedure.kt
@@ -29,8 +29,8 @@ public val OAuthKey: Any = "OAuth"
 public class OAuthAuthenticationProvider internal constructor(config: Config) : AuthenticationProvider(config) {
 
     internal val client: HttpClient = config.client
-    internal val providerLookup: suspend ApplicationCall.() -> OAuthServerSettings? = config.providerLookup
-    internal val urlProvider: suspend ApplicationCall.(OAuthServerSettings) -> String = config.urlProvider
+    internal val providerLookup: ApplicationCall.() -> OAuthServerSettings? = config.providerLookup
+    internal val urlProvider: ApplicationCall.(OAuthServerSettings) -> String = config.urlProvider
 
     override suspend fun onAuthenticate(context: AuthenticationContext) {
         if (PlatformUtils.IS_JVM) oauth1a(name, context)
@@ -55,14 +55,14 @@ public class OAuthAuthenticationProvider internal constructor(config: Config) :
          *
          * [Report a problem](https://ktor.io/feedback/?fqname=io.ktor.server.auth.OAuthAuthenticationProvider.Config.providerLookup)
          */
-        public lateinit var providerLookup: suspend ApplicationCall.() -> OAuthServerSettings?
+        public lateinit var providerLookup: ApplicationCall.() -> OAuthServerSettings?
 
         /**
          * Specifies a redirect route that is opened when authorization is completed.
          *
          * [Report a problem](https://ktor.io/feedback/?fqname=io.ktor.server.auth.OAuthAuthenticationProvider.Config.urlProvider)
          */
-        public lateinit var urlProvider: suspend ApplicationCall.(OAuthServerSettings) -> String
+        public lateinit var urlProvider: ApplicationCall.(OAuthServerSettings) -> String
 
         internal fun build() = OAuthAuthenticationProvider(this)
     }
diff --git a/ktor-server/ktor-server-plugins/ktor-server-auth/common/test/io/ktor/tests/auth/OAuth2Test.kt b/ktor-server/ktor-server-plugins/ktor-server-auth/common/test/io/ktor/tests/auth/OAuth2Test.kt
index 2e6a57013..00e291016 100644
--- a/ktor-server/ktor-server-plugins/ktor-server-auth/common/test/io/ktor/tests/auth/OAuth2Test.kt
+++ b/ktor-server/ktor-server-plugins/ktor-server-auth/common/test/io/ktor/tests/auth/OAuth2Test.kt
@@ -23,7 +23,9 @@ import io.ktor.server.testing.*
 import io.ktor.util.*
 import io.ktor.utils.io.charsets.*
 import io.ktor.utils.io.core.*
-import kotlinx.coroutines.*
+import kotlinx.coroutines.Deferred
+import kotlinx.coroutines.ExperimentalCoroutinesApi
+import kotlinx.coroutines.async
 import kotlinx.serialization.*
 import kotlinx.serialization.json.*
 import kotlin.test.*
@@ -288,81 +290,6 @@ class OAuth2Test {
         assertEquals("value1", query["custom"])
     }
 
-    @Test
-    fun testRedirectWithMultipleProviders() = testApplication {
-        val testClient = testClient.await()
-
-        suspend fun resolveProvider(providerId: String): OAuthServerSettings.OAuth2ServerSettings {
-            delay(5)
-            return when (providerId) {
-                "provider1" -> OAuthServerSettings.OAuth2ServerSettings(
-                    name = "provider1-oauth2",
-                    authorizeUrl = "http://provider1-com/authorize",
-                    accessTokenUrl = "http://provider1-com/access_token",
-                    clientId = "provider1-id",
-                    clientSecret = "provider1-secret",
-                    requestMethod = HttpMethod.Post
-                )
-
-                "provider2" -> OAuthServerSettings.OAuth2ServerSettings(
-                    name = "provider2-oauth2",
-                    authorizeUrl = "http://provider2-com/authorize",
-                    accessTokenUrl = "http://provider2-com/access_token",
-                    clientId = "provider2-id",
-                    clientSecret = "provider2-secret",
-                    requestMethod = HttpMethod.Post
-                )
-
-                else -> error("Unsupported provider ID: $providerId")
-            }
-        }
-
-        install(Authentication) {
-            oauth("login") {
-                client = testClient
-                providerLookup = {
-                    val providerId = parameters["provider"] ?: error("Missing provider ID")
-                    resolveProvider(providerId)
-                }
-                urlProvider = {
-                    delay(5)
-                    "http://localhost/login/${parameters["provider"]}"
-                }
-            }
-        }
-
-        routing {
-            authenticate("login") {
-                get("/login/{provider}") {
-                    val providerId = call.parameters["provider"] ?: return@get call.respond(HttpStatusCode.BadRequest)
-                    call.respondText("OAuth config applied for provider: $providerId")
-                }
-            }
-        }
-
-        coroutineScope {
-            repeat(50) { index ->
-                launch {
-                    val provider = if (index % 2 == 0) "provider1" else "provider2"
-                    val result = noRedirectsClient().get("/login/$provider")
-                    assertEquals(HttpStatusCode.Found, result.status)
-                    val url = Url(
-                        result.headers[HttpHeaders.Location]
-                            ?: throw IllegalStateException("No location header in the response")
-                    )
-                    assertEquals("/authorize", url.encodedPath)
-                    assertEquals("$provider-com", url.host)
-
-                    val query = url.parameters
-                    assertEquals("$provider-id", query[OAuth2RequestParameters.ClientId])
-                    assertEquals("code", query[OAuth2RequestParameters.ResponseType])
-                    assertNotNull(query[OAuth2RequestParameters.State])
-                    assertEquals("http://localhost/login/$provider", query[OAuth2RequestParameters.RedirectUri])
-                }
-            }
-        }
-    }
-
     @Test
     fun testRequestToken() = testApplication {
         application { module() }
@@ -376,84 +303,6 @@ class OAuth2Test {
         assertEquals(HttpStatusCode.OK, result.status)
     }
 
-    @Test
-    fun testRequestTokenWithMultipleProviders() = testApplication {
-        val testClient = testClient.await()
-
-        suspend fun resolveProvider(providerId: String): OAuthServerSettings.OAuth2ServerSettings {
-            delay(5)
-            return when (providerId) {
-                "provider1" -> OAuthServerSettings.OAuth2ServerSettings(
-                    name = "provider1-oauth2",
-                    authorizeUrl = "http://provider1-com/authorize",
-                    accessTokenUrl = "http://provider1-com/oauth/access_token",
-                    clientId = "clientId1",
-                    clientSecret = "clientSecret1",
-                    requestMethod = HttpMethod.Post
-                )
-
-                "provider2" -> OAuthServerSettings.OAuth2ServerSettings(
-                    name = "provider2-oauth2",
-                    authorizeUrl = "http://provider2-com/authorize",
-                    accessTokenUrl = "http://provider2-com/oauth/access_token",
-                    clientId = "clientId1",
-                    clientSecret = "clientSecret1",
-                    requestMethod = HttpMethod.Post
-                )
-
-                else -> error("Unsupported provider ID: $providerId")
-            }
-        }
-
-        install(Authentication) {
-            oauth("login") {
-                client = testClient
-                providerLookup = {
-                    val providerId = parameters["provider"] ?: error("Missing provider ID")
-                    resolveProvider(providerId)
-                }
-                urlProvider = { "http://localhost/login" }
-            }
-
-            basic("resource") {
-                realm = "oauth2"
-                validate { }
-            }
-        }
-        routing {
-            authenticate("login") {
-                route("/login/{provider}") {
-                    handle {
-                        val providerId = call.parameters["provider"]
-                        call.respondText("OAuth config applied for provider: $providerId")
-                    }
-                }
-            }
-            authenticate("resource") {
-                get("/resource/{provider}") {
-                    call.respondText("ok")
-                }
-            }
-        }
-
-        coroutineScope {
-            repeat(50) { index ->
-                launch {
-                    val provider = if (index % 2 == 0) "provider1" else "provider2"
-                    val result = client.get(
-                        "/login/$provider?" + listOf(
-                            OAuth2RequestParameters.Code to "code1",
-                            OAuth2RequestParameters.State to "state1"
-                        ).formUrlEncode()
-                    )
-
-                    assertEquals(HttpStatusCode.OK, result.status)
-                    assertTrue(result.bodyAsText().contains(provider), "Expected response to contain: $provider")
-                }
-            }
-        }
-    }
-
     @Test
     fun testRequestTokenMethodPost() = testApplication {
         application { module(DefaultSettingsWithMethodPost) }
