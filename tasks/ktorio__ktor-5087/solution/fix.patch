diff --git a/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.api b/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.api
index ab79c66f8..782586a57 100644
--- a/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.api
+++ b/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.api
@@ -385,14 +385,14 @@ public final class io/ktor/server/auth/OAuthAuthenticationProvider : io/ktor/ser
 
 public final class io/ktor/server/auth/OAuthAuthenticationProvider$Config : io/ktor/server/auth/AuthenticationProvider$Config {
 	public field client Lio/ktor/client/HttpClient;
-	public field providerLookup Lkotlin/jvm/functions/Function1;
-	public field urlProvider Lkotlin/jvm/functions/Function2;
+	public field providerLookup Lkotlin/jvm/functions/Function2;
+	public field urlProvider Lkotlin/jvm/functions/Function3;
 	public final fun getClient ()Lio/ktor/client/HttpClient;
-	public final fun getProviderLookup ()Lkotlin/jvm/functions/Function1;
-	public final fun getUrlProvider ()Lkotlin/jvm/functions/Function2;
+	public final fun getProviderLookup ()Lkotlin/jvm/functions/Function2;
+	public final fun getUrlProvider ()Lkotlin/jvm/functions/Function3;
 	public final fun setClient (Lio/ktor/client/HttpClient;)V
-	public final fun setProviderLookup (Lkotlin/jvm/functions/Function1;)V
-	public final fun setUrlProvider (Lkotlin/jvm/functions/Function2;)V
+	public final fun setProviderLookup (Lkotlin/jvm/functions/Function2;)V
+	public final fun setUrlProvider (Lkotlin/jvm/functions/Function3;)V
 }
 
 public abstract class io/ktor/server/auth/OAuthCallback {
diff --git a/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.klib.api b/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.klib.api
index cadc6c1c0..88ea30f65 100644
--- a/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.klib.api
+++ b/ktor-server/ktor-server-plugins/ktor-server-auth/api/ktor-server-auth.klib.api
@@ -242,11 +242,11 @@ final class io.ktor.server.auth/OAuthAuthenticationProvider : io.ktor.server.aut
             final fun <get-client>(): io.ktor.client/HttpClient // io.ktor.server.auth/OAuthAuthenticationProvider.Config.client.<get-client>|<get-client>(){}[0]
             final fun <set-client>(io.ktor.client/HttpClient) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.client.<set-client>|<set-client>(io.ktor.client.HttpClient){}[0]
         final var providerLookup // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup|{}providerLookup[0]
-            final fun <get-providerLookup>(): kotlin/Function1<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings?> // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup.<get-providerLookup>|<get-providerLookup>(){}[0]
-            final fun <set-providerLookup>(kotlin/Function1<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings?>) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup.<set-providerLookup>|<set-providerLookup>(kotlin.Function1<io.ktor.server.application.ApplicationCall,io.ktor.server.auth.OAuthServerSettings?>){}[0]
+            final fun <get-providerLookup>(): kotlin.coroutines/SuspendFunction1<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings?> // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup.<get-providerLookup>|<get-providerLookup>(){}[0]
+            final fun <set-providerLookup>(kotlin.coroutines/SuspendFunction1<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings?>) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.providerLookup.<set-providerLookup>|<set-providerLookup>(kotlin.coroutines.SuspendFunction1<io.ktor.server.application.ApplicationCall,io.ktor.server.auth.OAuthServerSettings?>){}[0]
         final var urlProvider // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider|{}urlProvider[0]
-            final fun <get-urlProvider>(): kotlin/Function2<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings, kotlin/String> // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider.<get-urlProvider>|<get-urlProvider>(){}[0]
-            final fun <set-urlProvider>(kotlin/Function2<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings, kotlin/String>) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider.<set-urlProvider>|<set-urlProvider>(kotlin.Function2<io.ktor.server.application.ApplicationCall,io.ktor.server.auth.OAuthServerSettings,kotlin.String>){}[0]
+            final fun <get-urlProvider>(): kotlin.coroutines/SuspendFunction2<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings, kotlin/String> // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider.<get-urlProvider>|<get-urlProvider>(){}[0]
+            final fun <set-urlProvider>(kotlin.coroutines/SuspendFunction2<io.ktor.server.application/ApplicationCall, io.ktor.server.auth/OAuthServerSettings, kotlin/String>) // io.ktor.server.auth/OAuthAuthenticationProvider.Config.urlProvider.<set-urlProvider>|<set-urlProvider>(kotlin.coroutines.SuspendFunction2<io.ktor.server.application.ApplicationCall,io.ktor.server.auth.OAuthServerSettings,kotlin.String>){}[0]
     }
 }
 
diff --git a/ktor-server/ktor-server-plugins/ktor-server-auth/common/src/io/ktor/server/auth/OAuthProcedure.kt b/ktor-server/ktor-server-plugins/ktor-server-auth/common/src/io/ktor/server/auth/OAuthProcedure.kt
index 6ebea5d2b..b259c6c4d 100644
--- a/ktor-server/ktor-server-plugins/ktor-server-auth/common/src/io/ktor/server/auth/OAuthProcedure.kt
+++ b/ktor-server/ktor-server-plugins/ktor-server-auth/common/src/io/ktor/server/auth/OAuthProcedure.kt
@@ -29,8 +29,8 @@ public val OAuthKey: Any = "OAuth"
 public class OAuthAuthenticationProvider internal constructor(config: Config) : AuthenticationProvider(config) {
 
     internal val client: HttpClient = config.client
-    internal val providerLookup: ApplicationCall.() -> OAuthServerSettings? = config.providerLookup
-    internal val urlProvider: ApplicationCall.(OAuthServerSettings) -> String = config.urlProvider
+    internal val providerLookup: suspend ApplicationCall.() -> OAuthServerSettings? = config.providerLookup
+    internal val urlProvider: suspend ApplicationCall.(OAuthServerSettings) -> String = config.urlProvider
 
     override suspend fun onAuthenticate(context: AuthenticationContext) {
         if (PlatformUtils.IS_JVM) oauth1a(name, context)
@@ -55,14 +55,14 @@ public class OAuthAuthenticationProvider internal constructor(config: Config) :
          *
          * [Report a problem](https://ktor.io/feedback/?fqname=io.ktor.server.auth.OAuthAuthenticationProvider.Config.providerLookup)
          */
-        public lateinit var providerLookup: ApplicationCall.() -> OAuthServerSettings?
+        public lateinit var providerLookup: suspend ApplicationCall.() -> OAuthServerSettings?
 
         /**
          * Specifies a redirect route that is opened when authorization is completed.
          *
          * [Report a problem](https://ktor.io/feedback/?fqname=io.ktor.server.auth.OAuthAuthenticationProvider.Config.urlProvider)
          */
-        public lateinit var urlProvider: ApplicationCall.(OAuthServerSettings) -> String
+        public lateinit var urlProvider: suspend ApplicationCall.(OAuthServerSettings) -> String
 
         internal fun build() = OAuthAuthenticationProvider(this)
     }
