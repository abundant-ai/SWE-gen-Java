diff --git a/build-logic-commons/basics/src/main/kotlin/gradlebuild/basics/kotlindsl/kotlin-compiler-configuration.kt b/build-logic-commons/basics/src/main/kotlin/gradlebuild/basics/kotlindsl/kotlin-compiler-configuration.kt
index 28bcf8f105e..c68bf634821 100644
--- a/build-logic-commons/basics/src/main/kotlin/gradlebuild/basics/kotlindsl/kotlin-compiler-configuration.kt
+++ b/build-logic-commons/basics/src/main/kotlin/gradlebuild/basics/kotlindsl/kotlin-compiler-configuration.kt
@@ -36,8 +36,8 @@ import org.jetbrains.kotlin.load.java.ReportLevel
 fun KotlinCompile.configureKotlinCompilerForGradleBuild() {
     compilerOptions {
         allWarningsAsErrors = true
-        apiVersion = KotlinVersion.KOTLIN_1_8
-        languageVersion = KotlinVersion.KOTLIN_1_8
+        apiVersion = KotlinVersion.KOTLIN_2_2
+        languageVersion = KotlinVersion.KOTLIN_2_2
         freeCompilerArgs.addAll(
             "-Xjsr305=strict",
             "-Xjspecify-annotations=strict",
@@ -53,8 +53,8 @@ fun CompilerConfiguration.configureKotlinCompilerForGradleBuild() {
     put(
         CommonConfigurationKeys.LANGUAGE_VERSION_SETTINGS,
         LanguageVersionSettingsImpl(
-            languageVersion = LanguageVersion.KOTLIN_1_8,
-            apiVersion = ApiVersion.KOTLIN_1_8,
+            languageVersion = LanguageVersion.KOTLIN_2_2,
+            apiVersion = ApiVersion.KOTLIN_2_2,
             analysisFlags = mapOf(
                 JvmAnalysisFlags.javaTypeEnhancementState to JavaTypeEnhancementState(
                     Jsr305Settings(ReportLevel.STRICT, ReportLevel.STRICT)
diff --git a/build-logic-commons/build-platform/build.gradle.kts b/build-logic-commons/build-platform/build.gradle.kts
index 4f457f4a27a..1573d5ed5b7 100644
--- a/build-logic-commons/build-platform/build.gradle.kts
+++ b/build-logic-commons/build-platform/build.gradle.kts
@@ -19,8 +19,7 @@ val codenarcVersion = if (isGroovy4) "3.6.0-groovy-4.0" else "3.6.0"
 val spockVersion = if (isGroovy4) "2.3-groovy-4.0" else "2.3-groovy-3.0"
 val groovyGroup = if (isGroovy4) "org.apache.groovy" else "org.codehaus.groovy"
 val asmVersion = "9.7.1"
-// To try out better kotlin compilation avoidance and incremental compilation
-// with -Pkotlin.incremental.useClasspathSnapshot=true
+// To try out newer kotlin versions
 val kotlinVersion = providers.gradleProperty("buildKotlinVersion")
     .getOrElse(embeddedKotlinVersion)
 
@@ -74,7 +73,7 @@ dependencies {
         api("org.codenarc:CodeNarc:$codenarcVersion")
         api("org.eclipse.jgit:org.eclipse.jgit:7.2.1.202505142326-r")
         api("org.javassist:javassist:3.30.2-GA")
-        api("org.jetbrains.kotlinx:kotlinx-metadata-jvm:0.9.0")
+        api("org.jetbrains.kotlin:kotlin-metadata-jvm:$kotlinVersion")
         api("org.jsoup:jsoup:1.15.3")
         api("org.junit.jupiter:junit-jupiter:5.8.2")
         api("org.junit.vintage:junit-vintage-engine:5.8.2")
diff --git a/build-logic-commons/gradle-plugin/build.gradle.kts b/build-logic-commons/gradle-plugin/build.gradle.kts
index 6a7cf1ed60c..6131d4151d7 100644
--- a/build-logic-commons/gradle-plugin/build.gradle.kts
+++ b/build-logic-commons/gradle-plugin/build.gradle.kts
@@ -1,3 +1,5 @@
+import org.gradle.kotlin.dsl.support.expectedKotlinDslPluginsVersion
+
 plugins {
     `kotlin-dsl`
 }
@@ -15,7 +17,8 @@ dependencies {
     implementation(projects.moduleIdentity)
     implementation("net.ltgt.gradle:gradle-errorprone-plugin:4.1.0")
 
-    implementation("org.gradle.kotlin.kotlin-dsl:org.gradle.kotlin.kotlin-dsl.gradle.plugin:6.1.2")
+
+    implementation("org.gradle.kotlin.kotlin-dsl:org.gradle.kotlin.kotlin-dsl.gradle.plugin:$expectedKotlinDslPluginsVersion")
     implementation("org.jetbrains.kotlin:kotlin-gradle-plugin:$embeddedKotlinVersion")
     implementation("org.gradle:test-retry-gradle-plugin:1.6.2")
 
diff --git a/build-logic/binary-compatibility/build.gradle.kts b/build-logic/binary-compatibility/build.gradle.kts
index 53414c66371..b040b951865 100644
--- a/build-logic/binary-compatibility/build.gradle.kts
+++ b/build-logic/binary-compatibility/build.gradle.kts
@@ -16,7 +16,7 @@ dependencies {
     implementation("com.google.code.gson:gson")
     implementation("com.google.guava:guava")
     implementation("org.javassist:javassist")
-    implementation("org.jetbrains.kotlinx:kotlinx-metadata-jvm")
+    implementation("org.jetbrains.kotlin:kotlin-metadata-jvm")
     implementation("org.jspecify:jspecify")
     implementation("org.ow2.asm:asm")
     compileOnly(kotlin("compiler-embeddable"))
diff --git a/build-logic/binary-compatibility/src/main/groovy/gradlebuild/binarycompatibility/BinaryCompatibilityHelper.groovy b/build-logic/binary-compatibility/src/main/groovy/gradlebuild/binarycompatibility/BinaryCompatibilityHelper.groovy
index d9e4e438a05..b82667c216b 100644
--- a/build-logic/binary-compatibility/src/main/groovy/gradlebuild/binarycompatibility/BinaryCompatibilityHelper.groovy
+++ b/build-logic/binary-compatibility/src/main/groovy/gradlebuild/binarycompatibility/BinaryCompatibilityHelper.groovy
@@ -18,6 +18,7 @@ package gradlebuild.binarycompatibility
 
 import gradlebuild.binarycompatibility.filters.AnonymousClassesFilter
 import gradlebuild.binarycompatibility.filters.BridgeForBytecodeUpgradeAdapterClassFilter
+import gradlebuild.binarycompatibility.filters.KotlinInvokeDefaultBridgeFilter
 import gradlebuild.binarycompatibility.filters.KotlinInternalFilter
 import gradlebuild.binarycompatibility.rules.AcceptedRegressionsRulePostProcess
 import gradlebuild.binarycompatibility.rules.AcceptedRegressionsRuleSetup
@@ -51,6 +52,7 @@ class BinaryCompatibilityHelper {
         japicmpTask.tap {
             addExcludeFilter(AnonymousClassesFilter)
             addExcludeFilter(KotlinInternalFilter)
+            addExcludeFilter(KotlinInvokeDefaultBridgeFilter)
             addExcludeFilter(BridgeForBytecodeUpgradeAdapterClassFilter)
 
             def acceptedChangesMap = acceptedViolations.toAcceptedChangesMap()
diff --git a/build-logic/binary-compatibility/src/main/groovy/gradlebuild/binarycompatibility/filters/KotlinInvokeDefaultBridgeFilter.groovy b/build-logic/binary-compatibility/src/main/groovy/gradlebuild/binarycompatibility/filters/KotlinInvokeDefaultBridgeFilter.groovy
new file mode 100644
index 00000000000..89b79df7156
--- /dev/null
+++ b/build-logic/binary-compatibility/src/main/groovy/gradlebuild/binarycompatibility/filters/KotlinInvokeDefaultBridgeFilter.groovy
@@ -0,0 +1,30 @@
+/*
+ * Copyright 2025 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package gradlebuild.binarycompatibility.filters
+
+import japicmp.filter.BehaviorFilter
+import javassist.CtBehavior
+
+/**
+ * Kotlin 2.2 produces bridge methods for invoke operator functions compiled as JVM default methods.
+ */
+class KotlinInvokeDefaultBridgeFilter implements BehaviorFilter {
+    @Override
+    boolean matches(CtBehavior ctBehavior) {
+        return ctBehavior.name.startsWith("access\$invoke\$jd")
+    }
+}
diff --git a/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/metadata/HasKotlinFlagsMetadataQuery.kt b/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/metadata/HasKotlinFlagsMetadataQuery.kt
index aea50758978..4a869ea6452 100644
--- a/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/metadata/HasKotlinFlagsMetadataQuery.kt
+++ b/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/metadata/HasKotlinFlagsMetadataQuery.kt
@@ -16,20 +16,20 @@
 
 package gradlebuild.binarycompatibility.metadata
 
-import kotlinx.metadata.KmClass
-import kotlinx.metadata.KmConstructor
-import kotlinx.metadata.KmFunction
-import kotlinx.metadata.KmPackage
-import kotlinx.metadata.KmProperty
-import kotlinx.metadata.KmPropertyAccessorAttributes
-import kotlinx.metadata.Visibility
-import kotlinx.metadata.jvm.KotlinClassMetadata
-import kotlinx.metadata.jvm.fieldSignature
-import kotlinx.metadata.jvm.getterSignature
-import kotlinx.metadata.jvm.setterSignature
-import kotlinx.metadata.jvm.signature
-import kotlinx.metadata.visibility
 import java.util.function.Supplier
+import kotlin.metadata.KmClass
+import kotlin.metadata.KmConstructor
+import kotlin.metadata.KmFunction
+import kotlin.metadata.KmPackage
+import kotlin.metadata.KmProperty
+import kotlin.metadata.KmPropertyAccessorAttributes
+import kotlin.metadata.Visibility
+import kotlin.metadata.jvm.KotlinClassMetadata
+import kotlin.metadata.jvm.fieldSignature
+import kotlin.metadata.jvm.getterSignature
+import kotlin.metadata.jvm.setterSignature
+import kotlin.metadata.jvm.signature
+import kotlin.metadata.visibility
 
 
 internal
diff --git a/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/metadata/KotlinMetadataQueries.kt b/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/metadata/KotlinMetadataQueries.kt
index b48a49cbd7f..cbc44a7e507 100644
--- a/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/metadata/KotlinMetadataQueries.kt
+++ b/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/metadata/KotlinMetadataQueries.kt
@@ -28,12 +28,12 @@ import javassist.CtMethod
 import javassist.Modifier
 import javassist.bytecode.annotation.Annotation
 import javassist.bytecode.annotation.AnnotationImpl
-import kotlinx.metadata.KmFunction
-import kotlinx.metadata.Visibility
-import kotlinx.metadata.isInfix
-import kotlinx.metadata.isOperator
-import kotlinx.metadata.jvm.KotlinClassMetadata
 import java.lang.reflect.Proxy
+import kotlin.metadata.KmFunction
+import kotlin.metadata.Visibility
+import kotlin.metadata.isInfix
+import kotlin.metadata.isOperator
+import kotlin.metadata.jvm.KotlinClassMetadata
 
 
 object KotlinMetadataQueries {
diff --git a/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/sources/KotlinSourceQueries.kt b/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/sources/KotlinSourceQueries.kt
index 28585b69770..751ee79c182 100644
--- a/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/sources/KotlinSourceQueries.kt
+++ b/build-logic/binary-compatibility/src/main/kotlin/gradlebuild/binarycompatibility/sources/KotlinSourceQueries.kt
@@ -172,9 +172,9 @@ fun KtFile.collectKtFunctionsFor(qualifiedBaseName: String, method: CtMethod): L
             // Drop the receiver if present
             .drop(if (extensionCandidate) 1 else 0)
             .withIndex()
-            .all<IndexedValue<CtClass>> {
+            .all {
                 val ktParamType = ktFunction.valueParameters[it.index].typeReference!!
-                it.value.isLikelyEquivalentTo(ktParamType) || (isVarargs && it.value.componentType.isLikelyEquivalentTo(ktParamType))
+                it.value.isLikelyEquivalentTo(ktParamType) || (isVarargs && it.value.componentType?.isLikelyEquivalentTo(ktParamType) == true)
             }
     }
 }
diff --git a/build-logic/dependency-modules/src/main/kotlin/gradlebuild/modules/extension/ExternalModulesExtension.kt b/build-logic/dependency-modules/src/main/kotlin/gradlebuild/modules/extension/ExternalModulesExtension.kt
index f5d9546bb05..4dabab5a948 100644
--- a/build-logic/dependency-modules/src/main/kotlin/gradlebuild/modules/extension/ExternalModulesExtension.kt
+++ b/build-logic/dependency-modules/src/main/kotlin/gradlebuild/modules/extension/ExternalModulesExtension.kt
@@ -28,7 +28,7 @@ abstract class ExternalModulesExtension(bundleGroovyMajor: Int) {
 
     val configurationCacheReportVersion = "1.26"
     val gradleIdeStarterVersion = "0.6"
-    val kotlinVersion = "2.1.21"
+    val kotlinVersion = "2.2.0"
 
     fun futureKotlin(module: String) = "org.jetbrains.kotlin:kotlin-$module:$kotlinVersion"
 
@@ -197,7 +197,7 @@ abstract class ExternalModulesExtension(bundleGroovyMajor: Int) {
     val joptSimple = "net.sf.jopt-simple:jopt-simple"
     val jsoup = "org.jsoup:jsoup"
     val jtar = "org.kamranzafar:jtar"
-    val kotlinCoroutines = "org.jetbrains.kotlinx:kotlinx-coroutines-core"
+    val kotlinCoroutines = "org.jetbrains.kotlinx:kotlinx-coroutines-core-jvm"
     val kotlinCoroutinesDebug = "org.jetbrains.kotlinx:kotlinx-coroutines-debug"
     val littleproxy = "xyz.rogfam:littleproxy"
     val mina = "org.apache.mina:mina-core"
diff --git a/build-logic/documentation/src/main/groovy/gradlebuild/docs/GradleUserManualPlugin.java b/build-logic/documentation/src/main/groovy/gradlebuild/docs/GradleUserManualPlugin.java
index f24522569a5..c1f6c9b8baa 100644
--- a/build-logic/documentation/src/main/groovy/gradlebuild/docs/GradleUserManualPlugin.java
+++ b/build-logic/documentation/src/main/groovy/gradlebuild/docs/GradleUserManualPlugin.java
@@ -172,6 +172,8 @@ private void generateUserManual(Project project, TaskContainer tasks, ProjectLay
 
             // TODO: This breaks if the version is changed later.
             attributes.put("gradleVersion", project.getVersion().toString());
+            attributes.put("gradleVersion90", "9.0.0");
+            attributes.put("gradleVersion8", "8.14.3");
             attributes.put("snippetsPath", "snippets");
             // Make sure the 'raw' location of the samples is available in all AsciidoctorTasks to access files with expected outputs in the 'tests' folder for inclusion in READMEs
             attributes.put("samplesPath", extension.getUserManual().getStagingRoot().dir("raw/samples").get().getAsFile());
diff --git a/build-logic/kotlin-dsl/src/main/kotlin/gradlebuild.kotlin-dsl-dependencies-embedded.gradle.kts b/build-logic/kotlin-dsl/src/main/kotlin/gradlebuild.kotlin-dsl-dependencies-embedded.gradle.kts
index 5f3bbb99e49..b41f873c5a6 100644
--- a/build-logic/kotlin-dsl/src/main/kotlin/gradlebuild.kotlin-dsl-dependencies-embedded.gradle.kts
+++ b/build-logic/kotlin-dsl/src/main/kotlin/gradlebuild.kotlin-dsl-dependencies-embedded.gradle.kts
@@ -26,7 +26,7 @@ plugins {
 // --- Enable automatic generation of API extensions -------------------
 val apiExtensionsOutputDir = layout.buildDirectory.dir("generated-sources/kotlin")
 
-val publishedKotlinDslPluginVersion = "6.1.2" // TODO:kotlin-dsl
+val publishedKotlinDslPluginVersion = "6.2.0" // TODO:kotlin-dsl
 
 tasks {
     val generateKotlinDependencyExtensions by registering(GenerateKotlinDependencyExtensions::class) {
diff --git a/gradle.properties b/gradle.properties
index e9704698dad..fe50d7fa920 100644
--- a/gradle.properties
+++ b/gradle.properties
@@ -9,7 +9,6 @@ systemProp.gradle.publish.skip.namespace.check=true
 # Kotlin DSL settings
 org.gradle.kotlin.dsl.allWarningsAsErrors=true
 # Kotlin settings
-kotlin.incremental.useClasspathSnapshot=true
 kotlin.stdlib.default.dependency=false
 kotlin.js.ir.output.granularity=whole-program
 # Temporarily force IDEs to produce a Build Scan
diff --git a/gradle/wrapper/gradle-wrapper.properties b/gradle/wrapper/gradle-wrapper.properties
index 407c905d9c4..9fb67bb8976 100644
--- a/gradle/wrapper/gradle-wrapper.properties
+++ b/gradle/wrapper/gradle-wrapper.properties
@@ -1,6 +1,6 @@
 distributionBase=GRADLE_USER_HOME
 distributionPath=wrapper/dists
-distributionUrl=https\://services.gradle.org/distributions/gradle-9.0.0-rc-1-bin.zip
+distributionUrl=https\://services.gradle.org/distributions/gradle-9.0.0-milestone-10-bin.zip
 networkTimeout=10000
 validateDistributionUrl=true
 zipStoreBase=GRADLE_USER_HOME
diff --git a/packaging/distributions-dependencies/build.gradle.kts b/packaging/distributions-dependencies/build.gradle.kts
index 90fb0db25a1..4195cda5caf 100644
--- a/packaging/distributions-dependencies/build.gradle.kts
+++ b/packaging/distributions-dependencies/build.gradle.kts
@@ -208,11 +208,11 @@ dependencies {
         api(libs.jettyUtil)             { version { strictly(jettyVersion) }}
         api(libs.jettyWebApp)           { version { strictly(jettyVersion) }}
         api(libs.jtar)                  { version { strictly("2.3") }}
-        api(libs.kotlinCoroutines)      { version { strictly("1.5.2") }}
-        api(libs.kotlinCoroutinesDebug) { version { strictly("1.5.2") }}
+        api(libs.kotlinCoroutines)      { version { strictly("1.10.2") }}
+        api(libs.kotlinCoroutinesDebug) { version { strictly("1.10.2") }}
         api(libs.kotlinJvmAbiGenEmbeddable) { version { strictly(libs.kotlinVersion) }}
-        api(libs.kotlinxSerializationCore)   { version { strictly("1.6.2") }}
-        api(libs.kotlinxSerializationJson)   { version { strictly("1.6.2") }}
+        api(libs.kotlinxSerializationCore)   { version { strictly("1.9.0") }}
+        api(libs.kotlinxSerializationJson)   { version { strictly("1.9.0") }}
         api(libs.littleproxy)           { version { strictly("2.0.5") }}
         api(libs.maven3ResolverProvider){ version { strictly(mavenVersion) }}
         api(libs.mavenResolverApi)              { version { strictly(mavenResolverVersion) }}
diff --git a/platforms/core-configuration/configuration-cache/src/integTest/groovy/org/gradle/internal/cc/impl/ConfigurationCacheGracefulDegradationIntegrationTest.groovy b/platforms/core-configuration/configuration-cache/src/integTest/groovy/org/gradle/internal/cc/impl/ConfigurationCacheGracefulDegradationIntegrationTest.groovy
index d527278604f..e16142537fd 100644
--- a/platforms/core-configuration/configuration-cache/src/integTest/groovy/org/gradle/internal/cc/impl/ConfigurationCacheGracefulDegradationIntegrationTest.groovy
+++ b/platforms/core-configuration/configuration-cache/src/integTest/groovy/org/gradle/internal/cc/impl/ConfigurationCacheGracefulDegradationIntegrationTest.groovy
@@ -21,6 +21,25 @@ import org.gradle.api.internal.ConfigurationCacheDegradationController
 import javax.inject.Inject
 
 class ConfigurationCacheGracefulDegradationIntegrationTest extends AbstractConfigurationCacheIntegrationTest {
+    public static final String CONFIGURATION_CACHE_INCOMPATIBLE_TASKS_FOOTER = "Some tasks in this build are not compatible with the configuration cache."
+    public static final String CONFIGURATION_CACHE_DISABLED_REASON = "Configuration cache disabled because incompatible task"
+
+    def "a compatible build does not print degradation reasons"() {
+        buildFile """
+            System.getenv("HOME")  // Add a configuration input to force report to be generated
+            tasks.register("compatible") {
+                doLast {
+                    println("Hello")
+                }
+            }
+        """
+
+        when:
+        configurationCacheRun("compatible", "-D${LOG_REPORT_LINK_AS_WARNING}=true")
+
+        then:
+        assertNoConfigurationCacheDegradation()
+    }
 
     def configurationCache = newConfigurationCacheFixture()
 
@@ -516,12 +535,16 @@ class ConfigurationCacheGracefulDegradationIntegrationTest extends AbstractConfi
     }
 
     private void assertConfigurationCacheDegradation(boolean hasOtherProblems = false) {
-        def reportLinkPreamble = "Some tasks in this build are not compatible with the configuration cache."
         if (hasOtherProblems) {
-            outputDoesNotContain(reportLinkPreamble)
+            outputDoesNotContain(CONFIGURATION_CACHE_INCOMPATIBLE_TASKS_FOOTER)
         } else {
-            outputContains(reportLinkPreamble)
+            outputContains(CONFIGURATION_CACHE_INCOMPATIBLE_TASKS_FOOTER)
         }
-        postBuildOutputContains("Configuration cache disabled because incompatible task")
+        postBuildOutputContains(CONFIGURATION_CACHE_DISABLED_REASON)
+    }
+
+    private void assertNoConfigurationCacheDegradation() {
+        outputDoesNotContain(CONFIGURATION_CACHE_INCOMPATIBLE_TASKS_FOOTER)
+        postBuildOutputDoesNotContain(CONFIGURATION_CACHE_DISABLED_REASON)
     }
 }
diff --git a/platforms/core-configuration/configuration-cache/src/integTest/groovy/org/gradle/internal/cc/impl/ConfigurationCacheKotlinLambdaIntegrationTest.groovy b/platforms/core-configuration/configuration-cache/src/integTest/groovy/org/gradle/internal/cc/impl/ConfigurationCacheKotlinLambdaIntegrationTest.groovy
new file mode 100644
index 00000000000..5b3bcef306f
--- /dev/null
+++ b/platforms/core-configuration/configuration-cache/src/integTest/groovy/org/gradle/internal/cc/impl/ConfigurationCacheKotlinLambdaIntegrationTest.groovy
@@ -0,0 +1,78 @@
+/*
+ * Copyright 2025 the original author or authors.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.gradle.internal.cc.impl
+
+
+import org.gradle.test.fixtures.dsl.GradleDsl
+
+class ConfigurationCacheKotlinLambdaIntegrationTest extends AbstractConfigurationCacheIntegrationTest {
+
+    def "defers evaluation of #description objects"() {
+        given:
+        file("buildSrc/settings.gradle.kts").text = ""
+        file("buildSrc/build.gradle.kts").text = """
+            plugins { `embedded-kotlin` }
+            ${mavenCentralRepository(GradleDsl.KOTLIN)}
+        """
+        file("buildSrc/src/main/kotlin/my/LambdaTask.kt").tap {
+            parentFile.mkdirs()
+            text = """
+                package my
+
+                import org.gradle.api.*
+                import org.gradle.api.tasks.*
+
+                object State {
+                    @JvmStatic
+                    var barrier = "initial value"
+                }
+
+                data class BeanOf<T>(val value: T)
+                data class FunctionBean(val value: () -> Any)
+
+                abstract class LambdaTask : DefaultTask() {
+
+                    @get:Internal
+                    lateinit var myProp: $type
+
+                    @TaskAction
+                    fun action() {
+                        State.barrier = "execution time value"
+                        println(myProp.$invoke)
+                    }
+                }
+            """
+        }
+        buildKotlinFile("""
+            tasks.register<my.LambdaTask>("ok") {
+                myProp = $create
+            }
+        """)
+
+        when:
+        configurationCacheRun("ok")
+
+        then:
+        outputContains("execution time value")
+
+        where:
+        description        | type                | create                                  | invoke
+        "Function"         | "() -> Any"         | "{ my.State.barrier }"                  | "invoke()"
+        "dynamic Function" | "BeanOf<() -> Any>" | "my.BeanOf({ my.State.barrier })"       | "value.invoke()"
+        "static Function"  | "FunctionBean"      | "my.FunctionBean({ my.State.barrier })" | "value.invoke()"
+    }
+}
diff --git a/platforms/core-configuration/configuration-cache/src/main/kotlin/org/gradle/internal/cc/impl/problems/ConfigurationCacheProblems.kt b/platforms/core-configuration/configuration-cache/src/main/kotlin/org/gradle/internal/cc/impl/problems/ConfigurationCacheProblems.kt
index 531a0389602..7c2c9ae895a 100644
--- a/platforms/core-configuration/configuration-cache/src/main/kotlin/org/gradle/internal/cc/impl/problems/ConfigurationCacheProblems.kt
+++ b/platforms/core-configuration/configuration-cache/src/main/kotlin/org/gradle/internal/cc/impl/problems/ConfigurationCacheProblems.kt
@@ -218,6 +218,7 @@ class ConfigurationCacheProblems(
             }
             .documentationSection(DocumentationSection.TaskOptOut).build()
         report.onIncompatibleTask(problem)
+        summarizer.onIncompatibleTask()
     }
 
     override fun onProblem(problem: PropertyProblem) {
diff --git a/platforms/core-configuration/configuration-cache/src/main/kotlin/org/gradle/internal/cc/impl/problems/ConfigurationCacheProblemsSummary.kt b/platforms/core-configuration/configuration-cache/src/main/kotlin/org/gradle/internal/cc/impl/problems/ConfigurationCacheProblemsSummary.kt
index 1225c7da423..66362035f0b 100644
--- a/platforms/core-configuration/configuration-cache/src/main/kotlin/org/gradle/internal/cc/impl/problems/ConfigurationCacheProblemsSummary.kt
+++ b/platforms/core-configuration/configuration-cache/src/main/kotlin/org/gradle/internal/cc/impl/problems/ConfigurationCacheProblemsSummary.kt
@@ -65,6 +65,9 @@ class ConfigurationCacheProblemsSummary(
     private
     var suppressedSilentlyProblemCount: Int = 0
 
+    private
+    var incompatibleTasksCount: Int = 0
+
     /**
      * Unique problem causes observed among all reported problems.
      *
@@ -94,7 +97,8 @@ class ConfigurationCacheProblemsSummary(
             ImmutableMap.copyOf(problemCauses),
             ImmutableList.copyOf(originalProblemExceptions),
             overflowed,
-            maxCollectedProblems
+            maxCollectedProblems,
+            incompatibleTasksCount
         )
     }
 
@@ -127,6 +131,12 @@ class ConfigurationCacheProblemsSummary(
         }
     }
 
+    fun onIncompatibleTask() {
+        lock.withLock {
+            incompatibleTasksCount += 1
+        }
+    }
+
     private
     fun collectOriginalException(problem: PropertyProblem) {
         if (originalProblemExceptions.size < MAX_PROBLEM_EXCEPTIONS) {
@@ -178,7 +188,13 @@ class Summary(
     val overflowed: Boolean,
 
     private
-    val maxCollectedProblems: Int
+    val maxCollectedProblems: Int,
+
+    /**
+     * Total number of tasks in the current work graph that are not CC-compatible.
+     */
+    private
+    val incompatibleTasksCount: Int
 ) {
     val reportableProblemCount: Int
         get() = totalProblemCount - suppressedSilentlyProblemCount
@@ -208,10 +224,11 @@ class Summary(
                     appendLine("plus ${reportableProblemCauseCount - MAX_CONSOLE_PROBLEMS} more problems. Please see the report for details.")
                 }
             }
+            val hasIncompatibleTasks = incompatibleTasksCount > 0
             htmlReportFile?.let {
                 appendLine()
-                if (!hasReportableProblems) {
-                    // Some tests parse this line.
+                if (hasIncompatibleTasks && !hasReportableProblems) {
+                    // Some tests parse this line, you may need to change them if you change the message.
                     append("Some tasks in this build are not compatible with the configuration cache.")
                     appendLine()
                 }
diff --git a/platforms/core-configuration/configuration-cache/src/test/kotlin/org/gradle/internal/cc/impl/serialization/codecs/CombinatorsTest.kt b/platforms/core-configuration/configuration-cache/src/test/kotlin/org/gradle/internal/cc/impl/serialization/codecs/CombinatorsTest.kt
index 88960cbe51d..94e331b9f6c 100644
--- a/platforms/core-configuration/configuration-cache/src/test/kotlin/org/gradle/internal/cc/impl/serialization/codecs/CombinatorsTest.kt
+++ b/platforms/core-configuration/configuration-cache/src/test/kotlin/org/gradle/internal/cc/impl/serialization/codecs/CombinatorsTest.kt
@@ -37,6 +37,7 @@ class CombinatorsTest : AbstractUserTypeCodecTest() {
     @Test(expected = ConfigurationCacheError::class)
     fun `throws if map collection reports invalid size`() {
         class BrokenMap : HashMap<String, String>() {
+            @Suppress("PROPERTY_HIDES_JAVA_FIELD")
             override val size: Int
                 get() = 0
         }
diff --git a/platforms/core-configuration/configuration-cache/src/test/kotlin/org/gradle/internal/cc/impl/serialization/codecs/FunctionCodecTest.kt b/platforms/core-configuration/configuration-cache/src/test/kotlin/org/gradle/internal/cc/impl/serialization/codecs/FunctionCodecTest.kt
deleted file mode 100644
index a78890a4cdd..00000000000
--- a/platforms/core-configuration/configuration-cache/src/test/kotlin/org/gradle/internal/cc/impl/serialization/codecs/FunctionCodecTest.kt
+++ /dev/null
@@ -1,49 +0,0 @@
-/*
- * Copyright 2020 the original author or authors.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.gradle.internal.cc.impl.serialization.codecs
-
-import org.junit.Test
-
-
-class FunctionCodecTest : AbstractFunctionalTypeTest() {
-
-    @Test
-    fun `defers evaluation of Function objects`() {
-        assertDeferredEvaluationOf(function()) {
-            invoke()
-        }
-    }
-
-    @Test
-    fun `defers evaluation of dynamic Function fields`() {
-        assertDeferredEvaluationOf(BeanOf(function())) {
-            value()
-        }
-    }
-
-    @Test
-    fun `defers evaluation of static Function fields`() {
-        assertDeferredEvaluationOf(FunctionBean(function())) {
-            value()
-        }
-    }
-
-    private
-    fun function(): () -> Any? = { Runtime.value }
-
-    data class FunctionBean(val value: () -> Any?)
-}
diff --git a/platforms/core-configuration/configuration-problems-base/src/main/kotlin/org/gradle/internal/configuration/problems/PropertyProblem.kt b/platforms/core-configuration/configuration-problems-base/src/main/kotlin/org/gradle/internal/configuration/problems/PropertyProblem.kt
index 7f63e2dcc49..3ade74303a1 100644
--- a/platforms/core-configuration/configuration-problems-base/src/main/kotlin/org/gradle/internal/configuration/problems/PropertyProblem.kt
+++ b/platforms/core-configuration/configuration-problems-base/src/main/kotlin/org/gradle/internal/configuration/problems/PropertyProblem.kt
@@ -177,7 +177,7 @@ sealed class PropertyTrace {
         }
     }
 
-    @Suppress("DataClassPrivateConstructor")
+    @ConsistentCopyVisibility
     data class BuildLogic private constructor(
         val source: DisplayName,
         val lineNumber: Int? = null
diff --git a/platforms/core-configuration/core-serialization-codecs/src/main/kotlin/org/gradle/internal/serialize/codecs/core/jos/ObjectInputStreamAdapter.kt b/platforms/core-configuration/core-serialization-codecs/src/main/kotlin/org/gradle/internal/serialize/codecs/core/jos/ObjectInputStreamAdapter.kt
index 9cb5f9766af..d7f523895d5 100644
--- a/platforms/core-configuration/core-serialization-codecs/src/main/kotlin/org/gradle/internal/serialize/codecs/core/jos/ObjectInputStreamAdapter.kt
+++ b/platforms/core-configuration/core-serialization-codecs/src/main/kotlin/org/gradle/internal/serialize/codecs/core/jos/ObjectInputStreamAdapter.kt
@@ -107,6 +107,7 @@ class ObjectInputStreamAdapter(
 
     override fun read(buf: ByteArray, off: Int, len: Int): Int = inputStream.read(buf, off, len)
 
+    @Deprecated("Deprecated in Java")
     override fun readLine(): String = unsupported("ObjectInputStream.readLine")
 
     override fun readFully(buf: ByteArray) = unsupported("ObjectInputStream.readFully")
diff --git a/platforms/core-configuration/declarative-dsl-core/build.gradle.kts b/platforms/core-configuration/declarative-dsl-core/build.gradle.kts
index 3dcd25ec029..0d515c4d60e 100644
--- a/platforms/core-configuration/declarative-dsl-core/build.gradle.kts
+++ b/platforms/core-configuration/declarative-dsl-core/build.gradle.kts
@@ -1,6 +1,3 @@
-import org.jetbrains.kotlin.gradle.dsl.KotlinVersion
-import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
-
 plugins {
     id("gradlebuild.distribution.implementation-kotlin")
     id("gradlebuild.publish-public-libraries")
@@ -11,13 +8,6 @@ plugins {
 
 description = "Common shared classes used by the Declarative DSL"
 
-tasks.withType<KotlinCompile>().configureEach {
-    compilerOptions {
-        apiVersion.set(KotlinVersion.KOTLIN_1_9)
-        languageVersion.set(KotlinVersion.KOTLIN_1_9)
-    }
-}
-
 dependencies {
     api(projects.declarativeDslToolingModels)
 
diff --git a/platforms/core-configuration/declarative-dsl-core/src/main/kotlin/org/gradle/internal/declarativedsl/dom/data/DocumentDataContainerUtil.kt b/platforms/core-configuration/declarative-dsl-core/src/main/kotlin/org/gradle/internal/declarativedsl/dom/data/DocumentDataContainerUtil.kt
index a929198f632..faa26f14baa 100644
--- a/platforms/core-configuration/declarative-dsl-core/src/main/kotlin/org/gradle/internal/declarativedsl/dom/data/DocumentDataContainerUtil.kt
+++ b/platforms/core-configuration/declarative-dsl-core/src/main/kotlin/org/gradle/internal/declarativedsl/dom/data/DocumentDataContainerUtil.kt
@@ -33,7 +33,7 @@ fun <D, C : NodeData<D>> C.collectToNodeMap(document: DeclarativeDocument): Map<
     }
 
 
-fun <D, C> C.collectToMap(document: DeclarativeDocument): Map<DeclarativeDocument.Node, D> where C : NodeData<out D>, C : ValueData<out D> =
+fun <D, C> C.collectToMap(document: DeclarativeDocument): Map<DeclarativeDocument.Node, D> where C : NodeData<D>, C : ValueData<D> =
     buildMap {
         fun visit(node: DeclarativeDocument.Node) {
             put(node, data(node))
diff --git a/platforms/core-configuration/declarative-dsl-core/src/main/kotlin/org/gradle/internal/declarativedsl/dom/data/DocumentDataContainers.kt b/platforms/core-configuration/declarative-dsl-core/src/main/kotlin/org/gradle/internal/declarativedsl/dom/data/DocumentDataContainers.kt
index 442d521d17e..c649c722c6d 100644
--- a/platforms/core-configuration/declarative-dsl-core/src/main/kotlin/org/gradle/internal/declarativedsl/dom/data/DocumentDataContainers.kt
+++ b/platforms/core-configuration/declarative-dsl-core/src/main/kotlin/org/gradle/internal/declarativedsl/dom/data/DocumentDataContainers.kt
@@ -50,7 +50,7 @@ interface ValueDataContainer<out DValue, out DValueFactory : DValue, out DLitera
 typealias ValueData<DValue> = ValueDataContainer<DValue, DValue, DValue, DValue>
 
 
-fun <C, D> C.data(node: DeclarativeDocument.Node): D where C : NodeData<out D>, C : ValueData<out D> = when (node) {
+fun <C, D> C.data(node: DeclarativeDocument.Node): D where C : NodeData<D>, C : ValueData<D> = when (node) {
     is DeclarativeDocument.DocumentNode -> data(node)
     is DeclarativeDocument.ValueNode -> data(node)
 }
diff --git a/platforms/core-configuration/declarative-dsl-core/src/test/kotlin/org/gradle/internal/declarativedsl/parsing/RandomInputParsingTest.kt b/platforms/core-configuration/declarative-dsl-core/src/test/kotlin/org/gradle/internal/declarativedsl/parsing/RandomInputParsingTest.kt
index 4af9713a2a9..836b9c5533e 100644
--- a/platforms/core-configuration/declarative-dsl-core/src/test/kotlin/org/gradle/internal/declarativedsl/parsing/RandomInputParsingTest.kt
+++ b/platforms/core-configuration/declarative-dsl-core/src/test/kotlin/org/gradle/internal/declarativedsl/parsing/RandomInputParsingTest.kt
@@ -26,7 +26,7 @@ class RandomInputParsingTest(
             val inputDirectory = this::class.java.getResource("random")?.file?.let { File(it) } ?: error("missing input folder")
             inputDirectory.walk().forEach {
                 if (it.isFile) {
-                    parameters.add(arrayOf(it.relativeTo(inputDirectory).toString(), it))
+                    parameters.add(arrayOf<Any>(it.relativeTo(inputDirectory).toString(), it))
                 }
             }
 
diff --git a/platforms/core-configuration/declarative-dsl-evaluator/build.gradle.kts b/platforms/core-configuration/declarative-dsl-evaluator/build.gradle.kts
index c49433861a9..6204805e16a 100644
--- a/platforms/core-configuration/declarative-dsl-evaluator/build.gradle.kts
+++ b/platforms/core-configuration/declarative-dsl-evaluator/build.gradle.kts
@@ -14,9 +14,6 @@
  * limitations under the License.
  */
 
-import org.jetbrains.kotlin.gradle.dsl.KotlinVersion
-import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
-
 plugins {
     id("gradlebuild.distribution.implementation-kotlin")
     id("gradlebuild.publish-public-libraries")
@@ -26,13 +23,6 @@ plugins {
 
 description = "The evaluation pipeline for the Declarative language"
 
-tasks.withType<KotlinCompile>().configureEach {
-    compilerOptions {
-        apiVersion.set(KotlinVersion.KOTLIN_1_9)
-        languageVersion.set(KotlinVersion.KOTLIN_1_9)
-    }
-}
-
 dependencies {
     api(projects.declarativeDslCore)
     api(projects.declarativeDslToolingModels)
diff --git a/platforms/core-configuration/declarative-dsl-internal-utils/build.gradle.kts b/platforms/core-configuration/declarative-dsl-internal-utils/build.gradle.kts
index d1cb04d3aab..5d741c1878d 100644
--- a/platforms/core-configuration/declarative-dsl-internal-utils/build.gradle.kts
+++ b/platforms/core-configuration/declarative-dsl-internal-utils/build.gradle.kts
@@ -14,22 +14,12 @@
  * limitations under the License.
  */
 
-import org.jetbrains.kotlin.gradle.dsl.KotlinVersion
-import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
-
 plugins {
     id("gradlebuild.distribution.implementation-kotlin")
 }
 
 description = "DCL-related utilities that are meant to be reused in the Gradle subprojects but not in DCL client applications"
 
-tasks.withType<KotlinCompile>().configureEach {
-    compilerOptions {
-        apiVersion.set(KotlinVersion.KOTLIN_1_9)
-        languageVersion.set(KotlinVersion.KOTLIN_1_9)
-    }
-}
-
 dependencies {
     api(projects.core)
 
diff --git a/platforms/core-configuration/declarative-dsl-tooling-models/build.gradle.kts b/platforms/core-configuration/declarative-dsl-tooling-models/build.gradle.kts
index 415ad06acd0..66b6b573fb6 100644
--- a/platforms/core-configuration/declarative-dsl-tooling-models/build.gradle.kts
+++ b/platforms/core-configuration/declarative-dsl-tooling-models/build.gradle.kts
@@ -14,9 +14,6 @@
  * limitations under the License.
  */
 
-import org.jetbrains.kotlin.gradle.dsl.KotlinVersion
-import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
-
 plugins {
     id("gradlebuild.distribution.implementation-kotlin")
     id("gradlebuild.publish-public-libraries")
@@ -34,10 +31,3 @@ dependencies {
         )
     }
 }
-
-tasks.withType<KotlinCompile>().configureEach {
-    compilerOptions {
-        apiVersion.set(KotlinVersion.KOTLIN_1_9)
-        languageVersion.set(KotlinVersion.KOTLIN_1_9)
-    }
-}
diff --git a/platforms/core-configuration/flow-services/src/main/kotlin/org/gradle/internal/flow/services/BuildFlowScope.kt b/platforms/core-configuration/flow-services/src/main/kotlin/org/gradle/internal/flow/services/BuildFlowScope.kt
index 78eaa78f1d7..29e01185c01 100644
--- a/platforms/core-configuration/flow-services/src/main/kotlin/org/gradle/internal/flow/services/BuildFlowScope.kt
+++ b/platforms/core-configuration/flow-services/src/main/kotlin/org/gradle/internal/flow/services/BuildFlowScope.kt
@@ -113,6 +113,7 @@ open class BuildFlowScope @Inject internal constructor(
         state = state.load(memento)
     }
 
+    @Deprecated("Deprecated in Java")
     override fun buildFinished(result: BuildResult) {
         setBuildWorkResult(result.failure)
         schedulePendingActions()
diff --git a/platforms/core-configuration/graph-serialization/src/main/kotlin/org/gradle/internal/serialize/graph/Running.kt b/platforms/core-configuration/graph-serialization/src/main/kotlin/org/gradle/internal/serialize/graph/Running.kt
index 27c438f902e..7026b90dceb 100644
--- a/platforms/core-configuration/graph-serialization/src/main/kotlin/org/gradle/internal/serialize/graph/Running.kt
+++ b/platforms/core-configuration/graph-serialization/src/main/kotlin/org/gradle/internal/serialize/graph/Running.kt
@@ -27,7 +27,7 @@ import kotlin.coroutines.startCoroutine
  */
 fun <T : ReadContext, R> T.runReadOperation(readOperation: suspend T.() -> R): R {
     contract {
-        callsInPlace(readOperation, InvocationKind.EXACTLY_ONCE)
+        callsInPlace(readOperation, InvocationKind.AT_MOST_ONCE)
     }
     return runToCompletion {
         readOperation()
@@ -48,8 +48,12 @@ fun <T : WriteContext, U> T.runWriteOperation(writeOperation: suspend T.() -> U)
  * [Starts][startCoroutine] the suspending [block], asserts it runs
  * to completion and returns its result.
  */
+@Suppress("LEAKED_IN_PLACE_LAMBDA")
 private
 fun <R> runToCompletion(block: suspend () -> R): R {
+    contract {
+        callsInPlace(block, InvocationKind.AT_MOST_ONCE)
+    }
     var completion: Result<R>? = null
     block.startCoroutine(
         Continuation(EmptyCoroutineContext) {
diff --git a/platforms/core-configuration/kotlin-dsl-integ-tests/src/crossVersionTest/groovy/org/gradle/kotlin/dsl/plugins/PrecompiledKotlinPluginCrossVersionSpec.groovy b/platforms/core-configuration/kotlin-dsl-integ-tests/src/crossVersionTest/groovy/org/gradle/kotlin/dsl/plugins/PrecompiledKotlinPluginCrossVersionSpec.groovy
index c8ec28dd858..a6454a8582f 100644
--- a/platforms/core-configuration/kotlin-dsl-integ-tests/src/crossVersionTest/groovy/org/gradle/kotlin/dsl/plugins/PrecompiledKotlinPluginCrossVersionSpec.groovy
+++ b/platforms/core-configuration/kotlin-dsl-integ-tests/src/crossVersionTest/groovy/org/gradle/kotlin/dsl/plugins/PrecompiledKotlinPluginCrossVersionSpec.groovy
@@ -62,10 +62,10 @@ class PrecompiledKotlinPluginCrossVersionSpec extends CrossVersionIntegrationSpe
         assertSuccess(result)
     }
 
-    def "precompiled Kotlin plugins built with current Gradle version can be used with Gradle 8.11+"() {
+    def "precompiled Kotlin plugins built with current Gradle version can be used with Gradle 9.0.0+"() {
 
-        // 8.11 is the first version that embeds Kotlin 2.0 and can execute code compiled for Kotlin 2.0
-        assumeTrue(previous.version >= GradleVersion.version('8.11'))
+        // 9.0.0 is the first version that embeds Kotlin 2.2 and can execute code compiled for Kotlin 2.2
+        assumeTrue(previous.version >= GradleVersion.version('9.0.0'))
 
         given:
         precompiledKotlinPluginsBuiltWith(current)
@@ -77,18 +77,25 @@ class PrecompiledKotlinPluginCrossVersionSpec extends CrossVersionIntegrationSpe
         assertSuccess(result)
     }
 
-    def "precompiled Kotlin plugins built with current Gradle version can be used with Gradle 6.8+ targeting Kotlin 1.7"() {
+    def "precompiled Kotlin plugins built with current Gradle version can be used with Gradle #minGradle+ targeting Kotlin #kotlinLanguageVersion"() {
 
-        assumeTrue(previous.version >= GradleVersion.version('6.8'))
+        assumeTrue(previous.version >= GradleVersion.version(minGradle))
 
         given:
-        precompiledKotlinPluginsBuiltWith(current, "KOTLIN_1_7")
+        precompiledKotlinPluginsBuiltWith(current, "KOTLIN_${kotlinLanguageVersion.replace(".", "_")}")
 
         when:
         def result = pluginsAppliedWith(previous).run()
 
         then:
         assertSuccess(result)
+
+        where:
+        minGradle | kotlinLanguageVersion
+        "6.8"     | "1.8"
+        "6.8"     | "1.9"
+        "6.8"     | "2.0"
+        "8.11"    | "2.1"
     }
 
     private void precompiledKotlinPluginsBuiltWith(GradleDistribution distribution, String kotlinVersion = null) {
diff --git a/platforms/core-configuration/kotlin-dsl-integ-tests/src/crossVersionTest/groovy/org/gradle/kotlin/dsl/plugins/ProjectTheExtensionCrossVersionSpec.groovy b/platforms/core-configuration/kotlin-dsl-integ-tests/src/crossVersionTest/groovy/org/gradle/kotlin/dsl/plugins/ProjectTheExtensionCrossVersionSpec.groovy
index a83d50a7878..3788a8c3f1e 100644
--- a/platforms/core-configuration/kotlin-dsl-integ-tests/src/crossVersionTest/groovy/org/gradle/kotlin/dsl/plugins/ProjectTheExtensionCrossVersionSpec.groovy
+++ b/platforms/core-configuration/kotlin-dsl-integ-tests/src/crossVersionTest/groovy/org/gradle/kotlin/dsl/plugins/ProjectTheExtensionCrossVersionSpec.groovy
@@ -44,10 +44,10 @@ class ProjectTheExtensionCrossVersionSpec extends CrossVersionIntegrationSpec {
         pluginAppliedWith(current)
     }
 
-    def "can access extensions with Gradle 8.11+ from plugin built with current Gradle version"() {
+    def "can access extensions with Gradle 9.0.0+ from plugin built with current Gradle version"() {
 
-        // 8.11 is the first version that embeds Kotlin 2.0 and can execute code compiled for Kotlin 2.0
-        assumeTrue(previous.version >= GradleVersion.version('8.11'))
+        // 9.0.0 is the first version that embeds Kotlin 2.2 and can execute code compiled for Kotlin 2.2
+        assumeTrue(previous.version >= GradleVersion.version('9.0.0'))
 
         when:
         pluginBuiltWith(current)
@@ -56,15 +56,22 @@ class ProjectTheExtensionCrossVersionSpec extends CrossVersionIntegrationSpec {
         pluginAppliedWith(previous)
     }
 
-    def "can access extensions with Gradle 6.8+ from plugin built with current Gradle version targeting Kotlin 1.7"() {
+    def "can access extensions with Gradle #minGradle+ from plugin built with current Gradle version targeting Kotlin #kotlinLanguageVersion"() {
 
-        assumeTrue(previous.version >= GradleVersion.version('6.8'))
+        assumeTrue(previous.version >= GradleVersion.version(minGradle))
 
         when:
-        pluginBuiltWith(current, "KOTLIN_1_7")
+        pluginBuiltWith(current, "KOTLIN_${kotlinLanguageVersion.replace(".", "_")}")
 
         then:
         pluginAppliedWith(previous)
+
+        where:
+        minGradle | kotlinLanguageVersion
+        "6.8"     | "1.8"
+        "6.8"     | "1.9"
+        "6.8"     | "2.0"
+        "8.11"    | "2.1"
     }
 
     private void pluginBuiltWith(GradleDistribution distribution, String kotlinVersion = null) {
diff --git a/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/integration/KotlinDslPluginCustomKotlinOptionsIntegrationTest.kt b/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/integration/KotlinDslPluginCustomKotlinOptionsIntegrationTest.kt
index c209a23c6b9..a8fec04eace 100644
--- a/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/integration/KotlinDslPluginCustomKotlinOptionsIntegrationTest.kt
+++ b/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/integration/KotlinDslPluginCustomKotlinOptionsIntegrationTest.kt
@@ -30,6 +30,14 @@ class KotlinDslPluginCustomKotlinOptionsIntegrationTest : AbstractKotlinIntegrat
 
         withDefaultSettingsIn("buildSrc")
         val buildSrcBuildScript = withKotlinDslPluginIn("buildSrc")
+        buildSrcBuildScript.appendText("""
+            tasks.withType<org.jetbrains.kotlin.gradle.tasks.KotlinCompile>().configureEach {
+                compilerOptions {
+                    apiVersion.set(org.jetbrains.kotlin.gradle.dsl.KotlinVersion.KOTLIN_2_1)
+                    languageVersion.set(org.jetbrains.kotlin.gradle.dsl.KotlinVersion.KOTLIN_2_1)
+                }
+            }
+        """)
         withFile(
             "buildSrc/src/main/kotlin/MyDataObject.kt",
             """
@@ -41,15 +49,14 @@ class KotlinDslPluginCustomKotlinOptionsIntegrationTest : AbstractKotlinIntegrat
         )
         withBuildScript("println(MyDataObject.other)")
         buildAndFail("help").apply {
-            assertHasErrorOutput("""The feature "multi dollar interpolation" is experimental and should be enabled explicitly""")
+            assertHasErrorOutput("""The feature "multi dollar interpolation" is only available since language version 2.2""")
         }
 
         buildSrcBuildScript.appendText("""
             tasks.withType<org.jetbrains.kotlin.gradle.tasks.KotlinCompile>().configureEach {
                 compilerOptions {
-                    apiVersion.set(org.jetbrains.kotlin.gradle.dsl.KotlinVersion.KOTLIN_2_1)
-                    languageVersion.set(org.jetbrains.kotlin.gradle.dsl.KotlinVersion.KOTLIN_2_1)
-                    freeCompilerArgs.add("-Xmulti-dollar-interpolation")
+                    apiVersion.set(org.jetbrains.kotlin.gradle.dsl.KotlinVersion.KOTLIN_2_2)
+                    languageVersion.set(org.jetbrains.kotlin.gradle.dsl.KotlinVersion.KOTLIN_2_2)
                 }
             }
         """)
diff --git a/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslPluginCrossVersionSmokeTest.kt b/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslPluginCrossVersionSmokeTest.kt
index 47230c61cb7..bea7e6d9901 100644
--- a/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslPluginCrossVersionSmokeTest.kt
+++ b/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslPluginCrossVersionSmokeTest.kt
@@ -114,7 +114,8 @@ class KotlinDslPluginCrossVersionSmokeTest : AbstractKotlinIntegrationTest() {
         expectConfigurationCacheRequestedDeprecation()
         executer.expectExternalDeprecatedMessage("w: Language version 1.4 is deprecated and its support will be removed in a future version of Kotlin")
 
-        build("help").apply {
+        // Suppress CC problem caused by the outdated KGP version. Can be removed when KGP 2.0+ is used.
+        build("help", "-Dorg.gradle.configuration-cache.unsafe.ignore.unsupported-build-events-listeners=true").apply {
             assertThat(output, containsString("some!"))
         }
     }
diff --git a/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslPluginForOldestKotlinVersionTest.kt b/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslPluginForOldestKotlinVersionTest.kt
index 57b2e9b6954..51d4e411142 100644
--- a/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslPluginForOldestKotlinVersionTest.kt
+++ b/platforms/core-configuration/kotlin-dsl-integ-tests/src/integTest/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslPluginForOldestKotlinVersionTest.kt
@@ -28,7 +28,7 @@ import org.junit.Test
  */
 class KotlinDslPluginForOldestKotlinVersionTest : AbstractKotlinIntegrationTest() {
 
-    private val oldestKotlinLanguageVersion = "1.6"
+    private val oldestKotlinLanguageVersion = "1.8"
 
     @Test
     @Requires(
diff --git a/platforms/core-configuration/kotlin-dsl-plugins/build.gradle.kts b/platforms/core-configuration/kotlin-dsl-plugins/build.gradle.kts
index 1b48f6d57dd..32b0acd23fb 100644
--- a/platforms/core-configuration/kotlin-dsl-plugins/build.gradle.kts
+++ b/platforms/core-configuration/kotlin-dsl-plugins/build.gradle.kts
@@ -6,7 +6,7 @@ plugins {
 description = "Kotlin DSL Gradle Plugins deployed to the Plugin Portal"
 
 group = "org.gradle.kotlin"
-version = "6.1.3"
+version = "6.2.1"
 
 base.archivesName = "plugins"
 
diff --git a/platforms/core-configuration/kotlin-dsl-plugins/src/main/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslCompilerPlugins.kt b/platforms/core-configuration/kotlin-dsl-plugins/src/main/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslCompilerPlugins.kt
index c1a6350919b..44fdeb033c7 100644
--- a/platforms/core-configuration/kotlin-dsl-plugins/src/main/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslCompilerPlugins.kt
+++ b/platforms/core-configuration/kotlin-dsl-plugins/src/main/kotlin/org/gradle/kotlin/dsl/plugins/dsl/KotlinDslCompilerPlugins.kt
@@ -51,8 +51,8 @@ abstract class KotlinDslCompilerPlugins : Plugin<Project> {
 
         tasks.withType<KotlinCompile>().configureEach { kotlinCompile ->
             kotlinCompile.compilerOptions {
-                apiVersion.set(KotlinVersion.KOTLIN_2_1)
-                languageVersion.set(KotlinVersion.KOTLIN_2_1)
+                apiVersion.set(KotlinVersion.KOTLIN_2_2)
+                languageVersion.set(KotlinVersion.KOTLIN_2_2)
                 freeCompilerArgs.addAll(KotlinDslPluginSupport.kotlinCompilerArgs)
             }
             // Set this back to a warning for now, as this plugin is frequently used without toolchains specifying a JVM target, and it causes errors when using newer JDKs.
diff --git a/platforms/core-configuration/kotlin-dsl-provider-plugins/build.gradle.kts b/platforms/core-configuration/kotlin-dsl-provider-plugins/build.gradle.kts
index 0145172e290..1c4fdb0f266 100644
--- a/platforms/core-configuration/kotlin-dsl-provider-plugins/build.gradle.kts
+++ b/platforms/core-configuration/kotlin-dsl-provider-plugins/build.gradle.kts
@@ -41,7 +41,6 @@ dependencies {
         isTransitive = false
     }
     implementation(libs.kotlinCompilerEmbeddable)
-    implementation(libs.jspecify)
     implementation(libs.slf4jApi)
 
     compileOnly(libs.kotlinReflect)
diff --git a/platforms/core-configuration/kotlin-dsl/build.gradle.kts b/platforms/core-configuration/kotlin-dsl/build.gradle.kts
index a7c019e538b..1826943c45f 100644
--- a/platforms/core-configuration/kotlin-dsl/build.gradle.kts
+++ b/platforms/core-configuration/kotlin-dsl/build.gradle.kts
@@ -90,7 +90,7 @@ dependencies {
     implementation(libs.futureKotlin("assignment-compiler-plugin-embeddable")) {
         isTransitive = false
     }
-    shadow("org.jetbrains.kotlinx:kotlinx-metadata-jvm:0.9.0") {
+    shadow(libs.futureKotlin("metadata-jvm")) {
         isTransitive = false
     }
 
@@ -137,8 +137,6 @@ dependencies {
     testFixturesImplementation(projects.testKit)
     testFixturesImplementation(projects.internalTesting)
     testFixturesImplementation(projects.internalIntegTesting)
-    testFixturesImplementation(projects.unitTestFixtures)
-    testFixturesImplementation(projects.serviceRegistryImpl)
 
     testFixturesImplementation(testFixtures(projects.hashing))
 
@@ -152,7 +150,7 @@ dependencies {
     integTestDistributionRuntimeOnly(projects.distributionsBasics)
 }
 
-// Relocate kotlinx-metadata-jvm
+// Relocate kotlin-metadata-jvm
 configurations.compileOnly {
     extendsFrom(configurations.shadow.get())
 }
diff --git a/platforms/core-configuration/kotlin-dsl/src/integTest/kotlin/org/gradle/kotlin/dsl/support/EmbeddedKotlinProviderTest.kt b/platforms/core-configuration/kotlin-dsl/src/integTest/kotlin/org/gradle/kotlin/dsl/support/EmbeddedKotlinProviderTest.kt
index e3f5be36c2b..245b43caf78 100644
--- a/platforms/core-configuration/kotlin-dsl/src/integTest/kotlin/org/gradle/kotlin/dsl/support/EmbeddedKotlinProviderTest.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/integTest/kotlin/org/gradle/kotlin/dsl/support/EmbeddedKotlinProviderTest.kt
@@ -45,24 +45,25 @@ class EmbeddedKotlinProviderTest : AbstractKotlinIntegrationTest() {
     @Test
     @Category(Flaky::class) // https://github.com/gradle/gradle-private/issues/4723
     fun `stdlib and reflect are pinned to the embedded kotlin version for requested plugins`() {
+        val requestedKotlinVersion = "2.0.0"
         withBuildScript(
             """
             buildscript {
                 $repositoriesBlock
                 dependencies {
-                    classpath("org.jetbrains.kotlin:kotlin-stdlib:2.0.0")
-                    classpath("org.jetbrains.kotlin:kotlin-reflect:2.0.0")
+                    classpath("org.jetbrains.kotlin:kotlin-stdlib:$requestedKotlinVersion")
+                    classpath("org.jetbrains.kotlin:kotlin-reflect:$requestedKotlinVersion")
                 }
             }
             plugins {
-                kotlin("jvm") version "2.0.0"
+                kotlin("jvm") version "$requestedKotlinVersion"
             }
             """
         )
 
         val result = build("buildEnvironment")
         listOf("stdlib", "reflect").forEach { module ->
-            assertThat(result.output, containsString("org.jetbrains.kotlin:kotlin-$module:2.0.0 -> $embeddedKotlinVersion"))
+            assertThat(result.output, containsString("org.jetbrains.kotlin:kotlin-$module:$requestedKotlinVersion -> $embeddedKotlinVersion"))
         }
     }
 
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinBuildScript.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinBuildScript.kt
index c41abe56561..d89c18c42fd 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinBuildScript.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinBuildScript.kt
@@ -39,8 +39,8 @@ import kotlin.script.templates.ScriptTemplateDefinition
 )
 @ScriptTemplateAdditionalCompilerArguments(
     [
-        "-language-version", "2.1",
-        "-api-version", "2.1",
+        "-language-version", "2.2",
+        "-api-version", "2.2",
         "-Xjvm-default=all",
         "-Xjsr305=strict",
         "-Xjspecify-annotations=strict",
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinDslStandaloneScriptCompilationConfiguration.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinDslStandaloneScriptCompilationConfiguration.kt
index 11c28774de4..d7ea4681def 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinDslStandaloneScriptCompilationConfiguration.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinDslStandaloneScriptCompilationConfiguration.kt
@@ -33,8 +33,8 @@ abstract class KotlinDslStandaloneScriptCompilationConfiguration protected const
 
     isStandalone(true)
     compilerOptions.put(listOf(
-        "-language-version", "2.1",
-        "-api-version", "2.1",
+        "-language-version", "2.2",
+        "-api-version", "2.2",
         "-Xjvm-default=all",
         "-Xjsr305=strict",
         "-Xjspecify-annotations=strict",
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinInitScript.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinInitScript.kt
index 2c84694f506..b4e5c7e8769 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinInitScript.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinInitScript.kt
@@ -39,8 +39,8 @@ import kotlin.script.templates.ScriptTemplateDefinition
 )
 @ScriptTemplateAdditionalCompilerArguments(
     [
-        "-language-version", "2.1",
-        "-api-version", "2.1",
+        "-language-version", "2.2",
+        "-api-version", "2.2",
         "-Xjvm-default=all",
         "-Xjsr305=strict",
         "-Xjspecify-annotations=strict",
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinSettingsScript.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinSettingsScript.kt
index ff322caafd1..6680f3b1355 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinSettingsScript.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/KotlinSettingsScript.kt
@@ -38,8 +38,8 @@ import kotlin.script.templates.ScriptTemplateDefinition
 )
 @ScriptTemplateAdditionalCompilerArguments(
     [
-        "-language-version", "2.1",
-        "-api-version", "2.1",
+        "-language-version", "2.2",
+        "-api-version", "2.2",
         "-Xjvm-default=all",
         "-Xjsr305=strict",
         "-Xjspecify-annotations=strict",
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorFragment.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorFragment.kt
index cbd351199fa..2e91b38106b 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorFragment.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorFragment.kt
@@ -16,13 +16,11 @@
 
 package org.gradle.kotlin.dsl.accessors
 
-import kotlinx.metadata.KmPackage
-import kotlinx.metadata.jvm.JvmMethodSignature
-
 import org.gradle.model.internal.asm.AsmConstants.ASM_LEVEL
-
 import org.jetbrains.org.objectweb.asm.ClassVisitor
 import org.jetbrains.org.objectweb.asm.ClassWriter
+import kotlin.metadata.KmPackage
+import kotlin.metadata.jvm.JvmMethodSignature
 
 
 internal
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorFragments.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorFragments.kt
index 4b1364496ae..29a9dad3751 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorFragments.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/AccessorFragments.kt
@@ -15,15 +15,6 @@
  */
 package org.gradle.kotlin.dsl.accessors
 
-import kotlinx.metadata.KmFunction
-import kotlinx.metadata.KmProperty
-import kotlinx.metadata.KmPropertyAccessorAttributes
-import kotlinx.metadata.KmType
-import kotlinx.metadata.KmTypeProjection
-import kotlinx.metadata.KmVariance
-import kotlinx.metadata.hasAnnotations
-import kotlinx.metadata.isNullable
-import kotlinx.metadata.jvm.JvmMethodSignature
 import org.gradle.api.Action
 import org.gradle.api.Incubating
 import org.gradle.api.Project
@@ -64,6 +55,15 @@ import org.gradle.kotlin.dsl.support.uppercaseFirstChar
 import org.jetbrains.org.objectweb.asm.AnnotationVisitor
 import org.jetbrains.org.objectweb.asm.MethodVisitor
 import org.jetbrains.org.objectweb.asm.Type
+import kotlin.metadata.KmFunction
+import kotlin.metadata.KmProperty
+import kotlin.metadata.KmPropertyAccessorAttributes
+import kotlin.metadata.KmType
+import kotlin.metadata.KmTypeProjection
+import kotlin.metadata.KmVariance
+import kotlin.metadata.isNullable
+import kotlin.metadata.jvm.JvmMethodSignature
+import kotlin.metadata.jvm.hasAnnotationsInBytecode
 
 
 internal
@@ -819,7 +819,7 @@ fun MetadataFragmentScope.maybeFunctionHasAnnotations(attributes: KmFunction.()
     useLowPriorityInOverloadResolution -> {
         {
             attributes(this)
-            hasAnnotations = true
+            hasAnnotationsInBytecode = true
         }
     }
 
@@ -831,7 +831,7 @@ fun MetadataFragmentScope.maybePropertyHasAnnotations(attributes: KmProperty.()
     useLowPriorityInOverloadResolution -> {
         {
             attributes(this)
-            hasAnnotations = true
+            hasAnnotationsInBytecode = true
         }
     }
 
@@ -945,37 +945,37 @@ fun fragmentsForExtension(accessor: Accessor.ForExtension): Fragments {
 
 private fun KmFunction.hasAnnotationsIfDeprecated(deprecation: Deprecated?) {
     if (deprecation != null) {
-        hasAnnotations = true
+        hasAnnotationsInBytecode = true
     }
 }
 
 private fun KmProperty.hasAnnotationsIfDeprecated(deprecation: Deprecated?) {
     if (deprecation != null) {
-        hasAnnotations = true
+        hasAnnotationsInBytecode = true
     }
 }
 
 private fun KmPropertyAccessorAttributes.hasAnnotationsIfDeprecated(deprecation: Deprecated?) {
     if (deprecation != null) {
-        hasAnnotations = true
+        hasAnnotationsInBytecode = true
     }
 }
 
 private fun KmFunction.hasAnnotationsIfRequiresOptIn(optInRequirements: List<AnnotationRepresentation>?) {
     if (optInRequirements != null) {
-        hasAnnotations = true
+        hasAnnotationsInBytecode = true
     }
 }
 
 private fun KmProperty.hasAnnotationsIfRequiresOptIn(optInRequirements: List<AnnotationRepresentation>?) {
     if (optInRequirements != null) {
-        hasAnnotations = true
+        hasAnnotationsInBytecode = true
     }
 }
 
 private fun KmPropertyAccessorAttributes.hasAnnotationsIfRequiresOptIn(optInRequirements: List<AnnotationRepresentation>?) {
     if (optInRequirements != null) {
-        hasAnnotations = true
+        hasAnnotationsInBytecode = true
     }
 }
 
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/GeneratePluginSpecBuilderAccessors.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/GeneratePluginSpecBuilderAccessors.kt
index 0fa18aa142e..33eb8682295 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/GeneratePluginSpecBuilderAccessors.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/GeneratePluginSpecBuilderAccessors.kt
@@ -18,7 +18,6 @@
 
 package org.gradle.kotlin.dsl.accessors
 
-import kotlinx.metadata.jvm.JvmMethodSignature
 import org.gradle.api.Project
 import org.gradle.api.internal.file.FileCollectionFactory
 import org.gradle.api.internal.initialization.ClassLoaderScope
@@ -68,6 +67,7 @@ import org.jetbrains.org.objectweb.asm.ClassWriter
 import org.jetbrains.org.objectweb.asm.MethodVisitor
 import java.io.BufferedWriter
 import java.io.File
+import kotlin.metadata.jvm.JvmMethodSignature
 
 
 /**
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/GenerateVersionCatalogAccessors.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/GenerateVersionCatalogAccessors.kt
index d1b7df89ec7..a3f5c93b6ba 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/GenerateVersionCatalogAccessors.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/GenerateVersionCatalogAccessors.kt
@@ -16,7 +16,6 @@
 
 package org.gradle.kotlin.dsl.accessors
 
-import kotlinx.metadata.jvm.JvmMethodSignature
 import org.gradle.api.Project
 import org.gradle.api.internal.catalog.ExternalModuleDependencyFactory
 import org.gradle.api.internal.file.FileCollectionFactory
@@ -56,6 +55,7 @@ import org.gradle.kotlin.dsl.support.useToRun
 import org.jetbrains.org.objectweb.asm.ClassWriter
 import java.io.BufferedWriter
 import java.io.File
+import kotlin.metadata.jvm.JvmMethodSignature
 import kotlin.reflect.KClass
 
 
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/KotlinType.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/KotlinType.kt
index ace642214fc..67f495e30ae 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/KotlinType.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/KotlinType.kt
@@ -16,9 +16,9 @@
 
 package org.gradle.kotlin.dsl.accessors
 
-import kotlinx.metadata.KmType
 import org.gradle.kotlin.dsl.support.bytecode.newClassTypeOf
 import org.gradle.kotlin.dsl.support.bytecode.newTypeParameterTypeOf
+import kotlin.metadata.KmType
 
 
 internal
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/Stage1BlocksAccessorClassPath.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/Stage1BlocksAccessorClassPath.kt
index 20b479638d6..4294565490e 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/Stage1BlocksAccessorClassPath.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/accessors/Stage1BlocksAccessorClassPath.kt
@@ -16,7 +16,6 @@
 
 package org.gradle.kotlin.dsl.accessors
 
-import kotlinx.metadata.KmType
 import org.gradle.api.Project
 import org.gradle.api.internal.catalog.ExternalModuleDependencyFactory
 import org.gradle.api.internal.file.FileCollectionFactory
@@ -44,6 +43,7 @@ import org.gradle.kotlin.dsl.support.bytecode.InternalName
 import org.gradle.kotlin.dsl.support.bytecode.newClassTypeOf
 import java.io.File
 import javax.inject.Inject
+import kotlin.metadata.KmType
 
 
 /**
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/execution/ProgramSource.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/execution/ProgramSource.kt
index 440159a3fe8..625faf8f3de 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/execution/ProgramSource.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/execution/ProgramSource.kt
@@ -17,6 +17,7 @@
 package org.gradle.kotlin.dsl.execution
 
 
+@ConsistentCopyVisibility
 data class ProgramSource internal constructor(val path: String, val contents: ProgramText) {
 
     constructor(path: String, contents: String) : this(path, text(contents))
@@ -32,6 +33,7 @@ data class ProgramSource internal constructor(val path: String, val contents: Pr
 /**
  * Normalised program text guaranteed to use `\n` as the only line terminator character.
  */
+@ConsistentCopyVisibility
 data class ProgramText private constructor(val text: String) {
 
     companion object {
@@ -99,6 +101,7 @@ fun ProgramSource.fragment(section: ScriptSection) =
     ProgramSourceFragment(this, section)
 
 
+@ConsistentCopyVisibility
 data class ProgramSourceFragment internal constructor(
     val source: ProgramSource,
     internal val section: ScriptSection
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/normalization/KotlinApiMemberWriter.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/normalization/KotlinApiMemberWriter.kt
index 23a64557118..c52b0b3021b 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/normalization/KotlinApiMemberWriter.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/normalization/KotlinApiMemberWriter.kt
@@ -16,13 +16,6 @@
 
 package org.gradle.kotlin.dsl.normalization
 
-import kotlinx.metadata.KmDeclarationContainer
-import kotlinx.metadata.Visibility
-import kotlinx.metadata.isInline
-import kotlinx.metadata.jvm.KotlinClassMetadata
-import kotlinx.metadata.jvm.Metadata
-import kotlinx.metadata.jvm.signature
-import kotlinx.metadata.visibility
 import org.gradle.internal.tools.api.ApiClassExtractionException
 import org.gradle.internal.tools.api.impl.AnnotationMember
 import org.gradle.internal.tools.api.impl.ArrayAnnotationValue
@@ -33,6 +26,13 @@ import org.gradle.internal.tools.api.impl.JavaApiMemberWriter
 import org.gradle.internal.tools.api.impl.MethodMember
 import org.gradle.internal.tools.api.impl.SimpleAnnotationValue
 import org.objectweb.asm.ClassVisitor
+import kotlin.metadata.KmDeclarationContainer
+import kotlin.metadata.Visibility
+import kotlin.metadata.isInline
+import kotlin.metadata.jvm.KotlinClassMetadata
+import kotlin.metadata.jvm.Metadata
+import kotlin.metadata.jvm.signature
+import kotlin.metadata.visibility
 
 
 internal
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/resolver/ResolverEvent.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/resolver/ResolverEvent.kt
index 9d3badfc20d..bf252ef83c6 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/resolver/ResolverEvent.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/resolver/ResolverEvent.kt
@@ -27,6 +27,7 @@ internal
 sealed class ResolverEvent
 
 
+@ConsistentCopyVisibility
 internal
 data class ResolutionRequest internal constructor(
     val correlationId: String,
@@ -36,6 +37,7 @@ data class ResolutionRequest internal constructor(
 ) : ResolverEvent()
 
 
+@ConsistentCopyVisibility
 internal
 data class ResolutionFailure internal constructor(
     val correlationId: String,
@@ -44,6 +46,7 @@ data class ResolutionFailure internal constructor(
 ) : ResolverEvent()
 
 
+@ConsistentCopyVisibility
 internal
 data class SubmittedModelRequest internal constructor(
     val correlationId: String,
@@ -60,6 +63,7 @@ data class RequestCancelled(
 ) : ResolverEvent()
 
 
+@ConsistentCopyVisibility
 internal
 data class ReceivedModelResponse internal constructor(
     val correlationId: String,
@@ -68,6 +72,7 @@ data class ReceivedModelResponse internal constructor(
 ) : ResolverEvent()
 
 
+@ConsistentCopyVisibility
 internal
 data class ResolvedDependencies internal constructor(
     val correlationId: String,
@@ -76,6 +81,7 @@ data class ResolvedDependencies internal constructor(
 ) : ResolverEvent()
 
 
+@ConsistentCopyVisibility
 internal
 data class ResolvedDependenciesWithErrors internal constructor(
     val correlationId: String,
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/KotlinCompiler.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/KotlinCompiler.kt
index be6b96479ab..d356bbcbfa2 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/KotlinCompiler.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/KotlinCompiler.kt
@@ -57,7 +57,7 @@ import org.jetbrains.kotlin.config.JvmClosureGenerationScheme
 import org.jetbrains.kotlin.config.JvmDefaultMode
 import org.jetbrains.kotlin.config.JvmTarget
 import org.jetbrains.kotlin.config.JvmTarget.JVM_1_8
-import org.jetbrains.kotlin.config.JvmTarget.JVM_23
+import org.jetbrains.kotlin.config.JvmTarget.JVM_24
 import org.jetbrains.kotlin.config.LanguageVersion
 import org.jetbrains.kotlin.config.LanguageVersionSettingsImpl
 import org.jetbrains.kotlin.load.java.JavaTypeEnhancementState
@@ -426,22 +426,22 @@ fun compilerConfigurationFor(messageCollector: MessageCollector, compilerOptions
 @VisibleForTesting
 internal
 fun JavaVersion.toKotlinJvmTarget(): JvmTarget {
-    // JvmTarget.fromString(JavaVersion.majorVersion) works from Java 9 to Java 23
+    // JvmTarget.fromString(JavaVersion.majorVersion) works from Java 9 to Java 24
     return JvmTarget.fromString(majorVersion)
         ?: if (this <= JavaVersion.VERSION_1_8) JVM_1_8
-        else JVM_23
+        else JVM_24
 }
 
 
 private
 fun gradleKotlinDslLanguageVersionSettingsFor(compilerOptions: KotlinCompilerOptions) = LanguageVersionSettingsImpl(
-    languageVersion = LanguageVersion.KOTLIN_2_1,
-    apiVersion = ApiVersion.KOTLIN_2_1,
+    languageVersion = LanguageVersion.KOTLIN_2_2,
+    apiVersion = ApiVersion.KOTLIN_2_2,
     analysisFlags = mapOf(
         AnalysisFlags.skipMetadataVersionCheck to compilerOptions.skipMetadataVersionCheck,
         AnalysisFlags.skipPrereleaseCheck to true,
         AnalysisFlags.allowUnstableDependencies to true,
-        JvmAnalysisFlags.jvmDefaultMode to JvmDefaultMode.ALL,
+        JvmAnalysisFlags.jvmDefaultMode to JvmDefaultMode.ENABLE,
         JvmAnalysisFlags.javaTypeEnhancementState to JavaTypeEnhancementState(
             jsr305 = Jsr305Settings(globalLevel = ReportLevel.STRICT, migrationLevel = ReportLevel.STRICT),
             getReportLevelForAnnotation = { ReportLevel.STRICT }
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/KotlinScriptType.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/KotlinScriptType.kt
index b7b09b0b509..1166df2b23a 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/KotlinScriptType.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/KotlinScriptType.kt
@@ -28,6 +28,7 @@ enum class KotlinScriptType {
 }
 
 
+@ConsistentCopyVisibility
 data class KotlinScriptTypeMatch private constructor(
     val scriptType: KotlinScriptType,
     val match: Match
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/bytecode/KotlinMetadata.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/bytecode/KotlinMetadata.kt
index b0dba14087f..50dc494a89a 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/bytecode/KotlinMetadata.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/bytecode/KotlinMetadata.kt
@@ -16,36 +16,6 @@
 
 package org.gradle.kotlin.dsl.support.bytecode
 
-import kotlinx.metadata.KmClassifier
-import kotlinx.metadata.KmFunction
-import kotlinx.metadata.KmPackage
-import kotlinx.metadata.KmProperty
-import kotlinx.metadata.KmPropertyAccessorAttributes
-import kotlinx.metadata.KmType
-import kotlinx.metadata.KmTypeParameter
-import kotlinx.metadata.KmTypeProjection
-import kotlinx.metadata.KmValueParameter
-import kotlinx.metadata.KmVariance
-import kotlinx.metadata.MemberKind
-import kotlinx.metadata.Visibility
-import kotlinx.metadata.declaresDefaultValue
-import kotlinx.metadata.hasAnnotations
-import kotlinx.metadata.isInline
-import kotlinx.metadata.isNotDefault
-import kotlinx.metadata.isNullable
-import kotlinx.metadata.jvm.JvmMetadataVersion
-import kotlinx.metadata.jvm.JvmMethodSignature
-import kotlinx.metadata.jvm.KmModule
-import kotlinx.metadata.jvm.KmPackageParts
-import kotlinx.metadata.jvm.KotlinClassMetadata
-import kotlinx.metadata.jvm.KotlinModuleMetadata
-import kotlinx.metadata.jvm.UnstableMetadataApi
-import kotlinx.metadata.jvm.getterSignature
-import kotlinx.metadata.jvm.moduleName
-import kotlinx.metadata.jvm.signature
-import kotlinx.metadata.jvm.syntheticMethodForAnnotations
-import kotlinx.metadata.kind
-import kotlinx.metadata.visibility
 import org.gradle.kotlin.dsl.accessors.ExtensionSpec
 import org.gradle.kotlin.dsl.accessors.accessorDescriptorFor
 import org.gradle.kotlin.dsl.support.uppercaseFirstChar
@@ -54,6 +24,36 @@ import org.jetbrains.org.objectweb.asm.ClassWriter
 import org.jetbrains.org.objectweb.asm.MethodVisitor
 import org.jetbrains.org.objectweb.asm.Opcodes
 import java.io.File
+import kotlin.metadata.KmClassifier
+import kotlin.metadata.KmFunction
+import kotlin.metadata.KmPackage
+import kotlin.metadata.KmProperty
+import kotlin.metadata.KmPropertyAccessorAttributes
+import kotlin.metadata.KmType
+import kotlin.metadata.KmTypeParameter
+import kotlin.metadata.KmTypeProjection
+import kotlin.metadata.KmValueParameter
+import kotlin.metadata.KmVariance
+import kotlin.metadata.MemberKind
+import kotlin.metadata.Visibility
+import kotlin.metadata.declaresDefaultValue
+import kotlin.metadata.isInline
+import kotlin.metadata.isNotDefault
+import kotlin.metadata.isNullable
+import kotlin.metadata.jvm.JvmMetadataVersion
+import kotlin.metadata.jvm.JvmMethodSignature
+import kotlin.metadata.jvm.KmModule
+import kotlin.metadata.jvm.KmPackageParts
+import kotlin.metadata.jvm.KotlinClassMetadata
+import kotlin.metadata.jvm.KotlinModuleMetadata
+import kotlin.metadata.jvm.UnstableMetadataApi
+import kotlin.metadata.jvm.getterSignature
+import kotlin.metadata.jvm.hasAnnotationsInBytecode
+import kotlin.metadata.jvm.moduleName
+import kotlin.metadata.jvm.signature
+import kotlin.metadata.jvm.syntheticMethodForAnnotations
+import kotlin.metadata.kind
+import kotlin.metadata.visibility
 
 
 internal
@@ -343,5 +343,5 @@ val publicFunctionAttributes: KmFunction.() -> Unit = {
 internal
 val publicFunctionWithAnnotationsAttributes: KmFunction.() -> Unit = {
     publicFunctionAttributes(this)
-    hasAnnotations = true
+    hasAnnotationsInBytecode = true
 }
diff --git a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/delegates/GradleDelegate.kt b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/delegates/GradleDelegate.kt
index 8b4ee7e35f2..540f1e456ec 100644
--- a/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/delegates/GradleDelegate.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/main/kotlin/org/gradle/kotlin/dsl/support/delegates/GradleDelegate.kt
@@ -127,12 +127,14 @@ abstract class GradleDelegate : Gradle {
     override fun projectsEvaluated(action: Action<in Gradle>) =
         delegate.projectsEvaluated(action)
 
-    @Suppress("DEPRECATION")
+    @Deprecated("This method is not supported when configuration caching is enabled.")
     override fun buildFinished(closure: Closure<Any>) =
+        @Suppress("DEPRECATION")
         delegate.buildFinished(closure)
 
-    @Suppress("DEPRECATION")
+    @Deprecated("This method is not supported when configuration caching is enabled.")
     override fun buildFinished(action: Action<in BuildResult>) =
+        @Suppress("DEPRECATION")
         delegate.buildFinished(action)
 
     override fun addBuildListener(buildListener: BuildListener) =
@@ -144,9 +146,9 @@ abstract class GradleDelegate : Gradle {
     override fun removeListener(listener: Any) =
         delegate.removeListener(listener)
 
-    @Suppress("DEPRECATION")
     @Deprecated("Will be removed in Gradle 10. Logging customization through listeners is no longer supported.")
     override fun useLogger(logger: Any) =
+        @Suppress("DEPRECATION")
         delegate.useLogger(logger)
 
     override fun getGradle(): Gradle =
diff --git a/platforms/core-configuration/kotlin-dsl/src/test/kotlin/org/gradle/kotlin/dsl/support/KotlinCompilerTest.kt b/platforms/core-configuration/kotlin-dsl/src/test/kotlin/org/gradle/kotlin/dsl/support/KotlinCompilerTest.kt
index 7ae5ca22487..86bd385be01 100644
--- a/platforms/core-configuration/kotlin-dsl/src/test/kotlin/org/gradle/kotlin/dsl/support/KotlinCompilerTest.kt
+++ b/platforms/core-configuration/kotlin-dsl/src/test/kotlin/org/gradle/kotlin/dsl/support/KotlinCompilerTest.kt
@@ -27,6 +27,7 @@ class KotlinCompilerTest {
 
     @Test
     fun `Gradle JavaVersion to Kotlin JvmTarget direct conversion`() {
+        assertThat(JavaVersion.VERSION_24.toKotlinJvmTarget(), equalTo(JvmTarget.JVM_24))
         assertThat(JavaVersion.VERSION_23.toKotlinJvmTarget(), equalTo(JvmTarget.JVM_23))
         assertThat(JavaVersion.VERSION_22.toKotlinJvmTarget(), equalTo(JvmTarget.JVM_22))
         assertThat(JavaVersion.VERSION_21.toKotlinJvmTarget(), equalTo(JvmTarget.JVM_21))
@@ -53,9 +54,9 @@ class KotlinCompilerTest {
     }
 
     @Test
-    fun `Gradle JavaVersion greater than 23 to Kotlin JvmTarget conversion`() {
-        JavaVersion.values().filter { it > JavaVersion.VERSION_23 }.forEach { javaVersion ->
-            assertThat(javaVersion.toKotlinJvmTarget(), equalTo(JvmTarget.JVM_23))
+    fun `Gradle JavaVersion greater than 24 to Kotlin JvmTarget conversion`() {
+        JavaVersion.values().filter { it > JavaVersion.VERSION_24 }.forEach { javaVersion ->
+            assertThat(javaVersion.toKotlinJvmTarget(), equalTo(JvmTarget.JVM_24))
         }
     }
 }
diff --git a/platforms/core-configuration/model-reflect/build.gradle.kts b/platforms/core-configuration/model-reflect/build.gradle.kts
index c3db409f8af..aa8bb0c24f2 100644
--- a/platforms/core-configuration/model-reflect/build.gradle.kts
+++ b/platforms/core-configuration/model-reflect/build.gradle.kts
@@ -19,9 +19,6 @@ dependencies {
     implementation(libs.groovy)
     implementation(libs.inject)
 
-    testImplementation(testFixtures(projects.persistentCache))
-    testImplementation(testFixtures(projects.core))
-
     testFixturesApi(projects.internalIntegTesting)
     testFixturesImplementation(libs.guava)
 }
diff --git a/platforms/documentation/docs/src/docs/userguide/dep-man/dependency-management/dependency_locking.adoc b/platforms/documentation/docs/src/docs/userguide/dep-man/dependency-management/dependency_locking.adoc
index baca97e7b61..8e92bf1fb3a 100644
--- a/platforms/documentation/docs/src/docs/userguide/dep-man/dependency-management/dependency_locking.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/dep-man/dependency-management/dependency_locking.adoc
@@ -153,6 +153,18 @@ include::sample[dir="snippets/dependencyManagement/dependencyLocking-lockingAllC
 By filtering and resolving specific configurations, you ensure that only the relevant ones are locked, tailoring the locking process to your project's needs.
 This is especially useful in environments like native builds, where not all configurations can be resolved on a single platform.
 
+== Understanding the locking mechanism during dependency resolution
+
+When using dependency locking, Gradle enforces the locked versions as if they were declared with `strictly()`.
+
+This means:
+
+- If the declared version is **lower** than the locked version (e.g., declared `1.0.0`, locked `1.2.0`), Gradle will silently upgrade to the locked version.
+- If the declared version is **higher** than the locked version (e.g., declared `1.2.0`, locked `1.0.0`), Gradle will **fail resolution**, because the lockfile enforces `1.0.0` strictly.
+
+This can be surprising if you assume the declared version takes precedence.
+To resolve this, update the lockfile with `--write-locks`.
+
 [[sec:lock-state]]
 == Understanding lock state location and format
 
diff --git a/platforms/documentation/docs/src/docs/userguide/dep-man/how-to/how_to_share_outputs_between_projects.adoc b/platforms/documentation/docs/src/docs/userguide/dep-man/how-to/how_to_share_outputs_between_projects.adoc
index e8dce61cccd..f93185336cb 100644
--- a/platforms/documentation/docs/src/docs/userguide/dep-man/how-to/how_to_share_outputs_between_projects.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/dep-man/how-to/how_to_share_outputs_between_projects.adoc
@@ -30,7 +30,16 @@ Unlike simple project dependencies, _variant-aware sharing_ provides:
 [[sec:setup-producer]]
 == Step 1: Configuring the Producer Project
 
-To get started, you should check the existing variants of the producer project by running the `outgoingVariants` task:
+Let's take a producer project that produces a Java library:
+
+====
+include::sample[dir="snippets/how-to/share-outputs/kotlin",files="producer/build.gradle.kts[tags=java-lib]"]
+include::sample[dir="snippets/how-to/share-outputs/groovy",files="producer/build.gradle[tags=java-lib]"]
+====
+
+To get started, you should check the existing variants of the producer project by running the `outgoingVariants` task.
+
+Our Java library produces the following variant for the `runtimeElements` configuration:
 
 [source,bash]
 ----
@@ -54,7 +63,7 @@ Artifacts
 - build/libs/producer.jar (artifactType = jar)
 ----
 
-What it tells us is that this Java Library plugin produces variants with 5 attributes:
+Specifically, the Java library produces a variant `runtimeElements` with 5 attributes:
 
 1. `org.gradle.category` - this variant represents a library
 2. `org.gradle.dependency.bundling` - the dependencies of this variant are found as jars (they are not, for example, repackaged inside the jar)
@@ -62,18 +71,20 @@ What it tells us is that this Java Library plugin produces variants with 5 attri
 4. `org.gradle.libraryelements` - this variant contains all elements found in a jar (classes and resources)
 5. `org.gradle.usage` - this variant is a Java runtime, therefore suitable for a Java compiler but also at runtime
 
-The producer project defines an artifact (e.g., an instrumented JAR) that other projects can consume based on attributes.
+Let's say that the producer project defines an artifact (e.g., an instrumented JAR) that other projects can consume based on attributes.
 If we want the instrumented classes to be used in place of the existing variant when executing tests, we need to attach similar attributes to this variant.
-In fact, the attribute we care about is `org.gradle.libraryelements` which explains what the variant contains.
 
-First, the following task defines a custom JAR artifact with an instrumented classifier (e.g., `producer-instrumented.jar)`:
+In this case, the attribute we care about is `org.gradle.libraryelements`.
+This attribute explains _what_ the variant contains.
+
+The following task in the producer build file defines a custom JAR artifact with an instrumented classifier (e.g., `producer-instrumented.jar)`:
 
 ====
 include::sample[dir="snippets/how-to/share-outputs/kotlin",files="producer/build.gradle.kts[tags=instrumentedjar-task]"]
 include::sample[dir="snippets/how-to/share-outputs/groovy",files="producer/build.gradle[tags=instrumentedjar-task]"]
 ====
 
-Second, a configuration  is created which:
+The producer build file also creates a new configuration which:
 
 - Provides an artifact variant for consumption.
 - This variant is a `runtime-library` artifact with the element type `instrumented-jar`.
@@ -90,16 +101,22 @@ This configuration ensures that only the correct artifacts are exposed and preve
 [[sec:setup-consumer]]
 == Step 2: Configuring the consumer project
 
-The consumer project requests the instrumented JAR by defining matching attributes.
+In Gradle, it's recommended to separate the configuration where you declare dependencies from the one where you resolve artifacts.
+
+First, the consumer project creates two configurations:
 
-First, the consumer explicitly requests a runtime usage artifact with the variant marked as `instrumented-jar`:
+* `instrumentedRuntimeDependencies` is used to declare a dependency on the producer.
+* `instrumentedRuntime` is a resolvable configuration that resolves all the dependencies declared in `instrumentedRuntimeDependencies`, including `instrumentedJars`.
 
 ====
 include::sample[dir="snippets/how-to/share-outputs/kotlin",files="consumer/build.gradle.kts[tags=custom-config]"]
 include::sample[dir="snippets/how-to/share-outputs/groovy",files="consumer/build.gradle[tags=custom-config]"]
 ====
 
-Then, a dependency is added on the producer:
+Now, the consumer project declares a dependency on the producer and aligns its configuration with the desired variant by defining attributes.
+When the configuration is resolved, Gradle uses these attributes to select a compatible variant published by the producer.
+
+Second, a dependency is added on the producer on `instrumentedRuntimeDependencies`:
 
 ====
 include::sample[dir="snippets/how-to/share-outputs/kotlin",files="consumer/build.gradle.kts[tags=dependency]"]
@@ -107,7 +124,7 @@ include::sample[dir="snippets/how-to/share-outputs/groovy",files="consumer/build
 ====
 
 Finally, we use the artifact variant in a task.
-This task runs the application using the resolved instrumented JAR from the producer:
+The `runWithInstrumentation` task runs the application using the resolved instrumented JAR from the producer:
 
 ====
 include::sample[dir="snippets/how-to/share-outputs/kotlin",files="consumer/build.gradle.kts[tags=task]"]
@@ -157,12 +174,17 @@ include::sample[dir="snippets/dependencyManagement/modelingFeatures-crossProject
 
 If the consumer fails to resolve the artifact, check:
 
-- The attributes in the consumer match those in the producer.
+- The attributes in the consumer are compatible with those in the producer.
 - The producer project properly declares the artifact.
 - There are no conflicting configurations with different attributes.
 
 [[sec:conclusion]]
 == Summary
 
+There are two perspectives to keep in mind:
+
+1. *Configuring a project*: You configure configurations, which declare how your build consumes or produces artifacts.
+2. *Referencing a project*: Gradle resolves variants published by other projects, selecting the best match based on compatibility with the consuming configurations attributes.
+
 _Variant-aware_ sharing enables clean and flexible artifact sharing between projects.
 It avoids hardcoded task dependencies and improves build maintainability.
diff --git a/platforms/documentation/docs/src/docs/userguide/img/deprecations.png b/platforms/documentation/docs/src/docs/userguide/img/deprecations.png
index 6fd6b55b93c..43f5d4fa420 100644
Binary files a/platforms/documentation/docs/src/docs/userguide/img/deprecations.png and b/platforms/documentation/docs/src/docs/userguide/img/deprecations.png differ
diff --git a/platforms/documentation/docs/src/docs/userguide/releases/compatibility.adoc b/platforms/documentation/docs/src/docs/userguide/releases/compatibility.adoc
index 990bda4e35e..db7d3f55dc4 100644
--- a/platforms/documentation/docs/src/docs/userguide/releases/compatibility.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/releases/compatibility.adoc
@@ -100,7 +100,7 @@ Beta and RC versions may or may not work.
 | 1.9.24 | 8.10 | 1.8
 | 2.0.20 | 8.11 | 1.8
 | 2.0.21 | 8.12 | 1.8
-| 2.1.21 | 9.0 | 2.1
+| 2.2.0  | 9.0 | 2.2
 |===
 
 == Groovy
diff --git a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_major_version_9.adoc b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_major_version_9.adoc
new file mode 100644
index 00000000000..f4da0e5bd00
--- /dev/null
+++ b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_major_version_9.adoc
@@ -0,0 +1,822 @@
+// Copyright (C) 2025 Gradle, Inc.
+//
+// Licensed under the Creative Commons Attribution-Noncommercial-ShareAlike 4.0 International License.;
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      https://creativecommons.org/licenses/by-nc-sa/4.0/
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+[[upgrading_major_version_9]]
+
+= Upgrading to Gradle 9.0.0
+
+This chapter provides the information you need to migrate your Gradle {gradleVersion8} builds to Gradle {gradleVersion90}.
+For migrating within Gradle 8.x, see the <<upgrading_version_8.adoc#upgrading_version_8, older migration guide>> first.
+
+We recommend the following steps for all users:
+
+. Try running `gradle help --scan` and view the https://gradle.com/enterprise/releases/2018.4/#identify-usages-of-deprecated-gradle-functionality[deprecations view] of the generated Build Scan.
++
+image::deprecations.png[Deprecations View in a Build Scan]
++
+This lets you see any deprecation warnings that apply to your build.
++
+Alternatively, you can run `gradle help --warning-mode=all` to see the deprecations in the console, though it may not report as much detailed information.
+. Update your plugins.
++
+Some plugins may break with a new major version of Gradle, as these releases can remove public APIs.
+Using the latest version of a plugin increases the likelihood that it is already compatible with the new major Gradle version.
++
+. Run `gradle wrapper --gradle-version {gradleVersion90}` to update the project to {gradleVersion90}.
+. Try to run the project and debug any errors using the <<troubleshooting.adoc#troubleshooting, Troubleshooting Guide>>.
+
+[[changes_major_9]]
+== Runtime requirements and DSL changes
+
+[[jvm-17]]
+=== Java Virtual Machine (JVM) 17 or higher is required
+
+Gradle 9.0.0 requires a Java Virtual Machine (JVM) version 17 or higher to run the Gradle Daemon.
+This is a breaking change from previous versions, which supported JVM 8 and higher.
+
+Your build can still target lower JVM versions using <<toolchains.adoc#toolchains, Toolchains>> for compilation, testing and other workers (Checkstyle, Javadoc, etc).
+
+The <<gradle_wrapper.adoc#gradle_wrapper_reference,Gradle wrapper>> and command-line launcher can run with JVM 8, but it still requires a newer JVM to start the build.
+For more, see the <<upgrading_version_8.adoc#minimum_daemon_jvm_version,Running Gradle on older JVMs>> section below.
+
+<<tooling_api.adoc#embedding,Gradle Tooling API>> and <<test_kit#test_kit, TestKit>> remain compatible with JVM 8 and higher.
+
+[[kotlin-2]]
+==== Upgrade to Kotlin 2.2.0
+
+Gradle now embeds Kotlin 2.2.0, upgrading from the previously embedded version 2.0.21.
+
+For full details and potential breaking changes, consult the link:https://github.com/JetBrains/kotlin/releases/tag/v2.2.0[Kotlin release notes].
+
+==== Kotlin DSL and plugins use the Kotlin language version 2.2
+
+The Kotlin DSL has been upgraded to the latest stable link:https://kotlinlang.org/docs/whatsnew2120.html[Kotlin 2.2.x] runtime and uses Kotlin language version 2.2 across the entire toolchain.
+This marks a shift from Gradle 8.x, which embedded link:https://kotlinlang.org/docs/whatsnew20.html[Kotlin 2.0] starting in 8.11 but continued using Kotlin language version 1.8 for compatibility.
+
+This change impacts not only Kotlin DSL scripts (`.gradle.kts`) but also build logic and plugins written in Kotlin (both classic and convention plugins).
+Users should review their code for compatibility with link:https://kotlinlang.org/docs/compatibility-guide-22.html[Kotlin 2.2], as both link:https://kotlinlang.org/docs/compatibility-guide-20.html[Kotlin 2.0] and link:https://kotlinlang.org/docs/compatibility-guide-21.html[Kotlin 2.1] introduced several breaking language changes.
+
+Due to changes in how the Kotlin 2 compiler handles script compilation, you can no longer refer to the script instance using labels like `this@Build_gradle`, `this@Settings_gradle`, or `this@Init_gradle`.
+If they are used to reference the DSL script target object, then use `project`, `settings`, or `gradle` instead.
+If they are used to reference a top-level symbol that happens to have the same name as a nested symbol, then use a different name, possibly by adding an intermediary variable.
+
+This upgrade also includes an important change for build-logic and plugin authors: support for Kotlin language versions from 1.4 to 1.7 has been removed.
+
+Read the link:#jspecify[JSpecify section] below to learn about potential breaking changes in Kotlin build logic code related to nullability.
+
+[[groovy-4]]
+=== Upgrade to Groovy 4.0.27
+
+Groovy has been upgraded from version 3.0.24 to https://groovy-lang.org/changelogs/changelog-4.0.27.html[4.0.27].
+The update to Groovy 4 comes with many breaking changes, such as the removal of legacy packages, changes in the module structure, a parser rewrite, and bytecode output changes.
+For a complete overview of Groovy language changes from 3.x to 4.x, see the https://groovy-lang.org/releasenotes/groovy-4.0.html[Groovy 4.0 release notes].
+These changes may affect those who use Groovy directly or indirectly in Gradle, and in rare cases, users relying on transitive dependencies.
+
+==== `is`-prefixed `Boolean` properties no longer recognized by Groovy
+
+Groovy 4 no longer treats getters with an `is` prefix and a `Boolean` return type as properties.
+Gradle still recognizes these as properties for now, but this behavior will change in Gradle 10 to align with Groovy 4.
+See <<upgrading_version_8.adoc#groovy_boolean_properties,the deprecation notice>> for more details.
+
+==== `DELEGATE_FIRST` closures may now prefer the delegate in some cases
+
+Groovy 4 has changed the behavior of closures using the `DELEGATE_FIRST` strategy.
+Dynamic lookups for properties and methods will now prefer the delegate over the owner.
+This can result in different behavior when using closures in Gradle scripts, such as certain methods not being found
+or (e.g. with `.with { }`) some dynamic properties taking precedence over outer properties or methods.
+Generally, this should not affect Gradle scripts, as Gradle does not use `DELEGATE_FIRST` closures with dynamic properties in its API.
+
+Workarounds include using `@CompileStatic` to avoid dynamic lookups, or explicitly qualifying calls with `owner.`, `this.`, or `super.` as needed.
+
+For full clarity, in Groovy 3, the lookup order was:
+
+1. Delegate's `invokeMethod`, which chooses known methods and does no dynamic lookup.
+2. Owner's `invokeMethod`, which chooses known methods and does no dynamic lookup.
+3. Delegate's `invokeMissingMethod`, which does dynamic lookup including via properties.
+4. Owner's `invokeMissingMethod`, which does dynamic lookup including via properties.
+
+In Groovy 4, the lookup order is:
+
+1. Delegate's `invokeMethod`, which chooses known methods and does no dynamic lookup.
+2. Delegate's `invokeMissingMethod`, which does dynamic lookup including via properties.
+3. Owner's `invokeMethod`, which chooses known methods and does no dynamic lookup.
+4. Owner's `invokeMissingMethod`, which does dynamic lookup including via properties.
+
+==== Private properties and methods may be inaccessible in closures
+
+Closures defined in a parent class that reference its private properties or methods may no longer have access to them in subclasses.
+This is due to a https://issues.apache.org/jira/browse/GROOVY-11568[Groovy bug] that will not be resolved until Groovy 5.
+This applies to both buildscripts and plugins written in Groovy.
+
+As a workaround, apply `@CompileStatic` to the class to remove the dynamic lookup.
+
+This is tracked by https://github.com/gradle/gradle/issues/32476.
+
+==== Super methods may be inaccessible from Groovy 3.x code
+
+Groovy 4 changed how `super` method calls are resolved at runtime.
+As a result, code compiled with Groovy 3.x may be unable to access `super` methods,
+as the code does not contain the appropriate runtime code to locate them.
+This only applies to plugins written in Groovy 3.x, from Gradle 8.x and earlier.
+
+== Plugin changes
+
+=== Plugins written with the Kotlin DSL require Gradle >= 8.11
+
+When building and publishing plugins using the Kotlin DSL on Gradle 9.x.x, those plugins will only be usable on Gradle 8.11 or newer.
+This is because Gradle 8.11 is the first release that embeds Kotlin 2.0 or higher, which is required to interpret Kotlin metadata version 2.
+
+If you want your plugin to remain compatible with older Gradle versions, you must explicitly compile it against an earlier Kotlin version (1.x).
+
+For example, to support Gradle 6.8 and newer, configure your plugin to target Kotlin 1.7 like this:
+
+.build.gradle.kts
+[source,kotlin]
+----
+import org.jetbrains.kotlin.gradle.dsl.KotlinVersion
+import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
+
+plugins {
+    `kotlin-dsl`
+}
+
+tasks.withType<KotlinCompile>().configureEach {
+    compilerOptions {
+        languageVersion = KotlinVersion.KOTLIN_1_7
+        apiVersion = KotlinVersion.KOTLIN_1_7
+    }
+}
+----
+
+Refer to Gradles link:compatibility.html#kotlin[compatibility matrix] for details on which Kotlin version is embedded in each Gradle release.
+
+NOTE: Plugins written using the Kotlin DSL and published with Gradle 7.x or 8.x remain compatible with Gradle 6.8 and newer.
+
+=== Plugins written with the Groovy DSL require Gradle >= 7.0
+
+Plugins authored using the Groovy DSL and built with Gradle 9.x.x require Gradle 7.0 or newer to run.
+This is because Gradle 7.0 introduced Groovy 3.0 support, and Gradle 9 embeds Groovy 4.0.
+
+Since Gradle 9.0.0 uses Groovy 4.0 internally, plugins built with it may not behave as expected when run on older Gradle versions.
+For best compatibility, such plugins should be used with Gradle 9.0.0 or later.
+
+NOTE: Plugins written with the Groovy DSL and published using Gradle 7.x or 8.x remain compatible with Gradle 5.0 and above.
+
+=== Lowest supported Kotlin Gradle Plugin version change
+
+Starting with Gradle 9.0.0, the minimum supported Kotlin Gradle Plugin version is 2.0.0.
+Earlier versions are no longer supported as they rely on Gradle APIs that have been removed.
+
+For Gradle 8.x, the minimum supported version was 1.6.10.
+
+=== Lowest supported Android Gradle Plugin version change
+
+Starting with Gradle 9.0.0, the minimum supported Android Gradle Plugin version is 8.4.0.
+Earlier versions are no longer supported as they rely on Gradle APIs that have been removed.
+
+For Gradle 8.x, the minimum supported version was 7.3.0.
+
+=== Lowest supported Gradle Enterprise Plugin version change
+
+Starting with Gradle 9.0.0, the minimum supported Gradle Enterprise Plugin version is 3.13.1.
+Earlier versions are no longer supported as they rely on Gradle APIs that have been removed.
+
+Consider upgrading to the latest version of the Gradle Enterprise Plugin,
+or better yet, upgrade to the latest version of the link:https://docs.gradle.com/develocity/gradle-plugin[Develocity Plugin].
+
+For Gradle 8.x, the minimum supported version was 3.0.
+
+=== C++ and Swift plugins no longer depend on software model based plugins
+
+<<cpp_application_plugin.adoc#cpp_application_plugin,Cpp Application Plugin>>, <<cpp_library_plugin.adoc#cpp_library_plugin,Cpp Library Plugin>>, <<swift_application_plugin.adoc#swift_application_plugin,Swift Application Plugin>>, and <<swift_library_plugin.adoc#swift_library_plugin,Swift Library Plugin>> have been updated and no longer rely on the software model plugin infrastructure.
+
+As a result, `toolChains` should now be configured directly at the top-level of your build script instead of within a `model { }` block.
+
+=== Scala plugins no longer create unresolvable configurations
+
+Previously, the Scala plugins used configurations named `incrementalScalaAnalysisFor` to resolve incremental analysis information between projects.
+However, these configurations were unresolvable and could lead to errors in the `dependencies` report.
+
+As of Gradle 9.0.0, these configurations are no longer created or used by the Scala plugins.
+
+== Settings file changes
+
+=== Project directories must exist and be writeable
+
+Gradle will fail if a project is included that does not correspond to an existing directory on the file system, or if the directory exists but is read-only.
+
+For example, you may see an error like:
+
+[source,text]
+----
+
+* What went wrong:
+Configuring project ':subproject1' without an existing directory is not allowed. The configured projectDirectory '.../subproject1' does not exist, can't be written to or is not a directory.
+
+* Try:
+> Make sure the project directory exists and is writable.
+----
+
+See <<upgrading_version_8.adoc#deprecated_missing_project_directory>> for more details.
+
+== Task changes
+
+[[validate_plugins_without_java_toolchain_90]]
+=== `ValidatePlugins` task now requires Java Toolchains
+
+In Gradle 9.0.0, using the link:{javadocPath}/org/gradle/plugin/devel/tasks/ValidatePlugins.html[`ValidatePlugins`] task without applying the <<toolchains.adoc#toolchains,Java Toolchains>> plugin will result in an error.
+
+To fix this, explicitly apply the `jvm-toolchains` plugin:
+
+====
+[.multi-language-sample]
+=====
+.build.gradle.kts
+[source,kotlin]
+----
+plugins {
+    id("jvm-toolchains")
+}
+----
+=====
+[.multi-language-sample]
+=====
+.build.gradle
+[source,groovy]
+----
+plugins {
+    id 'jvm-toolchains'
+}
+----
+=====
+====
+
+TIP: The `jvm-toolchains` plugin is automatically applied by the <<java_library_plugin.adoc#java_library_plugin,Java Library Plugin>> and other JVM-related plugins.
+If you are already applying one of those, no further action is needed.
+
+=== `test` task fails when no tests are discovered
+
+When test sources are present and no filters are applied, the `test` task will now fail with an error if it runs but doesnt discover any tests.
+This is to help prevent misconfigurations where the tests are written for one test framework but the test task is mistakenly configured to use another test framework.
+If filters are applied, the outcome depends on the `failOnNoMatchingTests` property.
+
+This behavior can be disabled by setting the `failOnNoDiscoveredTests` property to `false` in the test task configuration:
+
+====
+[.multi-language-sample]
+=====
+.build.gradle.kts
+[source,kotlin]
+----
+tasks.withType<AbstractTestTask>().configureEach {
+    failOnNoDiscoveredTests = false
+}
+----
+=====
+[.multi-language-sample]
+=====
+.build.gradle
+[source,groovy]
+----
+tasks.withType(AbstractTestTask).configureEach {
+    failOnNoDiscoveredTests = false
+}
+----
+=====
+====
+
+=== Stale outputs outside the build directory are no longer deleted
+
+In previous versions of Gradle, class files located outside the build directory were deleted when considered stale. This was a special case for class files registered as outputs of a source set.
+
+Because this setup is uncommon and forced Gradle to eagerly realize all compile related tasks in every build, the behavior has been removed in Gradle 9.0.0.
+
+Gradle will continue to clean up stale outputs inside the build directory as needed.
+
+=== `model` and `component` tasks are no longer automatically added
+
+The `model` and `component` tasks report on the structure of legacy software model objects configured for the project.
+Previously, these tasks were automatically added to the project for every build.
+These tasks are now only added to a project when a rule-based plugin is applied (such as those provided by Gradle's support for building native software).
+
+== API changes
+
+[[jspecify]]
+=== Gradle API now uses JSpecify nullability annotations
+
+Gradle has supported null safety in its public API since Gradle 5.0, allowing early detection of nullability issues when writing Kotlin build scripts or plugin code in Java or Kotlin.
+
+Previously, Gradle used annotations from the now-dormant link:https://jcp.org/en/jsr/detail?id=305[JSR-305] to indicate nullability.
+While useful, JSR-305 had limitations and is no longer actively maintained.
+
+Starting with Gradle 9.0.0, the Gradle API now uses link:https://jspecify.dev/[JSpecify] annotations.
+JSpecify provides a modern, standardized set of annotations and semantics for nullability in Java APIs, improving support in IDEs and during compilation.
+
+Because JSpecify's semantics differ slightly from JSR-305, you might see new warnings or errors in your Kotlin or Java plugin code.
+These typically indicate places where you need to clarify or adjust null handling, and modern compilers and IDEs should provide helpful messages to guide you.
+
+Kotlin 2.1, when combined with JSpecify annotations in the Gradle API, introduces stricter nullability handling.
+Some formerly-valid code may now fail to compile due to more precise type checking.
+
+Common breaking changes:
+
+- Unbounded generics for types that have generic bounds will now fail to compile.
++
+For example if you have a Kotlin extension function on `Provider<T>` whose signature is `fun <T> Provider<T>.some()` you must qualify `<T>` as  `<T : Any>` because `T` isn't nullable on `Provider<T>`.
+
+- The nullability of generic bounds is now handled strictly.
++
+For example, you can't use `Property<String?>` anymore because the `T` in `Property<T>` is not nullable.
++
+Another example is using a function from the Gradle API that takes a `Map<String, *>` parameter ; you could pass a map with nullable values before, you can't do that anymore.
+
+NOTE: Plugins that use `javax.annotation` (JSR-305) annotations will continue to work in Gradle 9.0.0 as they did before.
+
+=== Methods on public API types made final
+
+The methods link:{javadocPath}/org/gradle/api/specs/AndSpec.html#findUnsatisfiedSpec(java.lang.Object)[`AndSpec.and`] and link:{javadocPath}/org/gradle/api/reporting/GenerateBuildDashboard.html#aggregate(org.gradle.api.reporting.Reporting...)[`GenerateBuildDashboard.aggregate`] have been declared `final` to support the use of the `@SafeVarargs` annotation.
+
+These types were not intended to be subclassed.
+However, if your build logic or a plugin attempts to override these methods, it will now result in a runtime failure.
+
+=== Injection getters are now `abstract`
+
+All Gradle-provided classes that have `@Inject` annotated getters now have those getters declared as `abstract`.
+This will require all classes that extend Gradle-provided classes to be `abstract`.
+
+=== `ConfigurationVariant.getDescription` is now a `Property<String>`
+
+This method was added in Gradle 7.5 and was previously a `Optional<String>`.
+This property was not configurable by public APIs.
+
+By making the description a `Property<String>`, secondary variants have a user configurable description that appears in the <<variant_aware_resolution.adoc#outgoing_variants_report,`outgoingVariants` report>>.
+
+=== New subtypes of `ComponentIdentifier` introduced
+
+Gradle 9.0.0 introduces link:{javadocPath}/org/gradle/api/artifacts/component/RootComponentIdentifier.html)[`RootComponentIdentifier`], a new subtype of link:{javadocPath}/org/gradle/api/artifacts/component/ComponentIdentifier.html)[`ComponentIdentifier`].
+
+APIs which return instances of `ComponentIdentifier` may now return identifier instances of this new type.
+For example, the link:{javadocPath}/org/gradle/api/artifacts/result/ComponentResult.html)[`ComponentResult`], link:{javadocPath}/org/gradle/api/artifacts/result/ResolvedVariantResult.html)[`ResolvedVariantResult`], and link:{javadocPath}/org/gradle/api/artifacts/ArtifactView.ViewConfiguration.html)[`ArtifactView`] APIs, among others, are affected.
+
+In future Gradle versions, additional subtypes of `ComponentIdentifier` may be introduced.
+Build logic should remain resilient to unknown `ComponentIdentifier` subtypes returned by Gradle APIs.
+
+== Packaging and artifact behavior changes
+
+=== Artifact Signing now matches OpenPGP Key Version
+
+Starting with Gradle 9.0.0, the `signing` plugin produces OpenPGP signatures that match the version of the key used. This change ensures compliance with link:https://www.rfc-editor.org/rfc/rfc9580.html[RFC 9580] and introduces support for OpenPGP version 6 keys.
+Previously, Gradle always generated OpenPGP version 4 signatures, regardless of the key version.
+
+=== Ear and War plugins build all artifacts with `assemble`
+
+Prior to Gradle 9.0.0, applying multiple packaging plugins (e.g., `ear`, `war`, `java`) to the same project resulted in special behavior where only one artifact type was built during `assemble`.
+For example:
+
+- Applying the `ear` plugin would skip building `war` and `jar` artifacts.
+- Applying the `war` plugin would skip building the `jar`.
+
+This special handling has been removed in Gradle 9.0.0.
+Now, if multiple packaging plugins are applied, all corresponding artifacts will be built when running the `assemble` task.
+For example, a project applying the `ear`, `war`, and `java plugins` will now produce `.ear`, `.war`, and `.jar` files during `assemble`.
+
+=== Ear and War plugins contribute all artifacts to the `archives` configuration
+
+In previous versions of Gradle, applying multiple packaging plugins (`ear`, `war`, `java`) resulted in selective behavior for the `archives` configuration.
+For example:
+
+- Applying the `ear` plugin excluded `jar` and `war` artifacts from archives.
+- Applying the `war` plugin excluded the `jar` artifact from archives.
+
+This behavior has been removed in Gradle 9.0.0.
+Now, when multiple packaging plugins are applied, all related artifactsEAR, WAR, and JARare included in the `archives` configuration.
+
+=== Gradle no longer implicitly builds certain artifacts during `assemble`
+
+In previous versions of Gradle, the `assemble` task would implicitly build artifacts from any configuration where the `visible` flag was not set to `false`.
+This behavior has been removed in Gradle 9.0.0.
+
+If you have a custom configuration and want its artifact to be built as part of `assemble`, you now need to explicitly declare the dependency between the artifact and the `assemble` task:
+
+====
+[.multi-language-sample]
+=====
+.build.gradle.kts
+[source,kotlin]
+----
+val specialJar = tasks.register<Jar>("specialJar") {
+    from("foo")
+}
+
+val special = configurations.create("special") {
+    // In previous versions, this would have been enough to build the specialJar
+    // artifact when running assemble
+    outgoing.artifact(specialJar)
+}
+
+// In Gradle 9.0.0, you need to add a dependency from the artifact to the assemble task
+tasks.named("assemble") {
+    dependsOn(special.artifacts)
+}
+----
+=====
+[.multi-language-sample]
+=====
+.build.gradle
+[source,groovy]
+----
+def specialJar = tasks.register("specialJar". Jar) {
+    from("foo")
+}
+
+def special = configurations.create("special") {
+    // In previous versions, this would have been enough to build the specialJar
+    // artifact when running assemble
+    outgoing.artifact(specialJar)
+}
+
+// In Gradle 9.0.0, you need to add a dependency from the artifact to the assemble task
+tasks.named("assemble") {
+    dependsOn(special.artifacts)
+}
+----
+=====
+====
+
+=== Gradle no longer implicitly adds certain artifacts to the `archives` configuration
+
+In previous versions of Gradle, the `archives` configuration would automatically include artifacts from any configuration where the `visible` flag was not set to `false`.
+This implicit behavior has been removed in Gradle 9.0.0.
+
+To include a custom artifact in the `archives` configuration, you must now add it explicitly:
+
+====
+[.multi-language-sample]
+=====
+.build.gradle.kts
+[source,kotlin]
+----
+val specialJar = tasks.register<Jar>("specialJar") {
+    from("foo")
+}
+
+configurations {
+    create("special") {
+        // In previous versions, this would have been enough to add the specialJar
+        // artifact to the archives configuration
+        outgoing.artifact(specialJar)
+    }
+    // In Gradle 9.0.0, you need to explicitly add the artifact to the archives
+    // configuration
+    named("archives") {
+        outgoing.artifact(specialJar)
+    }
+}
+----
+=====
+[.multi-language-sample]
+=====
+.build.gradle
+[source,groovy]
+----
+def specialJar = tasks.register("specialJar". Jar) {
+    from("foo")
+}
+
+configurations {
+    create("special") {
+        // In previous versions, this would have been enough to add the specialJar
+        // artifact to the archives configuration
+        outgoing.artifact(specialJar)
+    }
+    // In Gradle 9.0.0, you need to explicitly add the artifact to the archives
+    // configuration
+    named("archives") {
+        outgoing.artifact(specialJar)
+    }
+}
+----
+=====
+====
+
+=== Gradle Module Metadata can no longer be modified after an eagerly created publication is created from the same component
+
+This behavior previously caused a warning: `Gradle Module Metadata is modified after an eagerly populated publication.`
+
+It will now fail with an error, suggesting a review of the relevant documentation.
+
+== Configuration Cache changes
+
+=== Unsupported build event listeners are now configuration cache problems
+
+The build event listener registration method link:{javadocPath}/org/gradle/build/event/BuildEventsListenerRegistry.html#onTaskCompletion(org.gradle.api.provider.Provider)[`BuildEventsListenerRegistry.onTaskCompletion`]
+accepts arbitrary providers of any link:{javadocPath}/org/gradle/tooling/events/OperationCompletionListener.html[`OperationCompletionListener`] implementations.
+However, only providers returned from link:{javadocPath}/org/gradle/api/services/BuildServiceRegistry.html#registerIfAbsent(java.lang.String,java.lang.Class,org.gradle.api.Action)[`BuildServiceRegistry.registerIfAbsent`]
+or link:{javadocPath}/org/gradle/api/services/BuildServiceRegistration.html#getService()[`BuildServiceRegistration.getService`] are currently supported when the Configuration Cache is enabled.
+
+Previously, unsupported providers were silently discarded and never received events when the configuration cache was used.
+Starting with Gradle 9.0.0, registering such providers now causes a configuration cache problem and fails the build.
+
+If your build was previously working with the configuration cache (e.g., the listeners were nonessential), you can temporarily revert to the old behavior by setting:
+
+[source,properties]
+----
+org.gradle.configuration-cache.unsafe.ignore.unsupported-build-events-listeners=true
+----
+
+This property will be removed in Gradle 10.
+
+=== Configuration Cache entry is now always discarded for incompatible tasks in warning mode
+
+Configuration Cache enables gradual migration by allowing to explicitly mark tasks as <<configuration_cache_debugging.adoc#config_cache:task_opt_out,incompatible>>.
+When incompatible tasks are scheduled for execution, cache entry is not stored and tasks do not run in parallel to ensure correctness.
+Configuration Cache can also run in the <<configuration_cache_enabling.adoc#config_cache:usage:ignore_problems,warning mode>> by enabling `org.gradle.configuration-cache.problems=warn`,
+which hides problems and allows storing and loading of the cache entry, running tasks in parallel with potential issues.
+The warning mode exists as a migration and troubleshooting aid and is not intended as a persistent way of ignoring incompatibilities.
+
+Starting with Gradle 9.0.0, the presence of incompatible tasks in the work graph results in the cache entry being discarded regardless of the warning mode to ensure correctness.
+If you relied on the warning mode previously, consider marking the offending tasks as incompatible instead.
+However, at this stage of Configuration Cache maturity and ecosystem adoption, we recommend resolving the incompatibilities instead to ensure performance benefits this feature brings.
+
+== Updated versions
+
+=== Upgraded default versions of code quality tools
+
+The default version of Checkstyle is link:https://checkstyle.sourceforge.io/releasenotes.html#Release_10.24.0[10.24.0].
+
+The default version of CodeNarc is link:https://github.com/CodeNarc/CodeNarc/blob/v3.6.0/CHANGELOG.md#version-360--feb-2025[3.6.0].
+
+The default version of Pmd is link:https://github.com/pmd/pmd/releases/tag/pmd_releases%2F7.13.0[7.13.0]
+
+=== Upgraded default versions of testing frameworks
+
+When using test suites, the version of several testing frameworks has changed.
+
+The default version of JUnit Jupiter is link:https://junit.org/junit5/docs/5.12.2/release-notes/index.html#release-notes-5.12.2[5.12.2].
+
+The default version of TestNG is link:https://github.com/testng-team/testng/releases/tag/7.11.0[7.11.0].
+
+The default version of Spock is link:https://spockframework.org/spock/docs/2.3/release_notes.html[2.3].
+
+=== Upgraded version of Eclipse JGit
+
+Eclipse JGit has been updated from 5.13.3 to link:https://projects.eclipse.org/projects/technology.jgit/releases/7.2.1[7.2.1].
+
+This update reworks how Gradle configures JGit for SSH operations and introduces support for using the SSH Agent, leveraging the new capabilities available in link:https://github.com/eclipse-jgit/jgit/blob/v7.2.1.202505142326-r/org.eclipse.jgit.ssh.apache.agent/README.md[JGits] SSH agent integration.
+
+== Removed APIs and features
+
+=== Removal of deprecated `JvmVendorSpec.IBM_SEMERU`
+
+The deprecated `JvmVendorSpec.IBM_SEMERU` constant has been removed.
+Its usage should be replaced by link:{javadocPath}/org/gradle/jvm/toolchain/JvmVendorSpec.html#IBM[`JvmVendorSpec.IBM`].
+
+=== Removal of `GroovySourceSet` and `ScalaSourceSet` interfaces
+
+The following source set interfaces have been removed in Gradle 9.0.0:
+
+- `org.gradle.api.tasks.GroovySourceSet`
+- `org.gradle.api.tasks.ScalaSourceSet`
+
+To configure Groovy or Scala sources, use the plugin-specific Source Directory Sets instead:
+
+- `groovy`: link:{javadocPath}/org/gradle/api/tasks/GroovySourceDirectorySet.html[GroovySourceDirectorySet]
+- `scala`: link:{javadocPath}/org/gradle/api/tasks/ScalaSourceDirectorySet.html[ScalaSourceDirectorySet]
+
+For example, to configure Groovy sources in a plugin:
+
+[source,java]
+----
+GroovySourceDirectorySet groovySources = sourceSet.getExtensions().getByType(GroovySourceDirectorySet.class);
+groovySources.setSrcDirs(Arrays.asList("sources/groovy"));
+----
+
+=== Removal of custom build layout options
+
+The ability to specify custom locations for key build files from the command line has been removed in Gradle 9.0.0.
+The following options, deprecated in Gradle 8.x, are no longer supported:
+
+* `-c`, `--settings-file`  Specify a custom location for the settings file
+* `-b`, `--build-file`  Specify a custom location for the build file
+
+In addition, the `buildFile` property on the link:{groovyDslPath}/org.gradle.api.tasks.GradleBuild.html[GradleBuild] task has been removed.
+This means it is no longer possible to set a custom build file path via the `GradleBuild` task.
+
+=== Removal of conventions
+
+The _"convention"_ conceptrepresented by the `org.gradle.api.plugins.Convention` typehas been deprecated since Gradle 8.2 and is now fully removed in Gradle 9.0.0.
+
+Core Gradle plugins that previously registered deprecated conventions have been updated accordingly.
+
+This implies removal of the Conventions API. These have been removed:
+
+- `org.gradle.api.Task.getConvention()`
+- `org.gradle.api.Project.getConvention()`
+- `org.gradle.api.plugins.Convention`
+- `org.gradle.api.internal.HasConvention`
+
+Existing plugins that use these APIs will fail with Gradle 9.0.0+ and should be updated to use the Extensions API instead.
+
+The table below shows which conventions have been removed and how to migrate:
+
+[cols="1,1,1,5"]
+|===
+|Plugin |Access |Type |Solution
+
+|`war` |`project.war` | `WarPluginConvention` | Configure the `war` task directly instead.
+|`base` | `project.distDirName`, `project.libsDirName`, `project.archivesBaseName` | `BasePluginConvention` | Replaced by `project.base` extension of type `BasePluginExtension`.
+| `project-report` | `project.projectReports` | `ProjectReportPluginConvention` | Configure the report task (`TaskReportTask`, `PropertyReportTask`, `DependencyReportTask`, `HtmlDependencyReportTask`) directly.
+|`ear` |`project.ear` | `EarPluginConvention` | Configure the `ear` task directly instead.
+|===
+
+=== Removal of `org.gradle.cache.cleanup`
+
+The `org.gradle.cache.cleanup` property, which previously allowed users to disable automatic cache cleanup, has been removed in Gradle 9.0.0.
+
+This property no longer has any effect.
+To control cache cleanup behavior in Gradle 9.0.0 and later, use an <<directory_layout.adoc#dir:gradle_user_home:configure_cache_cleanup,init script>> instead.
+
+=== Removal of `buildCache.local.removeUnusedEntriesAfterDays`
+
+In Gradle 9.0.0, the property link:{javadocPath}/org/gradle/caching/local/DirectoryBuildCache.html#setRemoveUnusedEntriesAfterDays-int-[`buildCache.local.removeUnusedEntriesAfterDays`] has been removed.
+
+This property was previously used to configure the retention period for the local build cache.
+
+To configure retention for unused entries in the local build cache, use the <<directory_layout.adoc#dir:gradle_user_home:configure_cache_cleanup,Gradle User Home cache cleanup settings>> instead.
+
+=== Removal of deprecated `org.gradle.util` members
+
+The following members of the `org.gradle.util` package have been removed:
+
+* `CollectionUtils`
+
+* `ConfigureUtil`, `ClosureBackedAction`
++
+These classes used to provide utilities related to `groovy.lang.Closure`.
+Plugins should avoid relying on Groovy specifics, such as `Closure`, in their APIs. Instead, plugins should create methods that use
+link:{javadocPath}/org/gradle/api/Action.html[Action]:
++
+[source,java]
+----
+abstract class MyExtension {
+    // ...
+    public void options(Action<? extends MyOptions>  action) {
+        action.execute(options)
+    }
+}
+----
++
+Gradle automatically generates a `Closure`-taking method at runtime for each method with an `Action` as a single argument as long as the object is created with link:{javadocPath}/org/gradle/api/model/ObjectFactory.html#newInstance(java.lang.Class,java.lang.Object...)[ObjectFactory#newInstance].
++
+As a last resort, to apply some configuration represented by a Groovy Closure, a plugin can use
+link:{javadocPath}/org/gradle/api/Project.html#configure(java.lang.Object,groovy.lang.Closure)[Project#configure].
+
+=== Removal of deprecated `testSourceDirs` and `testResourceDirs` from `IdeaModule`
+
+The deprecated `testSourceDirs` and `testResourceDirs` properties have been removed from `org.gradle.plugins.ide.idea.model.IdeaModule`.
+This change does not affect the `org.gradle.tooling.model.idea.IdeaModule` type used in the Tooling API.
+Use the `testSources` and `testResources` properties instead.
+
+=== Removal of Unix mode based file permissions
+
+Gradle 9.0.0 removes legacy APIs for specifying file permissions using raw Unix mode integers.
+
+A new and more expressive API for configuring file permissions was introduced in Gradle 8.3 and promoted to stable in Gradle 8.8.
+See:
+
+- link:{javadocPath}/org/gradle/api/file/FilePermissions.html[FilePermissions].
+- link:{javadocPath}/org/gradle/api/file/ConfigurableFilePermissions.html[ConfigurableFilePermissions].
+
+The following older methods, deprecated in Gradle 8.8, have now been removed:
+
+- `org.gradle.api.file.CopyProcessingSpec.getFileMode()`
+- `org.gradle.api.file.CopyProcessingSpec.setFileMode(Integer)`
+- `org.gradle.api.file.CopyProcessingSpec.getDirMode()`
+- `org.gradle.api.file.CopyProcessingSpec.setDirMode(Integer)`
+- `org.gradle.api.file.FileTreeElement.getMode()`
+- `org.gradle.api.file.FileCopyDetails.setMode(int)`
+
+=== Removal of select Groovy modules from the Gradle distribution
+
+Gradle 9.0.0 removes certain Groovy modules from its bundled distribution.
+They will no longer be available on the classpath or be available via `localGroovy`:
+
+- `groovy-test`
+- `groovy-console`
+- `groovy-sql`
+
+=== Removal of `kotlinDslPluginOptions.jvmTarget`
+
+In Gradle 9.0.0, the `kotlinDslPluginOptions.jvmTarget` property has been removed.
+
+This property was previously used to configure the JVM target version for code compiled with the `kotlin-dsl` plugin.
+
+To set the target JVM version, you should now <<kotlin_dsl#sec:kotlin-dsl_plugin,configure a Java Toolchain>> instead.
+
+[[gradle_enterprise_extension_removed]]
+=== Removal of the `gradle-enterprise` plugin block extension in Kotlin DSL
+
+In Kotlin DSL based `settings.gradle.kts` files, you could previously use the `gradle-enterprise` plugin block extension to apply the Gradle Enterprise plugin using the same version bundled with `gradle --scan`:
+
+[source,kotlin]
+----
+plugins {
+    `gradle-enterprise`
+}
+----
+
+This shorthand had no equivalent in the Groovy DSL (`settings.gradle`) and has now been removed.
+
+Gradle Enterprise has been renamed to Develocity, and the plugin ID has changed from `com.gradle.enterprise` to `com.gradle.develocity`.
+As a result, you must now apply the plugin explicitly using its full ID and version:
+
+[source,kotlin]
+----
+plugins {
+    id("com.gradle.develocity") version "4.0.2"
+}
+----
+
+If you're still using the legacy name, you may apply the deprecated plugin ID to ease the transition:
+
+[source,kotlin]
+----
+plugins {
+    id("com.gradle.enterprise") version "3.19.2"
+}
+----
+
+We strongly encourage users to adopt the latest released version of the https://plugins.gradle.org/plugin/com.gradle.develocity[Develocity plugin], even when using it with older versions of Gradle.
+
+=== Removal of eager artifact configuration accessors in Kotlin DSL
+
+In Gradle 5.0, the type of configuration accessors changed from `Configuration` to `NamedDomainObjectProvider<Configuration>` to support lazy configuration.
+To maintain compatibility with plugins compiled against older Gradle versions, the Kotlin DSL provided eager accessor extensions such as:
+
+[source,kotlin]
+----
+configurations.compileClasspath.files // equivalent to configurations.compileClasspath.get().files
+configurations.compileClasspath.singleFile // equivalent to configurations.compileClasspath.get().singleFile
+----
+
+These eager accessors were deprecated and removed from the public API in Gradle 8.0 but remained available for plugins compiled against older Gradle versions.
+
+In Gradle 9.0.0, these legacy methods have now been fully removed.
+
+=== Removal of `libraries` and `bundles` from version catalogs in the `plugins {}` block in Kotlin DSL
+
+In Gradle 8.1, accessing `libraries` or `bundles` from dependency version catalogs within the `plugins {}` block of a Kotlin DSL script was deprecated.
+
+In Gradle 9.0.0, this support has been fully removed.
+Attempting to reference `libraries` or `bundles` in the `plugins {}` block will now result in a build failure.
+
+=== Removal of `"name"()` task reference syntax in Kotlin DSL
+
+In Gradle 9.0.0, referencing tasks or other domain objects using the `"name"()` syntax in Kotlin DSL has been removed.
+
+Instead of using `"name"()` to reference a task or domain object, use `named("name")` or one of the other supported notations.
+
+=== Removal of `outputFile` in `WriteProperties` task
+
+The `outputFile` property in the `WriteProperties` task has been removed in Gradle 9.0.0.
+
+This property was deprecated in Gradle 8.0 and was replaced with the `destinationFile` property.
+
+=== Removal of `Project#exec`, `Project#javaexec`, and script-level counterparts
+
+The following helper methods for launching external processes were <<upgrading_version_8.adoc#deprecated_project_exec,deprecated in Gradle 8.11>> and have now been removed in Gradle 9.0.0:
+
+* `org.gradle.api.Project#exec(Closure)`
+* `org.gradle.api.Project#exec(Action)`
+* `org.gradle.api.Project#javaexec(Closure)`
+* `org.gradle.api.Project#javaexec(Action)`
+* `org.gradle.api.Script#exec(Closure)`
+* `org.gradle.api.Script#exec(Action)`
+* `org.gradle.api.Script#javaexec(Closure)`
+* `org.gradle.api.Script#javaexec(Action)`
+* `org.gradle.kotlin.dsl.InitScriptApi#exec(Action)`
+* `org.gradle.kotlin.dsl.InitScriptApi#javaexec(Action)`
+* `org.gradle.kotlin.dsl.KotlinScript#exec(Action)`
+* `org.gradle.kotlin.dsl.KotlinScript#javaexec(Action)`
+* `org.gradle.kotlin.dsl.SettingsScriptApi#exec(Action)`
+* `org.gradle.kotlin.dsl.SettingsScriptApi#javaexec(Action)`
+
+=== Removal of unused public APIs
+
+The following types have been removed in Gradle 9.0.0.
+These types are not used in Gradle's public API and as such are not useful.
+
+* `org.gradle.api.artifacts.ArtifactIdentifier`
+* `org.gradle.api.publish.ivy.IvyDependency`
+* `org.gradle.api.publish.maven.MavenDependency`
diff --git a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_4.adoc b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_4.adoc
index 9d7d5ad2fd6..d4ab804bcf2 100644
--- a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_4.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_4.adoc
@@ -13,7 +13,7 @@
 // limitations under the License.
 
 [[upgrading_version_4]]
-= Upgrading your build from Gradle 4.x to 5.0
+= Upgrading from Gradle 4.x to 5.0
 
 This chapter provides the information you need to migrate your older Gradle 4.x builds to Gradle 5.0.
 In most cases, you will need to apply the changes from all versions that come after the one you're upgrading from.
diff --git a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_5.adoc b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_5.adoc
index 0323ac659a9..9eebce6bee3 100644
--- a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_5.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_5.adoc
@@ -13,10 +13,10 @@
 // limitations under the License.
 
 [[upgrading_version_5]]
-= Upgrading your build from Gradle 5.x to 6.0
+= Upgrading from Gradle 5.x to 6.0
 
 This chapter provides the information you need to migrate your Gradle 5.x builds to Gradle 6.0.
-For migrating from Gradle 4.x, complete the <<upgrading_version_4.adoc#upgrading_version_4, 4.x to 5.0 guide>> first.
+For migrating from Gradle 4.x, see the <<upgrading_version_4.adoc#upgrading_version_4, 4.x to 5.0 guide>> first.
 
 We recommend the following steps for all users:
 
@@ -32,7 +32,7 @@ Alternatively, you can run `gradle help --warning-mode=all` to see the deprecati
 Some plugins will break with this new version of Gradle, for example because they use internal APIs that have been removed or changed.
 The previous step will help you identify potential problems by issuing deprecation warnings when a plugin does try to use a deprecated part of the API.
 +
-. Run `gradle wrapper --gradle-version 6.0` to update the project to 6.0.
+. Run `gradle wrapper --gradle-version 6.0.1` to update the project to 6.0.1.
 . Try to run the project and debug any errors using the <<troubleshooting.adoc#troubleshooting, Troubleshooting Guide>>.
 
 [[changes_6.0]]
diff --git a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_6.adoc b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_6.adoc
index a6e7953b060..809ce42343b 100644
--- a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_6.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_6.adoc
@@ -13,10 +13,10 @@
 // limitations under the License.
 
 [[upgrading_version_6]]
-= Upgrading your build from Gradle 6.x to 7.0
+= Upgrading from Gradle 6.x to 7.0
 
 This chapter provides the information you need to migrate your Gradle 6.x builds to Gradle 7.0.
-For migrating from Gradle 5.x or earlier, complete the <<upgrading_version_5.adoc#upgrading_version_5, older migration guide>> first.
+For migrating from Gradle 5.x, see the <<upgrading_version_5.adoc#upgrading_version_5, older migration guide>> first.
 
 We recommend the following steps for all users:
 
@@ -32,7 +32,7 @@ Alternatively, you can run `gradle help --warning-mode=all` to see the deprecati
 Some plugins will break with this new version of Gradle, for example because they use internal APIs that have been removed or changed.
 The previous step will help you identify potential problems by issuing deprecation warnings when a plugin does try to use a deprecated part of the API.
 +
-. Run `gradle wrapper --gradle-version 7.0` to update the project to 7.0.
+. Run `gradle wrapper --gradle-version 7.0.2` to update the project to 7.0.2.
 . Try to run the project and debug any errors using the <<troubleshooting.adoc#troubleshooting, Troubleshooting Guide>>.
 
 [[changes_7.0]]
diff --git a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_7.adoc b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_7.adoc
index 9fb73b9c018..13a7f131004 100644
--- a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_7.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_7.adoc
@@ -13,10 +13,10 @@
 // limitations under the License.
 
 [[upgrading_version_7]]
-= Upgrading your build from Gradle 7.x to 8.0
+= Upgrading from Gradle 7.x to 8.0
 
 This chapter provides the information you need to migrate your Gradle 7.x builds to Gradle 8.0.
-For migrating from Gradle 6.x or earlier, complete the  <<upgrading_version_6.adoc#upgrading_version_6, older migration guide>> first.
+For migrating from Gradle 6.x, see the  <<upgrading_version_6.adoc#upgrading_version_6, older migration guide>> first.
 
 We recommend the following steps for all users:
 
@@ -32,7 +32,7 @@ Alternatively, you can run `gradle help --warning-mode=all` to see the deprecati
 Some plugins will break with this new version of Gradle, for example because they use internal APIs that have been removed or changed.
 The previous step will help you identify potential problems by issuing deprecation warnings when a plugin does try to use a deprecated part of the API.
 +
-. Run `gradle wrapper --gradle-version {gradleVersion}` to update the project to {gradleVersion}.
+. Run `gradle wrapper --gradle-version 8.0.2` to update the project to 8.0.2.
 . Try to run the project and debug any errors using the <<troubleshooting.adoc#troubleshooting, Troubleshooting Guide>>.
 
 [[changes_8.0]]
diff --git a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_8.adoc b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_8.adoc
index 3d705ed8dbc..05a302d797a 100644
--- a/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_8.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/releases/upgrading/upgrading_version_8.adoc
@@ -14,10 +14,10 @@
 
 [[upgrading_version_8]]
 
-= Upgrading your build from Gradle 8.x to 9.0
+= Upgrading within Gradle 8.x
 
-This chapter provides the information you need to migrate your Gradle 8.x builds to Gradle 9.0.
-For migrating from Gradle 4.x, 5.x, 6.x, or 7.x, see the <<upgrading_version_7.adoc#upgrading_version_7, older migration guide>> first.
+This chapter provides the information you need to migrate your Gradle 8.x builds to Gradle {gradleVersion8}.
+For migrating from Gradle 7.x, see the <<upgrading_version_7.adoc#upgrading_version_7, older migration guide>> first.
 
 We recommend the following steps for all users:
 
@@ -33,947 +33,9 @@ Alternatively, you can run `gradle help --warning-mode=all` to see the deprecati
 Some plugins will break with this new version of Gradle because they use internal APIs that have been removed or changed.
 The previous step will help you identify potential problems by issuing deprecation warnings when a plugin tries to use a deprecated part of the API.
 +
-. Run `gradle wrapper --gradle-version {gradleVersion}` to update the project to {gradleVersion}.
+. Run `gradle wrapper --gradle-version {gradleVersion8}` to update the project to {gradleVersion8}.
 . Try to run the project and debug any errors using the <<troubleshooting.adoc#troubleshooting, Troubleshooting Guide>>.
 
-[[changes_9.0]]
-== Upgrading from 8.14 and earlier
-
-=== Runtime requirements and DSL changes
-
-[[jvm-17]]
-==== Java Virtual Machine (JVM) 17 or higher is required
-
-Gradle 9 requires a Java Virtual Machine (JVM) version 17 or higher to run the Gradle Daemon.
-This is a breaking change from previous versions, which supported JVM 8 and higher.
-
-Your build can still target lower JVM versions using <<toolchains.adoc#toolchains, Toolchains>> for compilation, testing and other workers (Checkstyle, Javadoc, etc).
-
-The <<gradle_wrapper.adoc#gradle_wrapper_reference,Gradle wrapper>> and command-line launcher can run with JVM 8, but it still requires a newer JVM to start the build.
-For more, see the <<#minimum_daemon_jvm_version,Running Gradle on older JVMs>> section below.
-
-<<tooling_api.adoc#embedding,Gradle Tooling API>> and <<test_kit#test_kit, TestKit>> remain compatible with JVM 8 and higher.
-
-[[kotlin-2]]
-==== Upgrade to Kotlin 2.1.21
-
-Gradle now embeds Kotlin 2.1.21, upgrading from the previously embedded version 2.0.21.
-
-For full details and potential breaking changes, consult the link:https://github.com/JetBrains/kotlin/releases/tag/v2.1.21[Kotlin release notes].
-
-==== Kotlin DSL and plugins use the Kotlin language version 2.1
-
-The Kotlin DSL has been upgraded to the latest stable link:https://kotlinlang.org/docs/whatsnew2120.html[Kotlin 2.1.x] runtime and uses Kotlin language version 2.1 across the entire toolchain.
-This marks a shift from Gradle 8.x, which embedded link:https://kotlinlang.org/docs/whatsnew20.html[Kotlin 2.0] starting in 8.11 but continued using Kotlin language version 1.8 for compatibility.
-
-This change impacts not only Kotlin DSL scripts (`.gradle.kts`) but also build logic and plugins written in Kotlin (both classic and convention plugins).
-Users should review their code for compatibility with link:https://kotlinlang.org/docs/compatibility-guide-21.html[Kotlin 2.1], as both link:https://kotlinlang.org/docs/compatibility-guide-20.html[Kotlin 2.0] and 2.1 introduced several breaking language changes.
-
-Due to changes in how the Kotlin 2 compiler handles script compilation, you can no longer refer to the script instance using labels like `this@Build_gradle`, `this@Settings_gradle`, or `this@Init_gradle`.
-If they are used to reference the DSL script target object, then use `project`, `settings`, or `gradle` instead.
-If they are used to reference a top-level symbol that happens to have the same name as a nested symbol, then use a different name, possibly by adding an intermediary variable.
-
-This upgrade also includes several important changes for build-logic and plugin authors:
-
-* Support for Kotlin language versions 1.4 and 1.5 has been removed.
-* Kotlin language version 1.7 is now deprecated.
-
-Read the link:#jspecify[JSpecify section] below to learn about potential breaking changes in Kotlin build logic code related to nullability.
-
-[[groovy-4]]
-==== Upgrade to Groovy 4.0.27
-
-Groovy has been upgraded from version 3.0.24 to https://groovy-lang.org/changelogs/changelog-4.0.27.html[4.0.27].
-The update to Groovy 4 comes with many breaking changes, such as the removal of legacy packages, changes in the module structure, a parser rewrite, and bytecode output changes.
-For a complete overview of Groovy language changes from 3.x to 4.x, see the https://groovy-lang.org/releasenotes/groovy-4.0.html[Groovy 4.0 release notes].
-These changes may affect those who use Groovy directly or indirectly in Gradle, and in rare cases, users relying on transitive dependencies.
-
-===== `is`-prefixed `Boolean` properties no longer recognized by Groovy
-
-Groovy 4 no longer treats getters with an `is` prefix and a `Boolean` return type as properties.
-Gradle still recognizes these as properties for now, but this behavior will change in Gradle 10 to align with Groovy 4.
-See <<#groovy_boolean_properties,the deprecation notice>> for more details.
-
-===== `DELEGATE_FIRST` closures may now prefer the delegate in some cases
-
-Groovy 4 has changed the behavior of closures using the `DELEGATE_FIRST` strategy.
-Dynamic lookups for properties and methods will now prefer the delegate over the owner.
-This can result in different behavior when using closures in Gradle scripts, such as certain methods not being found
-or (e.g. with `.with { }`) some dynamic properties taking precedence over outer properties or methods.
-Generally, this should not affect Gradle scripts, as Gradle does not use `DELEGATE_FIRST` closures with dynamic properties in its API.
-
-Workarounds include using `@CompileStatic` to avoid dynamic lookups, or explicitly qualifying calls with `owner.`, `this.`, or `super.` as needed.
-
-For full clarity, in Groovy 3, the lookup order was:
-
-1. Delegate's `invokeMethod`, which chooses known methods and does no dynamic lookup.
-2. Owner's `invokeMethod`, which chooses known methods and does no dynamic lookup.
-3. Delegate's `invokeMissingMethod`, which does dynamic lookup including via properties.
-4. Owner's `invokeMissingMethod`, which does dynamic lookup including via properties.
-
-In Groovy 4, the lookup order is:
-
-1. Delegate's `invokeMethod`, which chooses known methods and does no dynamic lookup.
-2. Delegate's `invokeMissingMethod`, which does dynamic lookup including via properties.
-3. Owner's `invokeMethod`, which chooses known methods and does no dynamic lookup.
-4. Owner's `invokeMissingMethod`, which does dynamic lookup including via properties.
-
-===== Private properties and methods may be inaccessible in closures
-
-Closures defined in a parent class that reference its private properties or methods may no longer have access to them in subclasses.
-This is due to a https://issues.apache.org/jira/browse/GROOVY-11568[Groovy bug] that will not be resolved until Groovy 5.
-This applies to both buildscripts and plugins written in Groovy.
-
-As a workaround, apply `@CompileStatic` to the class to remove the dynamic lookup.
-
-This is tracked by https://github.com/gradle/gradle/issues/32476.
-
-===== Super methods may be inaccessible from Groovy 3.x code
-
-Groovy 4 changed how `super` method calls are resolved at runtime.
-As a result, code compiled with Groovy 3.x may be unable to access `super` methods,
-as the code does not contain the appropriate runtime code to locate them.
-This only applies to plugins written in Groovy 3.x, from Gradle 8.x and earlier.
-
-=== Plugin changes
-
-==== Plugins written with the Kotlin DSL require Gradle >= 8.11
-
-When building and publishing plugins using the Kotlin DSL on Gradle 9.x, those plugins will only be usable on Gradle 8.11 or newer.
-This is because Gradle 8.11 is the first release that embeds Kotlin 2.0 or higher, which is required to interpret Kotlin metadata version 2.
-
-If you want your plugin to remain compatible with older Gradle versions, you must explicitly compile it against an earlier Kotlin version (1.x).
-
-For example, to support Gradle 6.8 and newer, configure your plugin to target Kotlin 1.7 like this:
-
-.build.gradle.kts
-[source,kotlin]
-----
-import org.jetbrains.kotlin.gradle.dsl.KotlinVersion
-import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
-
-plugins {
-    `kotlin-dsl`
-}
-
-tasks.withType<KotlinCompile>().configureEach {
-    compilerOptions {
-        languageVersion = KotlinVersion.KOTLIN_1_7
-        apiVersion = KotlinVersion.KOTLIN_1_7
-    }
-}
-----
-
-Refer to Gradles link:compatibility.html#kotlin[compatibility matrix] for details on which Kotlin version is embedded in each Gradle release.
-
-NOTE: Plugins written using the Kotlin DSL and published with Gradle 7.x or 8.x remain compatible with Gradle 6.8 and newer.
-
-==== Plugins written with the Groovy DSL require Gradle >= 7.0
-
-Plugins authored using the Groovy DSL and built with Gradle 9.x require Gradle 7.0 or newer to run.
-This is because Gradle 7.0 introduced Groovy 3.0 support, and Gradle 9 embeds Groovy 4.0.
-
-Since Gradle 9 uses Groovy 4.0 internally, plugins built with it may not behave as expected when run on older Gradle versions.
-For best compatibility, such plugins should be used with Gradle 9.0.0 or later.
-
-NOTE: Plugins written with the Groovy DSL and published using Gradle 7.x or 8.x remain compatible with Gradle 5.0 and above.
-
-==== Lowest supported Kotlin Gradle Plugin version change
-
-Starting with Gradle 9, the minimum supported Kotlin Gradle Plugin version is 2.0.0.
-Earlier versions are no longer supported as they rely on Gradle APIs that have been removed.
-
-For Gradle 8.x, the minimum supported version was 1.6.10.
-
-==== Lowest supported Android Gradle Plugin version change
-
-Starting with Gradle 9, the minimum supported Android Gradle Plugin version is 8.4.0.
-Earlier versions are no longer supported as they rely on Gradle APIs that have been removed.
-
-For Gradle 8.x, the minimum supported version was 7.3.0.
-
-==== Lowest supported Gradle Enterprise Plugin version change
-
-Starting with Gradle 9, the minimum supported Gradle Enterprise Plugin version is 3.13.1.
-Earlier versions are no longer supported as they rely on Gradle APIs that have been removed.
-
-Consider upgrading to the latest version of the Gradle Enterprise Plugin,
-or better yet, upgrade to the latest version of the link:https://docs.gradle.com/develocity/gradle-plugin[Develocity Plugin].
-
-For Gradle 8.x, the minimum supported version was 3.0.
-
-==== C++ and Swift plugins no longer depend on software model based plugins
-
-<<cpp_application_plugin.adoc#cpp_application_plugin,Cpp Application Plugin>>, <<cpp_library_plugin.adoc#cpp_library_plugin,Cpp Library Plugin>>, <<swift_application_plugin.adoc#swift_application_plugin,Swift Application Plugin>>, and <<swift_library_plugin.adoc#swift_library_plugin,Swift Library Plugin>> have been updated and no longer rely on the software model plugin infrastructure.
-
-As a result, `toolChains` should now be configured directly at the top-level of your build script instead of within a `model { }` block.
-
-==== Scala plugins no longer create unresolvable configurations
-
-Previously, the Scala plugins used configurations named `incrementalScalaAnalysisFor` to resolve incremental analysis information between projects.
-However, these configurations were unresolvable and could lead to errors in the `dependencies` report.
-
-As of Gradle 9, these configurations are no longer created or used by the Scala plugins.
-
-=== Settings file changes
-
-==== Project directories must exist and be writeable
-
-Gradle will fail if a project is included that does not correspond to an existing directory on the file system, or if the directory exists but is read-only.
-
-For example, you may see an error like:
-
-[source,text]
-----
-
-* What went wrong:
-Configuring project ':subproject1' without an existing directory is not allowed. The configured projectDirectory '.../subproject1' does not exist, can't be written to or is not a directory.
-
-* Try:
-> Make sure the project directory exists and is writable.
-----
-
-See <<deprecated_missing_project_directory>> for more details.
-
-=== Task changes
-
-[[validate_plugins_without_java_toolchain_90]]
-==== `ValidatePlugins` task now requires Java Toolchains
-
-In Gradle 9, using the link:{javadocPath}/org/gradle/plugin/devel/tasks/ValidatePlugins.html[`ValidatePlugins`] task without applying the <<toolchains.adoc#toolchains,Java Toolchains>> plugin will result in an error.
-
-To fix this, explicitly apply the `jvm-toolchains` plugin:
-
-====
-[.multi-language-sample]
-=====
-.build.gradle.kts
-[source,kotlin]
-----
-plugins {
-    id("jvm-toolchains")
-}
-----
-=====
-[.multi-language-sample]
-=====
-.build.gradle
-[source,groovy]
-----
-plugins {
-    id 'jvm-toolchains'
-}
-----
-=====
-====
-
-TIP: The `jvm-toolchains` plugin is automatically applied by the <<java_library_plugin.adoc#java_library_plugin,Java Library Plugin>> and other JVM-related plugins.
-If you are already applying one of those, no further action is needed.
-
-==== `test` task fails when no tests are discovered
-
-When test sources are present and no filters are applied, the `test` task will now fail with an error if it runs but doesnt discover any tests.
-This is to help prevent misconfigurations where the tests are written for one test framework but the test task is mistakenly configured to use another test framework.
-If filters are applied, the outcome depends on the `failOnNoMatchingTests` property.
-
-This behavior can be disabled by setting the `failOnNoDiscoveredTests` property to `false` in the test task configuration:
-
-====
-[.multi-language-sample]
-=====
-.build.gradle.kts
-[source,kotlin]
-----
-tasks.withType<AbstractTestTask>().configureEach {
-    failOnNoDiscoveredTests = false
-}
-----
-=====
-[.multi-language-sample]
-=====
-.build.gradle
-[source,groovy]
-----
-tasks.withType(AbstractTestTask).configureEach {
-    failOnNoDiscoveredTests = false
-}
-----
-=====
-====
-
-==== Stale outputs outside the build directory are no longer deleted
-
-In previous versions of Gradle, class files located outside the build directory were deleted when considered stale. This was a special case for class files registered as outputs of a source set.
-
-Because this setup is uncommon and forced Gradle to eagerly realize all compile related tasks in every build, the behavior has been removed in Gradle 9.
-
-Gradle will continue to clean up stale outputs inside the build directory as needed.
-
-==== `model` and `component` tasks are no longer automatically added
-
-The `model` and `component` tasks report on the structure of legacy software model objects configured for the project.
-Previously, these tasks were automatically added to the project for every build.
-These tasks are now only added to a project when a rule-based plugin is applied (such as those provided by Gradle's support for building native software).
-
-=== Packaging and Artifact changes
-
-==== Artifact Signing now matches OpenPGP Key Version
-
-Starting with Gradle 9, the `signing` plugin produces OpenPGP signatures that match the version of the key used. This change ensures compliance with link:https://www.rfc-editor.org/rfc/rfc9580.html[RFC 9580] and introduces support for OpenPGP version 6 keys.
-Previously, Gradle always generated OpenPGP version 4 signatures, regardless of the key version.
-
-==== Ear and War plugins build all artifacts with `assemble`
-
-Prior to Gradle 9, applying multiple packaging plugins (e.g., `ear`, `war`, `java`) to the same project resulted in special behavior where only one artifact type was built during `assemble`.
-For example:
-
-- Applying the `ear` plugin would skip building `war` and `jar` artifacts.
-- Applying the `war` plugin would skip building the `jar`.
-
-This special handling has been removed in Gradle 9.
-Now, if multiple packaging plugins are applied, all corresponding artifacts will be built when running the `assemble` task.
-For example, a project applying the `ear`, `war`, and `java plugins` will now produce `.ear`, `.war`, and `.jar` files during `assemble`.
-
-==== Ear and War plugins contribute all artifacts to the `archives` configuration
-
-In previous versions of Gradle, applying multiple packaging plugins (`ear`, `war`, `java`) resulted in selective behavior for the `archives` configuration.
-For example:
-
-- Applying the `ear` plugin excluded `jar` and `war` artifacts from archives.
-- Applying the `war` plugin excluded the `jar` artifact from archives.
-
-This behavior has been removed in Gradle 9.
-Now, when multiple packaging plugins are applied, all related artifactsEAR, WAR, and JARare included in the `archives` configuration.
-
-==== Gradle no longer implicitly builds certain artifacts during `assemble`
-
-In previous versions of Gradle, the `assemble` task would implicitly build artifacts from any configuration where the `visible` flag was not set to `false`.
-This behavior has been removed in Gradle 9.
-
-If you have a custom configuration and want its artifact to be built as part of `assemble`, you now need to explicitly declare the dependency between the artifact and the `assemble` task:
-
-====
-[.multi-language-sample]
-=====
-.build.gradle.kts
-[source,kotlin]
-----
-val specialJar = tasks.register<Jar>("specialJar") {
-    from("foo")
-}
-
-val special = configurations.create("special") {
-    // In previous versions, this would have been enough to build the specialJar
-    // artifact when running assemble
-    outgoing.artifact(specialJar)
-}
-
-// In Gradle 9, you need to add a dependency from the artifact to the assemble task
-tasks.named("assemble") {
-    dependsOn(special.artifacts)
-}
-----
-=====
-[.multi-language-sample]
-=====
-.build.gradle
-[source,groovy]
-----
-def specialJar = tasks.register("specialJar". Jar) {
-    from("foo")
-}
-
-def special = configurations.create("special") {
-    // In previous versions, this would have been enough to build the specialJar
-    // artifact when running assemble
-    outgoing.artifact(specialJar)
-}
-
-// In Gradle 9, you need to add a dependency from the artifact to the assemble task
-tasks.named("assemble") {
-    dependsOn(special.artifacts)
-}
-----
-=====
-====
-
-==== Gradle no longer implicitly adds certain artifacts to the `archives` configuration
-
-In previous versions of Gradle, the `archives` configuration would automatically include artifacts from any configuration where the `visible` flag was not set to `false`.
-This implicit behavior has been removed in Gradle 9.
-
-To include a custom artifact in the `archives` configuration, you must now add it explicitly:
-
-====
-[.multi-language-sample]
-=====
-.build.gradle.kts
-[source,kotlin]
-----
-val specialJar = tasks.register<Jar>("specialJar") {
-    from("foo")
-}
-
-configurations {
-    create("special") {
-        // In previous versions, this would have been enough to add the specialJar
-        // artifact to the archives configuration
-        outgoing.artifact(specialJar)
-    }
-    // In Gradle 9, you need to explicitly add the artifact to the archives
-    // configuration
-    named("archives") {
-        outgoing.artifact(specialJar)
-    }
-}
-----
-=====
-[.multi-language-sample]
-=====
-.build.gradle
-[source,groovy]
-----
-def specialJar = tasks.register("specialJar". Jar) {
-    from("foo")
-}
-
-configurations {
-    create("special") {
-        // In previous versions, this would have been enough to add the specialJar
-        // artifact to the archives configuration
-        outgoing.artifact(specialJar)
-    }
-    // In Gradle 9, you need to explicitly add the artifact to the archives
-    // configuration
-    named("archives") {
-        outgoing.artifact(specialJar)
-    }
-}
-----
-=====
-====
-
-==== Gradle Module Metadata can no longer be modified after an eagerly created publication is created from the same component
-
-This behavior previously caused a warning: `Gradle Module Metadata is modified after an eagerly populated publication.`
-
-It will now fail with an error, suggesting a review of the relevant documentation.
-
-=== API changes
-
-[[jspecify]]
-==== Gradle API now uses JSpecify nullability annotations
-
-Gradle has supported null safety in its public API since Gradle 5.0, allowing early detection of nullability issues when writing Kotlin build scripts or plugin code in Java or Kotlin.
-
-Previously, Gradle used annotations from the now-dormant link:https://jcp.org/en/jsr/detail?id=305[JSR-305] to indicate nullability.
-While useful, JSR-305 had limitations and is no longer actively maintained.
-
-Starting with Gradle 9, the Gradle API now uses link:https://jspecify.dev/[JSpecify] annotations.
-JSpecify provides a modern, standardized set of annotations and semantics for nullability in Java APIs, improving support in IDEs and during compilation.
-
-Because JSpecify's semantics differ slightly from JSR-305, you might see new warnings or errors in your Kotlin or Java plugin code.
-These typically indicate places where you need to clarify or adjust null handling, and modern compilers and IDEs should provide helpful messages to guide you.
-
-Kotlin 2.1, when combined with JSpecify annotations in the Gradle API, introduces stricter nullability handling.
-Some formerly-valid code may now fail to compile due to more precise type checking.
-
-Common breaking changes:
-
-- Unbounded generics for types that have generic bounds will now fail to compile.
-+
-For example if you have a Kotlin extension function on `Provider<T>` whose signature is `fun <T> Provider<T>.some()` you must qualify `<T>` as  `<T : Any>` because `T` isn't nullable on `Provider<T>`.
-
-- The nullability of generic bounds is now handled strictly.
-+
-For example, you can't use `Property<String?>` anymore because the `T` in `Property<T>` is not nullable.
-+
-Another example is using a function from the Gradle API that takes a `Map<String, *>` parameter ; you could pass a map with nullable values before, you can't do that anymore.
-
-- Functions of the Gradle API that take varargs are now strict with regards to elements nullability.
-+
-For example, functions of the Gradle API that take varargs with non-nullable elements only were accepting null elements in previous Gradle versions and will now fail to compile.
-
-NOTE: Plugins that use `javax.annotation` (JSR-305) annotations will continue to work in Gradle 9 as they did before.
-
-==== Methods on public API types made final
-
-The methods link:{javadocPath}/org/gradle/api/specs/AndSpec.html#findUnsatisfiedSpec(java.lang.Object)[`AndSpec.and`] and link:{javadocPath}/org/gradle/api/reporting/GenerateBuildDashboard.html#aggregate(org.gradle.api.reporting.Reporting...)[`GenerateBuildDashboard.aggregate`] have been declared `final` to support the use of the `@SafeVarargs` annotation.
-
-These types were not intended to be subclassed.
-However, if your build logic or a plugin attempts to override these methods, it will now result in a runtime failure.
-
-==== Injection getters are now `abstract`
-
-All Gradle-provided classes that have `@Inject` annotated getters now have those getters declared as `abstract`.
-This will require all classes that extend Gradle-provided classes to be `abstract`.
-
-==== `ConfigurationVariant.getDescription` is now a `Property<String>`
-
-This method was added in Gradle 7.5 and was previously a `Optional<String>`.
-This property was not configurable by public APIs.
-
-By making the description a `Property<String>`, secondary variants have a user configurable description that appears in the <<variant_aware_resolution.adoc#outgoing_variants_report,`outgoingVariants` report>>.
-
-==== New subtypes of `ComponentIdentifier` introduced
-
-Gradle 9 introduces link:{javadocPath}/org/gradle/api/artifacts/component/RootComponentIdentifier.html)[`RootComponentIdentifier`], a new subtype of link:{javadocPath}/org/gradle/api/artifacts/component/ComponentIdentifier.html)[`ComponentIdentifier`].
-
-APIs which return instances of `ComponentIdentifier` may now return identifier instances of this new type.
-For example, the link:{javadocPath}/org/gradle/api/artifacts/result/ComponentResult.html)[`ComponentResult`], link:{javadocPath}/org/gradle/api/artifacts/result/ResolvedVariantResult.html)[`ResolvedVariantResult`], and link:{javadocPath}/org/gradle/api/artifacts/ArtifactView.ViewConfiguration.html)[`ArtifactView`] APIs, among others, are affected.
-
-In future Gradle versions, additional subtypes of `ComponentIdentifier` may be introduced.
-Build logic should remain resilient to unknown `ComponentIdentifier` subtypes returned by Gradle APIs.
-
-=== Updated versions
-
-==== Upgraded default versions of code quality tools
-
-The default version of Checkstyle is link:https://checkstyle.sourceforge.io/releasenotes.html#Release_10.24.0[10.24.0].
-
-The default version of CodeNarc is link:https://github.com/CodeNarc/CodeNarc/blob/v3.6.0/CHANGELOG.md#version-360--feb-2025[3.6.0].
-
-The default version of Pmd is link:https://github.com/pmd/pmd/releases/tag/pmd_releases%2F7.13.0[7.13.0]
-
-==== Upgraded default versions of testing frameworks
-
-When using test suites, the version of several testing frameworks has changed.
-
-The default version of JUnit Jupiter is link:https://junit.org/junit5/docs/5.12.2/release-notes/index.html#release-notes-5.12.2[5.12.2].
-
-The default version of TestNG is link:https://github.com/testng-team/testng/releases/tag/7.11.0[7.11.0].
-
-The default version of Spock is link:https://spockframework.org/spock/docs/2.3/release_notes.html[2.3].
-
-==== Upgraded version of Eclipse JGit
-
-Eclipse JGit has been updated from 5.13.3 to link:https://projects.eclipse.org/projects/technology.jgit/releases/7.2.1[7.2.1].
-
-This update reworks how Gradle configures JGit for SSH operations and introduces support for using the SSH Agent, leveraging the new capabilities available in link:https://github.com/eclipse-jgit/jgit/blob/v7.2.1.202505142326-r/org.eclipse.jgit.ssh.apache.agent/README.md[JGits] SSH agent integration.
-
-=== Removed APIs and features
-
-==== Removal of deprecated `JvmVendorSpec.IBM_SEMERU`
-
-The deprecated `JvmVendorSpec.IBM_SEMERU` constant has been removed.
-Its usage should be replaced by link:{javadocPath}/org/gradle/jvm/toolchain/JvmVendorSpec.html#IBM[`JvmVendorSpec.IBM`].
-
-==== Removal of `GroovySourceSet` and `ScalaSourceSet` interfaces
-
-The following source set interfaces have been removed in Gradle 9:
-
-- `org.gradle.api.tasks.GroovySourceSet`
-- `org.gradle.api.tasks.ScalaSourceSet`
-
-To configure Groovy or Scala sources, use the plugin-specific Source Directory Sets instead:
-
-- `groovy`: link:{javadocPath}/org/gradle/api/tasks/GroovySourceDirectorySet.html[GroovySourceDirectorySet]
-- `scala`: link:{javadocPath}/org/gradle/api/tasks/ScalaSourceDirectorySet.html[ScalaSourceDirectorySet]
-
-For example, to configure Groovy sources in a plugin:
-
-[source,java]
-----
-GroovySourceDirectorySet groovySources = sourceSet.getExtensions().getByType(GroovySourceDirectorySet.class);
-groovySources.setSrcDirs(Arrays.asList("sources/groovy"));
-----
-
-==== Removal of custom build layout options
-
-The ability to specify custom locations for key build files from the command line has been removed in Gradle 9.
-The following options, deprecated in Gradle 8.x, are no longer supported:
-
-* `-c`, `--settings-file`  Specify a custom location for the settings file
-* `-b`, `--build-file`  Specify a custom location for the build file
-
-In addition, the `buildFile` property on the link:{groovyDslPath}/org.gradle.api.tasks.GradleBuild.html[GradleBuild] task has been removed.
-This means it is no longer possible to set a custom build file path via the `GradleBuild` task.
-
-==== Removal of conventions
-
-The _"convention"_ conceptrepresented by the `org.gradle.api.plugins.Convention` typehas been deprecated since Gradle 8.2 and is now fully removed in Gradle 9.
-
-Core Gradle plugins that previously registered deprecated conventions have been updated accordingly.
-
-This implies removal of the Conventions API. These have been removed:
-
-- `org.gradle.api.Task.getConvention()`
-- `org.gradle.api.Project.getConvention()`
-- `org.gradle.api.plugins.Convention`
-- `org.gradle.api.internal.HasConvention`
-
-Existing plugins that use these APIs will fail with Gradle 9.0.0+ and should be updated to use the Extensions API instead.
-
-The table below shows which conventions have been removed and how to migrate:
-
-[cols="1,1,1,5"]
-|===
-|Plugin |Access |Type |Solution
-
-|`war` |`project.war` | `WarPluginConvention` | Configure the `war` task directly instead.
-|`base` | `project.distDirName`, `project.libsDirName`, `project.archivesBaseName` | `BasePluginConvention` | Replaced by `project.base` extension of type `BasePluginExtension`.
-| `project-report` | `project.projectReports` | `ProjectReportPluginConvention` | Configure the report task (`TaskReportTask`, `PropertyReportTask`, `DependencyReportTask`, `HtmlDependencyReportTask`) directly.
-|`ear` |`project.ear` | `EarPluginConvention` | Configure the `ear` task directly instead.
-|===
-
-==== Removal of `org.gradle.cache.cleanup`
-
-The `org.gradle.cache.cleanup` property, which previously allowed users to disable automatic cache cleanup, has been removed in Gradle 9.
-
-This property no longer has any effect.
-To control cache cleanup behavior in Gradle 9.0.0 and later, use an <<directory_layout.adoc#dir:gradle_user_home:configure_cache_cleanup,init script>> instead.
-
-==== Removal of `buildCache.local.removeUnusedEntriesAfterDays`
-
-In Gradle 9, the property link:{javadocPath}/org/gradle/caching/local/DirectoryBuildCache.html#setRemoveUnusedEntriesAfterDays-int-[`buildCache.local.removeUnusedEntriesAfterDays`] has been removed.
-
-This property was previously used to configure the retention period for the local build cache.
-
-To configure retention for unused entries in the local build cache, use the <<directory_layout.adoc#dir:gradle_user_home:configure_cache_cleanup,Gradle User Home cache cleanup settings>> instead.
-
-==== Removal of deprecated `org.gradle.util` members
-
-The following members of the `org.gradle.util` package have been removed:
-
-* `CollectionUtils`
-
-* `ConfigureUtil`, `ClosureBackedAction`
-+
-These classes used to provide utilities related to `groovy.lang.Closure`.
-Plugins should avoid relying on Groovy specifics, such as `Closure`, in their APIs. Instead, plugins should create methods that use
-link:{javadocPath}/org/gradle/api/Action.html[Action]:
-+
-[source,java]
-----
-abstract class MyExtension {
-    // ...
-    public void options(Action<? extends MyOptions>  action) {
-        action.execute(options)
-    }
-}
-----
-+
-Gradle automatically generates a `Closure`-taking method at runtime for each method with an `Action` as a single argument as long as the object is created with link:{javadocPath}/org/gradle/api/model/ObjectFactory.html#newInstance(java.lang.Class,java.lang.Object...)[ObjectFactory#newInstance].
-+
-As a last resort, to apply some configuration represented by a Groovy Closure, a plugin can use
-link:{javadocPath}/org/gradle/api/Project.html#configure(java.lang.Object,groovy.lang.Closure)[Project#configure].
-
-==== Removal of deprecated `testSourceDirs` and `testResourceDirs` from `IdeaModule`
-
-The deprecated `testSourceDirs` and `testResourceDirs` properties have been removed from `org.gradle.plugins.ide.idea.model.IdeaModule`.
-This change does not affect the `org.gradle.tooling.model.idea.IdeaModule` type used in the Tooling API.
-Use the `testSources` and `testResources` properties instead.
-
-==== Removal of Unix mode based file permissions
-
-Gradle 9 removes legacy APIs for specifying file permissions using raw Unix mode integers.
-
-A new and more expressive API for configuring file permissions was introduced in Gradle 8.3 and promoted to stable in Gradle 8.8.
-See:
-
-- link:{javadocPath}/org/gradle/api/file/FilePermissions.html[FilePermissions].
-- link:{javadocPath}/org/gradle/api/file/ConfigurableFilePermissions.html[ConfigurableFilePermissions].
-
-The following older methods, deprecated in Gradle 8.8, have now been removed:
-
-- `org.gradle.api.file.CopyProcessingSpec.getFileMode()`
-- `org.gradle.api.file.CopyProcessingSpec.setFileMode(Integer)`
-- `org.gradle.api.file.CopyProcessingSpec.getDirMode()`
-- `org.gradle.api.file.CopyProcessingSpec.setDirMode(Integer)`
-- `org.gradle.api.file.FileTreeElement.getMode()`
-- `org.gradle.api.file.FileCopyDetails.setMode(int)`
-
-==== Removal of select Groovy modules from the Gradle distribution
-
-Gradle 9 removes certain Groovy modules from its bundled distribution.
-They will no longer be available on the classpath or be available via `localGroovy`:
-
-- `groovy-test`
-- `groovy-console`
-- `groovy-sql`
-
-==== Removal of `kotlinDslPluginOptions.jvmTarget`
-
-In Gradle 9, the `kotlinDslPluginOptions.jvmTarget` property has been removed.
-
-This property was previously used to configure the JVM target version for code compiled with the `kotlin-dsl` plugin.
-
-To set the target JVM version, you should now <<kotlin_dsl#sec:kotlin-dsl_plugin,configure a Java Toolchain>> instead.
-
-[[gradle_enterprise_extension_removed]]
-==== Removal of the `gradle-enterprise` plugin block extension in Kotlin DSL
-
-In Kotlin DSL based `settings.gradle.kts` files, you could previously use the `gradle-enterprise` plugin block extension to apply the Gradle Enterprise plugin using the same version bundled with `gradle --scan`:
-
-[source,kotlin]
-----
-plugins {
-    `gradle-enterprise`
-}
-----
-
-This shorthand had no equivalent in the Groovy DSL (`settings.gradle`) and has now been removed.
-
-Gradle Enterprise has been renamed to Develocity, and the plugin ID has changed from `com.gradle.enterprise` to `com.gradle.develocity`.
-As a result, you must now apply the plugin explicitly using its full ID and version:
-
-[source,kotlin]
-----
-plugins {
-    id("com.gradle.develocity") version "4.0.2"
-}
-----
-
-If you're still using the legacy name, you may apply the deprecated plugin ID to ease the transition:
-
-[source,kotlin]
-----
-plugins {
-    id("com.gradle.enterprise") version "3.19.2"
-}
-----
-
-We strongly encourage users to adopt the latest released version of the https://plugins.gradle.org/plugin/com.gradle.develocity[Develocity plugin], even when using it with older versions of Gradle.
-
-==== Removal of eager artifact configuration accessors in Kotlin DSL
-
-In Gradle 5.0, the type of configuration accessors changed from `Configuration` to `NamedDomainObjectProvider<Configuration>` to support lazy configuration.
-To maintain compatibility with plugins compiled against older Gradle versions, the Kotlin DSL provided eager accessor extensions such as:
-
-[source,kotlin]
-----
-configurations.compileClasspath.files // equivalent to configurations.compileClasspath.get().files
-configurations.compileClasspath.singleFile // equivalent to configurations.compileClasspath.get().singleFile
-----
-
-These eager accessors were deprecated and removed from the public API in Gradle 8.0 but remained available for plugins compiled against older Gradle versions.
-
-In Gradle 9, these legacy methods have now been fully removed.
-
-==== Removal of `libraries` and `bundles` from version catalogs in the `plugins {}` block in Kotlin DSL
-
-In Gradle 8.1, accessing `libraries` or `bundles` from dependency version catalogs within the `plugins {}` block of a Kotlin DSL script was deprecated.
-
-In Gradle 9, this support has been fully removed.
-Attempting to reference `libraries` or `bundles` in the `plugins {}` block will now result in a build failure.
-
-==== Removal of `"name"()` task reference syntax in Kotlin DSL
-
-In Gradle 9, referencing tasks or other domain objects using the `"name"()` syntax in Kotlin DSL has been removed.
-
-Instead of using `"name"()` to reference a task or domain object, use `named("name")` or one of the other supported notations.
-
-==== Removal of `outputFile` in `WriteProperties` task
-
-The `outputFile` property in the `WriteProperties` task has been removed in Gradle 9.
-
-This property was deprecated in Gradle 8.0 and was replaced with the `destinationFile` property.
-
-==== Removal of `Project#exec`, `Project#javaexec`, and script-level counterparts
-
-The following helper methods for launching external processes were <<#deprecated_project_exec,deprecated in Gradle 8.11>> and have now been removed in Gradle 9:
-
-* `org.gradle.api.Project#exec(Closure)`
-* `org.gradle.api.Project#exec(Action)`
-* `org.gradle.api.Project#javaexec(Closure)`
-* `org.gradle.api.Project#javaexec(Action)`
-* `org.gradle.api.Script#exec(Closure)`
-* `org.gradle.api.Script#exec(Action)`
-* `org.gradle.api.Script#javaexec(Closure)`
-* `org.gradle.api.Script#javaexec(Action)`
-* `org.gradle.kotlin.dsl.InitScriptApi#exec(Action)`
-* `org.gradle.kotlin.dsl.InitScriptApi#javaexec(Action)`
-* `org.gradle.kotlin.dsl.KotlinScript#exec(Action)`
-* `org.gradle.kotlin.dsl.KotlinScript#javaexec(Action)`
-* `org.gradle.kotlin.dsl.SettingsScriptApi#exec(Action)`
-* `org.gradle.kotlin.dsl.SettingsScriptApi#javaexec(Action)`
-
-==== Removal of unused public APIs
-
-The following types have been removed in Gradle 9.0.
-These types are not used in Gradle's public API and as such are not useful.
-
-* `org.gradle.api.artifacts.ArtifactIdentifier`
-* `org.gradle.api.publish.ivy.IvyDependency`
-* `org.gradle.api.publish.maven.MavenDependency`
-
-=== Packaging and Artifact Behavior changes
-
-==== Artifact Signing now matches OpenPGP Key Version
-
-Starting with Gradle 9.0, the `signing` plugin produces OpenPGP signatures that match the version of the key used. This change ensures compliance with link:https://www.rfc-editor.org/rfc/rfc9580.html[RFC 9580] and introduces support for OpenPGP version 6 keys.
-Previously, Gradle always generated OpenPGP version 4 signatures, regardless of the key version.
-
-==== Ear and War plugins build all artifacts with `assemble`
-
-Prior to Gradle 9.0, applying multiple packaging plugins (e.g., `ear`, `war`, `java`) to the same project resulted in special behavior where only one artifact type was built during `assemble`.
-For example:
-
-- Applying the `ear` plugin would skip building `war` and `jar` artifacts.
-- Applying the `war` plugin would skip building the `jar`.
-
-This special handling has been removed in Gradle 9.0.
-Now, if multiple packaging plugins are applied, all corresponding artifacts will be built when running the `assemble` task.
-For example, a project applying the `ear`, `war`, and `java plugins` will now produce `.ear`, `.war`, and `.jar` files during `assemble`.
-
-==== Ear and War plugins contribute all artifacts to the `archives` configuration
-
-In previous versions of Gradle, applying multiple packaging plugins (`ear`, `war`, `java`) resulted in selective behavior for the `archives` configuration.
-For example:
-
-- Applying the `ear` plugin excluded `jar` and `war` artifacts from archives.
-- Applying the `war` plugin excluded the `jar` artifact from archives.
-
-This behavior has been removed in Gradle 9.0.
-Now, when multiple packaging plugins are applied, all related artifactsEAR, WAR, and JARare included in the `archives` configuration.
-
-==== Gradle no longer implicitly builds certain artifacts during `assemble`
-
-In previous versions of Gradle, the `assemble` task would implicitly build artifacts from any configuration where the `visible` flag was not set to `false`.
-This behavior has been removed in Gradle 9.0.
-
-If you have a custom configuration and want its artifact to be built as part of `assemble`, you now need to explicitly declare the dependency between the artifact and the `assemble` task:
-
-====
-[.multi-language-sample]
-=====
-.build.gradle.kts
-[source,kotlin]
-----
-val specialJar = tasks.register<Jar>("specialJar") {
-    from("foo")
-}
-
-val special = configurations.create("special") {
-    // In previous versions, this would have been enough to build the specialJar
-    // artifact when running assemble
-    outgoing.artifact(specialJar)
-}
-
-// In Gradle 9.0, you need to add a dependency from the artifact to the assemble task
-tasks.named("assemble") {
-    dependsOn(special.artifacts)
-}
-----
-=====
-[.multi-language-sample]
-=====
-.build.gradle
-[source,groovy]
-----
-def specialJar = tasks.register("specialJar". Jar) {
-    from("foo")
-}
-
-def special = configurations.create("special") {
-    // In previous versions, this would have been enough to build the specialJar
-    // artifact when running assemble
-    outgoing.artifact(specialJar)
-}
-
-// In Gradle 9.0, you need to add a dependency from the artifact to the assemble task
-tasks.named("assemble") {
-    dependsOn(special.artifacts)
-}
-----
-=====
-====
-
-==== Gradle no longer implicitly adds certain artifacts to the `archives` configuration
-
-In previous versions of Gradle, the `archives` configuration would automatically include artifacts from any configuration where the `visible` flag was not set to `false`.
-This implicit behavior has been removed in Gradle 9.0.
-
-To include a custom artifact in the `archives` configuration, you must now add it explicitly:
-
-====
-[.multi-language-sample]
-=====
-.build.gradle.kts
-[source,kotlin]
-----
-val specialJar = tasks.register<Jar>("specialJar") {
-    from("foo")
-}
-
-configurations {
-    create("special") {
-        // In previous versions, this would have been enough to add the specialJar
-        // artifact to the archives configuration
-        outgoing.artifact(specialJar)
-    }
-    // In Gradle 9.0, you need to explicitly add the artifact to the archives
-    // configuration
-    named("archives") {
-        outgoing.artifact(specialJar)
-    }
-}
-----
-=====
-[.multi-language-sample]
-=====
-.build.gradle
-[source,groovy]
-----
-def specialJar = tasks.register("specialJar". Jar) {
-    from("foo")
-}
-
-configurations {
-    create("special") {
-        // In previous versions, this would have been enough to add the specialJar
-        // artifact to the archives configuration
-        outgoing.artifact(specialJar)
-    }
-    // In Gradle 9.0, you need to explicitly add the artifact to the archives
-    // configuration
-    named("archives") {
-        outgoing.artifact(specialJar)
-    }
-}
-----
-=====
-====
-
-==== Gradle Module Metadata can no longer be modified after an eagerly created publication is created from the same component
-
-This behavior previously caused a warning: `Gradle Module Metadata is modified after an eagerly populated publication.`
-
-It will now fail with an error, suggesting a review of the relevant documentation.
-
-=== Configuration Cache changes
-
-==== Unsupported build event listeners are now configuration cache problems
-
-The build event listener registration method link:{javadocPath}/org/gradle/build/event/BuildEventsListenerRegistry.html#onTaskCompletion(org.gradle.api.provider.Provider)[`BuildEventsListenerRegistry.onTaskCompletion`]
-accepts arbitrary providers of any link:{javadocPath}/org/gradle/tooling/events/OperationCompletionListener.html[`OperationCompletionListener`] implementations.
-However, only providers returned from link:{javadocPath}/org/gradle/api/services/BuildServiceRegistry.html#registerIfAbsent(java.lang.String,java.lang.Class,org.gradle.api.Action)[`BuildServiceRegistry.registerIfAbsent`]
-or link:{javadocPath}/org/gradle/api/services/BuildServiceRegistration.html#getService()[`BuildServiceRegistration.getService`] are currently supported when the Configuration Cache is enabled.
-
-Previously, unsupported providers were silently discarded and never received events when the configuration cache was used.
-Starting with Gradle 9, registering such providers now causes a configuration cache problem and fails the build.
-
-If your build was previously working with the configuration cache (e.g., the listeners were nonessential), you can temporarily revert to the old behavior by setting:
-
-[source,properties]
-----
-org.gradle.configuration-cache.unsafe.ignore.unsupported-build-events-listeners=true
-----
-
-This property will be removed in Gradle 10.
-
-==== Configuration Cache entry is now always discarded for incompatible tasks in warning mode
-
-Configuration Cache enables gradual migration by allowing to explicitly mark tasks as <<configuration_cache_debugging.adoc#config_cache:task_opt_out,incompatible>>.
-When incompatible tasks are scheduled for execution, cache entry is not stored and tasks do not run in parallel to ensure correctness.
-Configuration Cache can also run in the <<configuration_cache_enabling.adoc#config_cache:usage:ignore_problems,warning mode>> by enabling `org.gradle.configuration-cache.problems=warn`,
-which hides problems and allows storing and loading of the cache entry, running tasks in parallel with potential issues.
-The warning mode exists as a migration and troubleshooting aid and is not intended as a persistent way of ignoring incompatibilities.
-
-Starting with Gradle 9, the presence of incompatible tasks in the work graph results in the cache entry being discarded regardless of the warning mode to ensure correctness.
-If you relied on the warning mode previously, consider marking the offending tasks as incompatible instead.
-However, at this stage of Configuration Cache maturity and ecosystem adoption, we recommend resolving the incompatibilities instead to ensure performance benefits this feature brings.
-
 [[changes_8.14]]
 == Upgrading from 8.13 and earlier
 
diff --git a/platforms/documentation/docs/src/docs/userguide/running-builds/features/command_line_interface.adoc b/platforms/documentation/docs/src/docs/userguide/running-builds/features/command_line_interface.adoc
index 07c00af12c5..04ab0e00895 100644
--- a/platforms/documentation/docs/src/docs/userguide/running-builds/features/command_line_interface.adoc
+++ b/platforms/documentation/docs/src/docs/userguide/running-builds/features/command_line_interface.adoc
@@ -14,7 +14,7 @@
 
 [[command_line_interface_reference]]
 = Command-Line Interface Reference
-:keywords: cli, clean, check, projects, tasks, rerun-tasks, continue, build-cache, no-build-cache, configuration-cache, no-configuration-cache, configuration-cache-problems, configure-on-demand, no-configure-on-demand, max-workers, parallel, no-parallel, priority, profile, scan, watch-fs, no-watch-fs, help, version, show-version, full-stacktrace, stacktrace, org.gradle.debug, org.gradle.debug.host, org.gradle.debug.port, org.gradle.debug.server, org.gradle.debug.suspend, org.gradle.daemon.debug, project-cache-dir, system-prop, init-script, project-prop, org.gradle.jvmargs, org.gradle.java.home, gradle-user-home, dependency-verification, write-verification-metadata, refresh-keys, export-keys, include-build, offline, refresh-dependencies, dry-run, continuous, write-locks, update-locks , no-rebuild, org.gradle.warning.mode, warning-mode, no-problems-report, problems-report, org.gradle.console, console, org.gradle.logging.level, quiet, warn, info, debug, daemon, no-daemon, foreground, status, stop, org.gradle.daemon.idletimeout, exclude-task, distribution-type, gradle-distribution-url, gradle-distribution-sha256-sum, gradle-version
+:keywords: cli, clean, check, projects, tasks, rerun-tasks, continue, build-cache, no-build-cache, configuration-cache, no-configuration-cache, configuration-cache-problems, configure-on-demand, no-configure-on-demand, max-workers, parallel, no-parallel, priority, profile, scan, watch-fs, no-watch-fs, help, version, show-version, full-stacktrace, stacktrace, org.gradle.debug, org.gradle.debug.host, org.gradle.debug.port, org.gradle.debug.server, org.gradle.debug.suspend, project-cache-dir, system-prop, init-script, project-prop, org.gradle.jvmargs, org.gradle.java.home, gradle-user-home, dependency-verification, write-verification-metadata, refresh-keys, export-keys, include-build, offline, refresh-dependencies, dry-run, continuous, write-locks, update-locks , no-rebuild, org.gradle.warning.mode, warning-mode, no-problems-report, problems-report, org.gradle.console, console, org.gradle.logging.level, quiet, warn, info, debug, daemon, no-daemon, foreground, status, stop, org.gradle.daemon.idletimeout, exclude-task, distribution-type, gradle-distribution-url, gradle-distribution-sha256-sum, gradle-version
 
 The command-line interface is the **primary method of interacting with Gradle**.
 
@@ -573,9 +573,6 @@ A <<build_environment.adoc#sec:gradle_configuration_properties,Gradle property>>
 `-Dorg.gradle.debug.suspend=(true,false)`::
 A <<build_environment.adoc#sec:gradle_configuration_properties,Gradle property>> that if set to `true` and debugging is enabled, the JVM running Gradle will suspend until a debugger is attached. _Default is `true`._
 
-`-Dorg.gradle.daemon.debug=true`::
-A <<build_environment.adoc#sec:gradle_configuration_properties,Gradle property>> that debugs the <<gradle_daemon.adoc#gradle_daemon, Gradle Daemon>> process. (duplicate of `-Dorg.gradle.debug`)
-
 [[sec:command_line_performance]]
 == Performance options
 
diff --git a/platforms/documentation/docs/src/main/resources/header.html b/platforms/documentation/docs/src/main/resources/header.html
index be05aff07b7..42e6777540c 100644
--- a/platforms/documentation/docs/src/main/resources/header.html
+++ b/platforms/documentation/docs/src/main/resources/header.html
@@ -144,12 +144,13 @@ <h3 id="what-is-new">Releases</h3>
                 <li><a href="../userguide/installation.html">Installing Gradle</a></li>
                 <li><a class="nav-dropdown" data-toggle="collapse" href="#upgrading-gradle" aria-expanded="false" aria-controls="upgrading-gradle">Upgrading Gradle</a>
                     <ul id="upgrading-gradle">
-                        <li><a href="../userguide/upgrading_version_9.html">version 9.X to latest</a></li>
-                        <li><a href="../userguide/upgrading_version_8.html">version 8.X to 9.0</a></li>
-                        <li><a href="../userguide/upgrading_version_7.html">version 7.X to 8.0</a></li>
-                        <li><a href="../userguide/upgrading_version_6.html">version 6.X to 7.0</a></li>
-                        <li><a href="../userguide/upgrading_version_5.html">version 5.X to 6.0</a></li>
-                        <li><a href="../userguide/upgrading_version_4.html">version 4.X to 5.0</a></li>
+                        <li><a href="../userguide/upgrading_version_9.html">Within versions 9.x.y</a></li>
+                        <li><a href="../userguide/upgrading_major_version_9.html">To version 9.0.0</a></li>
+                        <li><a href="../userguide/upgrading_version_8.html">Within versions 8.x</a></li>
+                        <li><a href="../userguide/upgrading_version_7.html">From version 7.x to 8.0</a></li>
+                        <li><a href="../userguide/upgrading_version_6.html">From version 6.x to 7.0</a></li>
+                        <li><a href="../userguide/upgrading_version_5.html">From version 5.x to 6.0</a></li>
+                        <li><a href="../userguide/upgrading_version_4.html">From version 4.x to 5.0</a></li>
                     </ul>
                 </li>
                 <li><a class="nav-dropdown" data-toggle="collapse" href="#migrating-to-gradle" aria-expanded="false" aria-controls="migrating-to-gradle">Migrating to Gradle</a>
diff --git a/platforms/documentation/docs/src/samples/build-organization/structuring-software-projects/groovy/platforms/plugins-platform/build.gradle b/platforms/documentation/docs/src/samples/build-organization/structuring-software-projects/groovy/platforms/plugins-platform/build.gradle
index de03f1612d9..8e042e56d23 100644
--- a/platforms/documentation/docs/src/samples/build-organization/structuring-software-projects/groovy/platforms/plugins-platform/build.gradle
+++ b/platforms/documentation/docs/src/samples/build-organization/structuring-software-projects/groovy/platforms/plugins-platform/build.gradle
@@ -7,8 +7,8 @@ group = 'com.example.platform'
 dependencies {
     constraints {
         api('com.android.tools.build:gradle:8.9.0')
-        api('org.jetbrains.kotlin.android:org.jetbrains.kotlin.android.gradle.plugin:2.1.21')
-        api('org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:2.1.21')
+        api('org.jetbrains.kotlin.android:org.jetbrains.kotlin.android.gradle.plugin:2.2.0')
+        api('org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:2.2.0')
         api('org.springframework.boot:org.springframework.boot.gradle.plugin:3.4.3')
     }
 }
diff --git a/platforms/documentation/docs/src/samples/build-organization/structuring-software-projects/kotlin/platforms/plugins-platform/build.gradle.kts b/platforms/documentation/docs/src/samples/build-organization/structuring-software-projects/kotlin/platforms/plugins-platform/build.gradle.kts
index 957bbe8530c..7d28f411184 100644
--- a/platforms/documentation/docs/src/samples/build-organization/structuring-software-projects/kotlin/platforms/plugins-platform/build.gradle.kts
+++ b/platforms/documentation/docs/src/samples/build-organization/structuring-software-projects/kotlin/platforms/plugins-platform/build.gradle.kts
@@ -7,8 +7,8 @@ group = "com.example.platform"
 dependencies {
     constraints {
         api("com.android.tools.build:gradle:8.9.0")
-        api("org.jetbrains.kotlin.android:org.jetbrains.kotlin.android.gradle.plugin:2.1.21")
-        api("org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:2.1.21")
+        api("org.jetbrains.kotlin.android:org.jetbrains.kotlin.android.gradle.plugin:2.2.0")
+        api("org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:2.2.0")
         api("org.springframework.boot:org.springframework.boot.gradle.plugin:3.4.3")
     }
 }
diff --git a/platforms/documentation/docs/src/snippets/buildCache/caching-android-projects/groovy/build.gradle b/platforms/documentation/docs/src/snippets/buildCache/caching-android-projects/groovy/build.gradle
index c91cd7e542c..1b4f055192e 100644
--- a/platforms/documentation/docs/src/snippets/buildCache/caching-android-projects/groovy/build.gradle
+++ b/platforms/documentation/docs/src/snippets/buildCache/caching-android-projects/groovy/build.gradle
@@ -1,6 +1,6 @@
 plugins {
-    id("org.jetbrains.kotlin.jvm") version "2.1.21"
-    id("org.jetbrains.kotlin.kapt") version "2.1.21"
+    id("org.jetbrains.kotlin.jvm") version "2.2.0"
+    id("org.jetbrains.kotlin.kapt") version "2.2.0"
 }
 
 // tag::cacheKapt[]
diff --git a/platforms/documentation/docs/src/snippets/buildCache/caching-android-projects/kotlin/build.gradle.kts b/platforms/documentation/docs/src/snippets/buildCache/caching-android-projects/kotlin/build.gradle.kts
index daa784d7976..d3d25f77a45 100644
--- a/platforms/documentation/docs/src/snippets/buildCache/caching-android-projects/kotlin/build.gradle.kts
+++ b/platforms/documentation/docs/src/snippets/buildCache/caching-android-projects/kotlin/build.gradle.kts
@@ -1,8 +1,8 @@
 import org.jetbrains.kotlin.gradle.plugin.KaptExtension
 
 plugins {
-    kotlin("jvm") version "2.1.21"
-    kotlin("kapt") version "2.1.21"
+    kotlin("jvm") version "2.2.0"
+    kotlin("kapt") version "2.2.0"
 }
 
 repositories {
diff --git a/platforms/documentation/docs/src/snippets/how-to/share-outputs/groovy/consumer/build.gradle b/platforms/documentation/docs/src/snippets/how-to/share-outputs/groovy/consumer/build.gradle
index f6676964e6d..59969487286 100644
--- a/platforms/documentation/docs/src/snippets/how-to/share-outputs/groovy/consumer/build.gradle
+++ b/platforms/documentation/docs/src/snippets/how-to/share-outputs/groovy/consumer/build.gradle
@@ -3,26 +3,31 @@ plugins {
     id("application")
 }
 
-configurations {
-    create("instrumentedRuntime") {
-        canBeConsumed = false
-        canBeResolved = true
-        attributes {
-            attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME))
-            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements, "instrumented-jar"))
-        }
+// This configuration is used to declare dependencies only.
+def instrumentedRuntimeDependencies = configurations.dependencyScope("instrumentedRuntimeDependencies")
+
+// This resolvable configuration is used to resolve the instrumented JAR files.
+def instrumentedRuntime = configurations.resolvable("instrumentedRuntime") {
+    // Wire the dependency declarations
+    extendsFrom(instrumentedRuntimeDependencies.get())
+
+    // These attributes must be compatible with the producer
+    attributes {
+        attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements, "instrumented-jar"))
     }
 }
 // end::custom-config[]
 
 // tag::dependency[]
 dependencies {
-    add("instrumentedRuntime", project(":producer"))
+    // Declare a project dependency on the producer's instrumented output
+    add("instrumentedRuntimeDependencies", project(":producer"))
 }
 // end::dependency[]
 
 // tag::task[]
 tasks.register("runWithInstrumentation",JavaExec) {
+    // Use the resolved instrumented classpath
     classpath = configurations["instrumentedRuntime"]
     mainClass.set("com.example.Main")
 }
diff --git a/platforms/documentation/docs/src/snippets/how-to/share-outputs/groovy/producer/build.gradle b/platforms/documentation/docs/src/snippets/how-to/share-outputs/groovy/producer/build.gradle
index 1e14fb40e94..dd6bccc9132 100644
--- a/platforms/documentation/docs/src/snippets/how-to/share-outputs/groovy/producer/build.gradle
+++ b/platforms/documentation/docs/src/snippets/how-to/share-outputs/groovy/producer/build.gradle
@@ -1,8 +1,12 @@
-// tag::instrumentedjar-task[]
+// tag::java-lib[]
 plugins {
     id("java-library")
 }
+// end::java-lib[]
 
+// tag::instrumentedjar-task[]
+// Register a custom JAR task that packages the output of the 'main' source set.
+// This JAR will have a classifier of 'instrumented' to distinguish it from the default artifact.
 def instrumentedJar = tasks.register("instrumentedJar", Jar) {
     archiveClassifier.set("instrumented")
     from(sourceSets.main.output)
@@ -12,17 +16,18 @@ def instrumentedJar = tasks.register("instrumentedJar", Jar) {
 
 // tag::custom-config[]
 configurations {
-    create("instrumentedJars") {
-        canBeConsumed = true
-        canBeResolved = false
+    // Create a custom consumable configuration named 'instrumentedJars'
+    // This allows the producer to supply the instrumented JAR variant to other projects
+    consumable("instrumentedJars") {
+        // Assign attributes so that consuming projects can match on these
         attributes {
-            attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.LIBRARY))
-            attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME))
+            // The unique attribute allows targeted selection
             attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements, "instrumented-jar"))
         }
     }
 }
 
+// Add the custom JAR artifact to the 'instrumentedJars' configuration
 artifacts {
     add("instrumentedJars", instrumentedJar)
 }
diff --git a/platforms/documentation/docs/src/snippets/how-to/share-outputs/kotlin/consumer/build.gradle.kts b/platforms/documentation/docs/src/snippets/how-to/share-outputs/kotlin/consumer/build.gradle.kts
index f6b05027d38..0e48347bfda 100644
--- a/platforms/documentation/docs/src/snippets/how-to/share-outputs/kotlin/consumer/build.gradle.kts
+++ b/platforms/documentation/docs/src/snippets/how-to/share-outputs/kotlin/consumer/build.gradle.kts
@@ -3,27 +3,34 @@ plugins {
     id("application")
 }
 
-configurations {
-    create("instrumentedRuntime") {
-        isCanBeConsumed = false
-        isCanBeResolved = true
-        attributes {
-            attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_RUNTIME))
-            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named("instrumented-jar"))
-        }
+// This configuration is used to declare dependencies only.
+// It is neither resolvable nor consumable.
+val instrumentedRuntimeDependencies by configurations.dependencyScope("instrumentedRuntimeDependencies")
+
+// This resolvable configuration is used to resolve the instrumented JAR files.
+// It extends from the dependency-declaring configuration above.
+val instrumentedRuntime by configurations.resolvable("instrumentedRuntime") {
+    // Wire the dependency declarations
+    extendsFrom(instrumentedRuntimeDependencies)
+
+    // These attributes must be compatible with the producer
+    attributes {
+        attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named("instrumented-jar"))
     }
 }
 // end::custom-config[]
 
 // tag::dependency[]
 dependencies {
-    add("instrumentedRuntime", project(":producer"))
+    // Declare a project dependency on the producer's instrumented output
+    instrumentedRuntimeDependencies(project(":producer"))
 }
 // end::dependency[]
 
 // tag::task[]
 tasks.register<JavaExec>("runWithInstrumentation") {
-    classpath = configurations["instrumentedRuntime"]
+    // Use the resolved instrumented classpath
+    classpath = instrumentedRuntime
     mainClass.set("com.example.Main")
 }
 // end::task[]
diff --git a/platforms/documentation/docs/src/snippets/how-to/share-outputs/kotlin/producer/build.gradle.kts b/platforms/documentation/docs/src/snippets/how-to/share-outputs/kotlin/producer/build.gradle.kts
index 4c2e3c8072b..194b121680d 100644
--- a/platforms/documentation/docs/src/snippets/how-to/share-outputs/kotlin/producer/build.gradle.kts
+++ b/platforms/documentation/docs/src/snippets/how-to/share-outputs/kotlin/producer/build.gradle.kts
@@ -1,8 +1,12 @@
-// tag::instrumentedjar-task[]
+// tag::java-lib[]
 plugins {
     id("java-library")
 }
+// end::java-lib[]
 
+// tag::instrumentedjar-task[]
+// Register a custom JAR task that packages the output of the 'main' source set.
+// This JAR will have a classifier of 'instrumented' to distinguish it from the default artifact.
 val instrumentedJar by tasks.registering(Jar::class) {
     archiveClassifier.set("instrumented")
     from(sourceSets.main.get().output)
@@ -12,17 +16,18 @@ val instrumentedJar by tasks.registering(Jar::class) {
 
 // tag::custom-config[]
 configurations {
-    create("instrumentedJars") {
-        isCanBeConsumed = true
-        isCanBeResolved = false
+    // Create a custom consumable configuration named 'instrumentedJars'
+    // This allows the producer to supply the instrumented JAR variant to other projects
+    consumable("instrumentedJars") {
+        // Assign attributes so that consuming projects can match on these
         attributes {
-            attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category.LIBRARY))
-            attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_RUNTIME))
+            // The unique attribute allows targeted selection
             attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named("instrumented-jar"))
         }
     }
 }
 
+// Add the custom JAR artifact to the 'instrumentedJars' configuration
 artifacts {
     add("instrumentedJars", instrumentedJar)
 }
diff --git a/platforms/documentation/docs/src/snippets/plugins/pluginProject/groovy/buildSrc/build.gradle b/platforms/documentation/docs/src/snippets/plugins/pluginProject/groovy/buildSrc/build.gradle
index 3a102f14046..b2695169a7a 100644
--- a/platforms/documentation/docs/src/snippets/plugins/pluginProject/groovy/buildSrc/build.gradle
+++ b/platforms/documentation/docs/src/snippets/plugins/pluginProject/groovy/buildSrc/build.gradle
@@ -11,5 +11,5 @@ repositories {
 }
 
 dependencies {
-    implementation 'org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:2.1.21'
+    implementation 'org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:2.2.0'
 }
diff --git a/platforms/documentation/docs/src/snippets/plugins/pluginProject/groovy/database-logic/build.gradle b/platforms/documentation/docs/src/snippets/plugins/pluginProject/groovy/database-logic/build.gradle
index d8b60951f9c..adb2860eb43 100644
--- a/platforms/documentation/docs/src/snippets/plugins/pluginProject/groovy/database-logic/build.gradle
+++ b/platforms/documentation/docs/src/snippets/plugins/pluginProject/groovy/database-logic/build.gradle
@@ -1,6 +1,6 @@
 plugins {
     id 'java-library'
-    id 'org.jetbrains.kotlin.jvm' version '2.1.21'
+    id 'org.jetbrains.kotlin.jvm' version '2.2.0'
 }
 
 repositories {
diff --git a/platforms/documentation/docs/src/snippets/plugins/pluginProject/kotlin/buildSrc/build.gradle.kts b/platforms/documentation/docs/src/snippets/plugins/pluginProject/kotlin/buildSrc/build.gradle.kts
index 68ff77be0e1..fb674d6eb09 100644
--- a/platforms/documentation/docs/src/snippets/plugins/pluginProject/kotlin/buildSrc/build.gradle.kts
+++ b/platforms/documentation/docs/src/snippets/plugins/pluginProject/kotlin/buildSrc/build.gradle.kts
@@ -11,6 +11,6 @@ repositories {
 }
 
 dependencies {
-    implementation("org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:2.1.21")
+    implementation("org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:2.2.0")
 }
 
diff --git a/platforms/documentation/docs/src/snippets/plugins/pluginProject/kotlin/database-logic/build.gradle.kts b/platforms/documentation/docs/src/snippets/plugins/pluginProject/kotlin/database-logic/build.gradle.kts
index 32fe3ecd686..50acdcdbee5 100644
--- a/platforms/documentation/docs/src/snippets/plugins/pluginProject/kotlin/database-logic/build.gradle.kts
+++ b/platforms/documentation/docs/src/snippets/plugins/pluginProject/kotlin/database-logic/build.gradle.kts
@@ -1,6 +1,6 @@
 plugins {
     id("java-library")
-    id("org.jetbrains.kotlin.jvm") version "2.1.21"
+    id("org.jetbrains.kotlin.jvm") version "2.2.0"
 }
 
 repositories {
diff --git a/platforms/documentation/samples/src/integTest/groovy/org/gradle/integtests/samples/SamplesWebProjectIntegrationTest.groovy b/platforms/documentation/samples/src/integTest/groovy/org/gradle/integtests/samples/SamplesWebProjectIntegrationTest.groovy
index 1cff38badad..4d29b6e1c11 100644
--- a/platforms/documentation/samples/src/integTest/groovy/org/gradle/integtests/samples/SamplesWebProjectIntegrationTest.groovy
+++ b/platforms/documentation/samples/src/integTest/groovy/org/gradle/integtests/samples/SamplesWebProjectIntegrationTest.groovy
@@ -19,10 +19,12 @@ package org.gradle.integtests.samples
 import org.gradle.integtests.fixtures.AbstractIntegrationSpec
 import org.gradle.integtests.fixtures.Sample
 import org.gradle.test.fixtures.file.TestFile
+import org.gradle.util.ports.ReleasingPortAllocator
 import org.junit.Rule
 
 class SamplesWebProjectIntegrationTest extends AbstractIntegrationSpec {
     @Rule public final Sample sample = new Sample(temporaryFolder, 'webApplication/customized/groovy')
+    @Rule ReleasingPortAllocator portAllocator = new ReleasingPortAllocator()
 
     def setup() {
         executer.withRepositoryMirrors()
diff --git a/platforms/documentation/samples/src/integTest/groovy/org/gradle/integtests/samples/SamplesWebQuickstartIntegrationTest.groovy b/platforms/documentation/samples/src/integTest/groovy/org/gradle/integtests/samples/SamplesWebQuickstartIntegrationTest.groovy
index 120cbad9e56..99df143788c 100644
--- a/platforms/documentation/samples/src/integTest/groovy/org/gradle/integtests/samples/SamplesWebQuickstartIntegrationTest.groovy
+++ b/platforms/documentation/samples/src/integTest/groovy/org/gradle/integtests/samples/SamplesWebQuickstartIntegrationTest.groovy
@@ -19,10 +19,12 @@ package org.gradle.integtests.samples
 import org.gradle.integtests.fixtures.AbstractIntegrationSpec
 import org.gradle.integtests.fixtures.Sample
 import org.gradle.test.fixtures.file.TestFile
+import org.gradle.util.ports.ReleasingPortAllocator
 import org.junit.Rule
 
 class SamplesWebQuickstartIntegrationTest extends AbstractIntegrationSpec {
     @Rule public final Sample sample = new Sample(temporaryFolder, 'webApplication/quickstart/groovy')
+    @Rule ReleasingPortAllocator portFinder = new ReleasingPortAllocator()
 
     def setup() {
         executer.withRepositoryMirrors()
diff --git a/platforms/jvm/language-groovy/build.gradle.kts b/platforms/jvm/language-groovy/build.gradle.kts
index cd3e19d510b..d28ee1bf461 100644
--- a/platforms/jvm/language-groovy/build.gradle.kts
+++ b/platforms/jvm/language-groovy/build.gradle.kts
@@ -51,7 +51,6 @@ dependencies {
     testFixturesImplementation(projects.internalIntegTesting)
     testFixturesImplementation(testFixtures(projects.modelReflect))
     testFixturesImplementation(libs.guava)
-    testFixturesImplementation(testFixtures(projects.core))
 
     integTestImplementation(testFixtures(projects.modelReflect))
     integTestImplementation(libs.commonsLang)
diff --git a/platforms/jvm/plugins-application/src/main/java/org/gradle/api/internal/plugins/StartScriptTemplateBindingFactory.java b/platforms/jvm/plugins-application/src/main/java/org/gradle/api/internal/plugins/StartScriptTemplateBindingFactory.java
index d40b86f0043..10592a4a079 100644
--- a/platforms/jvm/plugins-application/src/main/java/org/gradle/api/internal/plugins/StartScriptTemplateBindingFactory.java
+++ b/platforms/jvm/plugins-application/src/main/java/org/gradle/api/internal/plugins/StartScriptTemplateBindingFactory.java
@@ -114,9 +114,6 @@ private static String getModuleEntryPoint(MainModule entryPoint) {
     }
 
     private String createJoinedPath(Iterable<String> path) {
-        if (!windows && !path.iterator().hasNext()) {
-            return "\"\\\\\\\"\\\\\\\"\""; // empty path argument for shell script
-        }
         return Streams.stream(path).map(this::encodePath).collect(Collectors.joining(getMultiPathSeparator()));
     }
 
diff --git a/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/unixStartScript.txt b/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/unixStartScript.txt
index c71b056fc64..1358dd7b4b2 100644
--- a/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/unixStartScript.txt
+++ b/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/unixStartScript.txt
@@ -147,7 +147,9 @@ case "\$( uname )" in                #(
   NONSTOP* )        nonstop=true ;;
 esac
 
+<% if ( classpath ) {%>\
 CLASSPATH=$classpath
+<% } %>\
 <% if ( mainClassName.startsWith('--module ') ) { %>
 MODULE_PATH=$modulePath
 <% } %>
@@ -207,7 +209,9 @@ fi
 # For Cygwin or MSYS, switch paths to Windows format before running java
 if "\$cygwin" || "\$msys" ; then
     APP_HOME=\$( cygpath --path --mixed "\$APP_HOME" )
+<% if ( classpath ) {%>\
     CLASSPATH=\$( cygpath --path --mixed "\$CLASSPATH" )
+<% } %>\
 <% if ( mainClassName.startsWith('--module ') ) { %>    MODULE_PATH=\$( cygpath --path --mixed "\$MODULE_PATH" )<% } %>
     JAVACMD=\$( cygpath --unix "\$JAVACMD" )
 
@@ -251,7 +255,10 @@ DEFAULT_JVM_OPTS=${defaultJvmOpts}
 set -- \\
 <% if ( appNameSystemProperty ) {
      %>        "-D${appNameSystemProperty}=\$APP_BASE_NAME" \\
-<% } %>        -classpath "\$CLASSPATH" \\
+<% } %>\
+<% if ( classpath ) {%>\
+        -classpath "\$CLASSPATH" \\
+<% } %>\
 <% if ( mainClassName.startsWith('--module ') ) {
      %>        --module-path "\$MODULE_PATH" \\
 <% } %>        ${mainClassName ?: entryPointArgs} \\
diff --git a/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/windowsStartScript.txt b/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/windowsStartScript.txt
index 95b88fe56d3..82e7fa8a452 100644
--- a/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/windowsStartScript.txt
+++ b/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/windowsStartScript.txt
@@ -71,11 +71,13 @@ goto fail
 :execute
 @rem Setup the command line
 
+<% if ( classpath ) {%>\
 set CLASSPATH=$classpath
+<% } %>\
 <% if ( mainClassName.startsWith('--module ') ) { %>set MODULE_PATH=$modulePath<% } %>
 
 @rem Execute ${applicationName}
-"%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% %${optsEnvironmentVar}% <% if ( appNameSystemProperty ) { %>"-D${appNameSystemProperty}=%APP_BASE_NAME%"<% } %> -classpath "%CLASSPATH%" <% if ( mainClassName.startsWith('--module ') ) { %>--module-path "%MODULE_PATH%" <% } %>${mainClassName ?: entryPointArgs} %*
+"%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% %${optsEnvironmentVar}% <% if ( appNameSystemProperty ) { %>"-D${appNameSystemProperty}=%APP_BASE_NAME%"<% } %><% if ( classpath ) {%> -classpath "%CLASSPATH%"<% } %> <% if ( mainClassName.startsWith('--module ') ) { %>--module-path "%MODULE_PATH%" <% } %>${mainClassName ?: entryPointArgs} %*
 
 :end
 @rem End local scope for the variables with windows NT shell
diff --git a/platforms/jvm/plugins-application/src/test/groovy/org/gradle/api/internal/plugins/UnixStartScriptGeneratorTest.groovy b/platforms/jvm/plugins-application/src/test/groovy/org/gradle/api/internal/plugins/UnixStartScriptGeneratorTest.groovy
index 4b5abca8313..df9c823f872 100644
--- a/platforms/jvm/plugins-application/src/test/groovy/org/gradle/api/internal/plugins/UnixStartScriptGeneratorTest.groovy
+++ b/platforms/jvm/plugins-application/src/test/groovy/org/gradle/api/internal/plugins/UnixStartScriptGeneratorTest.groovy
@@ -18,7 +18,7 @@ package org.gradle.api.internal.plugins
 
 import org.gradle.jvm.application.scripts.JavaAppStartScriptGenerationDetails
 import org.gradle.util.internal.TextUtil
-import org.gradle.util.internal.WrapUtil
+import spock.lang.Issue
 import spock.lang.Specification
 
 import java.util.regex.Pattern
@@ -144,9 +144,33 @@ class UnixStartScriptGeneratorTest extends Specification {
         "main module with main class" | new MainModule("com.example", "com.example.Main") | '--module com.example/com.example.Main'
     }
 
-    private JavaAppStartScriptGenerationDetails createScriptGenerationDetails(List<String> defaultJvmOpts, String scriptRelPath, AppEntryPoint appEntryPoint = new MainClass("")) {
+    @Issue("https://github.com/gradle/gradle/issues/33415")
+    def "Do not set classpath if it is empty"() {
+        given:
+        JavaAppStartScriptGenerationDetails details = createScriptGenerationDetails(null, 'bin', new MainClass(""), classpath)
+        Writer destination = new StringWriter()
+
+        when:
+        generator.generateScript(details, destination)
+
+        then:
+        destination.toString().contains(text) == result
+
+        where:
+        classpath             | text                     | result
+        []                    | '-classpath "$CLASSPATH' | false
+        []                    | 'CLASSPATH='             | false
+        ['path\\to\\Jar.jar'] | '-classpath "$CLASSPATH' | true
+        ['path\\to\\Jar.jar'] | 'CLASSPATH='             | true
+    }
+
+    private JavaAppStartScriptGenerationDetails createScriptGenerationDetails(
+        List<String> defaultJvmOpts,
+        String scriptRelPath,
+        AppEntryPoint appEntryPoint = new MainClass(""),
+        List<String> classpath = ['path\\to\\Jar.jar']
+    ) {
         final String applicationName = 'TestApp'
-        final List<String> classpath = WrapUtil.toList('path\\to\\Jar.jar')
         return new DefaultJavaAppStartScriptGenerationDetails(applicationName, null, null, appEntryPoint, defaultJvmOpts, classpath, [], scriptRelPath, null)
     }
 }
diff --git a/platforms/jvm/plugins-application/src/test/groovy/org/gradle/api/internal/plugins/WindowsStartScriptGeneratorTest.groovy b/platforms/jvm/plugins-application/src/test/groovy/org/gradle/api/internal/plugins/WindowsStartScriptGeneratorTest.groovy
index c98545eceb1..e5e14025a2e 100644
--- a/platforms/jvm/plugins-application/src/test/groovy/org/gradle/api/internal/plugins/WindowsStartScriptGeneratorTest.groovy
+++ b/platforms/jvm/plugins-application/src/test/groovy/org/gradle/api/internal/plugins/WindowsStartScriptGeneratorTest.groovy
@@ -18,7 +18,7 @@ package org.gradle.api.internal.plugins
 
 import org.gradle.jvm.application.scripts.JavaAppStartScriptGenerationDetails
 import org.gradle.util.internal.TextUtil
-import org.gradle.util.internal.WrapUtil
+import spock.lang.Issue
 import spock.lang.Specification
 
 class WindowsStartScriptGeneratorTest extends Specification {
@@ -139,9 +139,33 @@ class WindowsStartScriptGeneratorTest extends Specification {
         "main module with main class" | new MainModule("com.example", "com.example.Main") | '--module com.example/com.example.Main'
     }
 
-    private JavaAppStartScriptGenerationDetails createScriptGenerationDetails(List<String> defaultJvmOpts, String scriptRelPath, AppEntryPoint appEntryPoint = new MainClass("")) {
+    @Issue("https://github.com/gradle/gradle/issues/33415")
+    def "Do not set classpath if it is empty"() {
+        given:
+        JavaAppStartScriptGenerationDetails details = createScriptGenerationDetails(null, 'bin', new MainClass(""), classpath)
+        Writer destination = new StringWriter()
+
+        when:
+        generator.generateScript(details, destination)
+
+        then:
+        destination.toString().contains(text) == result
+
+        where:
+        classpath             | text                       | result
+        []                    | 'set CLASSPATH'            | false
+        []                    | '-classpath "%CLASSPATH%"' | false
+        ['path\\to\\Jar.jar'] | 'set CLASSPATH'            | true
+        ['path\\to\\Jar.jar'] | '-classpath "%CLASSPATH%"' | true
+    }
+
+    private JavaAppStartScriptGenerationDetails createScriptGenerationDetails(
+        List<String> defaultJvmOpts,
+        String scriptRelPath,
+        AppEntryPoint appEntryPoint = new MainClass(""),
+        List<String> classpath = ['path/to/Jar.jar']
+    ) {
         final String applicationName = 'TestApp'
-        final List<String> classpath = WrapUtil.toList('path/to/Jar.jar')
         return new DefaultJavaAppStartScriptGenerationDetails(applicationName, null, null, appEntryPoint, defaultJvmOpts, classpath, [], scriptRelPath, null)
     }
 }
diff --git a/platforms/jvm/plugins-jvm-test-suite/src/main/java/org/gradle/api/plugins/JvmTestSuitePlugin.java b/platforms/jvm/plugins-jvm-test-suite/src/main/java/org/gradle/api/plugins/JvmTestSuitePlugin.java
index bf726529d10..3f0cf99c540 100644
--- a/platforms/jvm/plugins-jvm-test-suite/src/main/java/org/gradle/api/plugins/JvmTestSuitePlugin.java
+++ b/platforms/jvm/plugins-jvm-test-suite/src/main/java/org/gradle/api/plugins/JvmTestSuitePlugin.java
@@ -19,16 +19,12 @@
 import org.gradle.api.Incubating;
 import org.gradle.api.Plugin;
 import org.gradle.api.Project;
-import org.gradle.api.file.ConfigurableFileCollection;
-import org.gradle.api.file.FileCollection;
 import org.gradle.api.plugins.jvm.JvmTestSuite;
 import org.gradle.api.plugins.jvm.internal.DefaultJvmTestSuite;
 import org.gradle.api.tasks.testing.Test;
 import org.gradle.testing.base.TestingExtension;
 import org.gradle.testing.base.plugins.TestSuiteBasePlugin;
 
-import java.util.concurrent.Callable;
-
 /**
  * A {@link org.gradle.api.Plugin} that adds extensions for declaring, compiling and running {@link JvmTestSuite}s.
  * <p>
@@ -62,12 +58,8 @@ public void apply(Project project) {
         testing.getSuites().withType(JvmTestSuite.class).all(testSuite -> {
             testSuite.getTargets().all(target -> {
                 target.getTestTask().configure(test -> {
-                    ((ConfigurableFileCollection)test.getTestClassesDirs()).convention((Callable<FileCollection>) () ->
-                        testSuite.getSources().getOutput().getClassesDirs()
-                    );
-                    ((ConfigurableFileCollection)test.getClasspath()).convention((Callable<FileCollection>) () ->
-                        testSuite.getSources().getRuntimeClasspath()
-                    );
+                    test.getConventionMapping().map("testClassesDirs", () -> testSuite.getSources().getOutput().getClassesDirs());
+                    test.getConventionMapping().map("classpath", () -> testSuite.getSources().getRuntimeClasspath());
                 });
                 target.getBinaryResultsDirectory().convention(target.getTestTask().flatMap(Test::getBinaryResultsDirectory));
             });
diff --git a/platforms/jvm/plugins-jvm-test-suite/src/main/java/org/gradle/api/testing/toolchains/internal/KotlinTestTestToolchain.java b/platforms/jvm/plugins-jvm-test-suite/src/main/java/org/gradle/api/testing/toolchains/internal/KotlinTestTestToolchain.java
index 11c5a7a7668..a7c01fb0ed2 100644
--- a/platforms/jvm/plugins-jvm-test-suite/src/main/java/org/gradle/api/testing/toolchains/internal/KotlinTestTestToolchain.java
+++ b/platforms/jvm/plugins-jvm-test-suite/src/main/java/org/gradle/api/testing/toolchains/internal/KotlinTestTestToolchain.java
@@ -29,7 +29,7 @@ abstract public class KotlinTestTestToolchain extends JUnitPlatformTestToolchain
     /**
      * The default version of KotlinTest to use for compiling and executing tests.
      */
-    public static final String DEFAULT_VERSION = "2.1.21";
+    public static final String DEFAULT_VERSION = "2.2.0";
     private static final String GROUP_NAME = "org.jetbrains.kotlin:kotlin-test-junit5";
 
     @Override
diff --git a/platforms/jvm/testing-jvm/src/main/java/org/gradle/api/tasks/testing/Test.java b/platforms/jvm/testing-jvm/src/main/java/org/gradle/api/tasks/testing/Test.java
index ecf0b8207af..0900eb3f56b 100644
--- a/platforms/jvm/testing-jvm/src/main/java/org/gradle/api/tasks/testing/Test.java
+++ b/platforms/jvm/testing-jvm/src/main/java/org/gradle/api/tasks/testing/Test.java
@@ -171,10 +171,10 @@ public abstract class Test extends AbstractTestTask implements JavaForkOptions,
     private final ModularitySpec modularity;
     private final Property<JavaLauncher> javaLauncher;
 
-    private final ConfigurableFileCollection testClassesDirs = getObjectFactory().fileCollection();
+    private FileCollection testClassesDirs;
     private final PatternFilterable patternSet;
-    private final ConfigurableFileCollection classpath = getObjectFactory().fileCollection();
-    private final ConfigurableFileCollection stableClasspath = getObjectFactory().fileCollection();
+    private FileCollection classpath;
+    private final ConfigurableFileCollection stableClasspath;
     private final Property<TestFramework> testFramework;
     private boolean scanForTestClasses = true;
     private long forkEvery;
@@ -184,8 +184,16 @@ public abstract class Test extends AbstractTestTask implements JavaForkOptions,
     public Test() {
         ObjectFactory objectFactory = getObjectFactory();
         patternSet = getPatternSetFactory().createPatternSet();
+        testClassesDirs = objectFactory.fileCollection();
+        classpath = objectFactory.fileCollection();
         // Create a stable instance to represent the classpath, that takes care of conventions and mutations applied to the property
-        stableClasspath.from((Callable<Object>) this::getClasspath);
+        stableClasspath = objectFactory.fileCollection();
+        stableClasspath.from(new Callable<Object>() {
+            @Override
+            public Object call() {
+                return getClasspath();
+            }
+        });
         forkOptions = getForkOptionsFactory().newDecoratedJavaForkOptions();
         forkOptions.setEnableAssertions(true);
         forkOptions.setExecutable(null);
@@ -860,7 +868,7 @@ public FileCollection getTestClassesDirs() {
      * @since 4.0
      */
     public void setTestClassesDirs(FileCollection testClassesDirs) {
-        this.testClassesDirs.setFrom(testClassesDirs);
+        this.testClassesDirs = testClassesDirs;
     }
 
     /**
@@ -1110,7 +1118,7 @@ public FileCollection getClasspath() {
     }
 
     public void setClasspath(FileCollection classpath) {
-        this.classpath.setFrom(classpath);
+        this.classpath = classpath;
     }
 
     /**
diff --git a/platforms/software/antlr/src/main/java/org/gradle/api/plugins/antlr/AntlrPlugin.java b/platforms/software/antlr/src/main/java/org/gradle/api/plugins/antlr/AntlrPlugin.java
index 471f408da34..8e842c63ad4 100644
--- a/platforms/software/antlr/src/main/java/org/gradle/api/plugins/antlr/AntlrPlugin.java
+++ b/platforms/software/antlr/src/main/java/org/gradle/api/plugins/antlr/AntlrPlugin.java
@@ -65,7 +65,7 @@ public void apply(final Project project) {
         JavaPluginHelper.getJavaComponent(project).getMainFeature().getApiConfiguration().extendsFrom(antlrConfiguration);
 
         // Wire the antlr configuration into all antlr tasks
-        project.getTasks().withType(AntlrTask.class).configureEach(antlrTask -> antlrTask.antlrClasspath.convention(antlrConfiguration));
+        project.getTasks().withType(AntlrTask.class).configureEach(antlrTask -> antlrTask.getConventionMapping().map("antlrClasspath", () -> project.getConfigurations().getByName(ANTLR_CONFIGURATION_NAME)));
 
         project.getExtensions().getByType(JavaPluginExtension.class).getSourceSets().all(
             new Action<SourceSet>() {
diff --git a/platforms/software/antlr/src/main/java/org/gradle/api/plugins/antlr/AntlrTask.java b/platforms/software/antlr/src/main/java/org/gradle/api/plugins/antlr/AntlrTask.java
index e34723c96ed..c7edbef958b 100644
--- a/platforms/software/antlr/src/main/java/org/gradle/api/plugins/antlr/AntlrTask.java
+++ b/platforms/software/antlr/src/main/java/org/gradle/api/plugins/antlr/AntlrTask.java
@@ -17,7 +17,6 @@
 package org.gradle.api.plugins.antlr;
 
 import org.gradle.api.Incubating;
-import org.gradle.api.file.ConfigurableFileCollection;
 import org.gradle.api.file.FileCollection;
 import org.gradle.api.file.FileTree;
 import org.gradle.api.file.FileType;
@@ -75,14 +74,13 @@ public abstract class AntlrTask extends SourceTask {
     private boolean traceTreeWalker;
     private List<String> arguments = new ArrayList<>();
 
-    ConfigurableFileCollection antlrClasspath = getProject().getObjects().fileCollection();
+    private FileCollection antlrClasspath;
 
     private File outputDirectory;
     private String maxHeapSize;
     private FileCollection sourceSetDirectories;
     private final FileCollection stableSources = getProject().files((Callable<Object>) this::getSource);
 
-
     /**
      * Specifies that all rules call {@code traceIn}/{@code traceOut}.
      */
@@ -203,7 +201,7 @@ public FileCollection getAntlrClasspath() {
      * @param antlrClasspath The Ant task implementation classpath. Must not be null.
      */
     protected void setAntlrClasspath(FileCollection antlrClasspath) {
-        this.antlrClasspath.setFrom(antlrClasspath);
+        this.antlrClasspath = antlrClasspath;
     }
 
     @Inject
diff --git a/platforms/software/build-init/src/main/resources/org/gradle/buildinit/tasks/templates/library-versions.properties b/platforms/software/build-init/src/main/resources/org/gradle/buildinit/tasks/templates/library-versions.properties
index 92fdc74d481..d04c0001027 100644
--- a/platforms/software/build-init/src/main/resources/org/gradle/buildinit/tasks/templates/library-versions.properties
+++ b/platforms/software/build-init/src/main/resources/org/gradle/buildinit/tasks/templates/library-versions.properties
@@ -5,7 +5,7 @@ groovy=4.0.27
 guava=33.4.6-jre
 junit-jupiter=5.12.1
 junit=4.13.2
-kotlin=2.1.21
+kotlin=2.2.0
 scala-library=2.13.16
 scala-xml=1.2.0
 scala=2.13
diff --git a/released-versions.json b/released-versions.json
index 51456fb5a66..deedc55598c 100644
--- a/released-versions.json
+++ b/released-versions.json
@@ -1,7 +1,7 @@
 {
   "latestReleaseSnapshot": {
-    "version": "9.0.0-20250704011203+0000",
-    "buildTime": "20250704011203+0000"
+    "version": "9.0.0-20250709012915+0000",
+    "buildTime": "20250709012915+0000"
   },
   "latestRc": {
     "version": "9.0.0-rc-1",
diff --git a/testing/architecture-test/src/changes/archunit-store/platform-coupling.txt b/testing/architecture-test/src/changes/archunit-store/platform-coupling.txt
index 5ac724d83a0..54ba4b4e7ec 100644
--- a/testing/architecture-test/src/changes/archunit-store/platform-coupling.txt
+++ b/testing/architecture-test/src/changes/archunit-store/platform-coupling.txt
@@ -84,7 +84,7 @@ Class 'org.gradle.internal.cc.impl.metadata.ProjectMetadataController' from plat
 Class 'org.gradle.internal.cc.impl.metadata.ProjectMetadataController' from platform 'core' imports class 'org.gradle.internal.component.model.LocalComponentDependencyMetadata' from a forbidden platform 'software'
 Class 'org.gradle.internal.cc.impl.metadata.ProjectMetadataController' from platform 'core' imports class 'org.gradle.internal.component.model.VariantArtifactResolveState' from a forbidden platform 'software'
 Class 'org.gradle.internal.cc.impl.metadata.ProjectMetadataController' from platform 'core' imports class 'org.gradle.internal.component.model.VariantResolveMetadata' from a forbidden platform 'software'
-Class 'org.gradle.internal.cc.impl.serialize.Codecs$makeUserTypeBindings$1' from platform 'core' imports class 'org.gradle.api.internal.artifacts.ivyservice.resolveengine.result.CapabilitySerializer' from a forbidden platform 'software'
+Class 'org.gradle.internal.cc.impl.serialize.Codecs' from platform 'core' imports class 'org.gradle.api.internal.artifacts.ivyservice.resolveengine.result.CapabilitySerializer' from a forbidden platform 'software'
 Class 'org.gradle.internal.cc.impl.services.ConfigurationCacheEnvironment' from platform 'core' imports class 'org.gradle.internal.resource.local.FileResourceListener' from a forbidden platform 'software'
 Class 'org.gradle.internal.cc.impl.services.RemoteScriptUpToDateChecker$isUpToDate$2' from platform 'core' imports class 'org.gradle.internal.resource.ExternalResourceName' from a forbidden platform 'software'
 Class 'org.gradle.internal.cc.impl.services.RemoteScriptUpToDateChecker$isUpToDate$2' from platform 'core' imports class 'org.gradle.internal.resource.cached.CachedExternalResourceIndex' from a forbidden platform 'software'
@@ -137,12 +137,12 @@ Class 'org.gradle.internal.serialize.codecs.dm.RecordingVariantSet' from platfor
 Class 'org.gradle.internal.serialize.codecs.dm.RecordingVariantSet' from platform 'core' imports class 'org.gradle.api.internal.attributes.immutable.ImmutableAttributesSchema' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.RecordingVariantSet' from platform 'core' imports class 'org.gradle.internal.component.external.model.ImmutableCapabilities' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.ResolveArtifactNodeCodec' from platform 'core' imports class 'org.gradle.api.internal.artifacts.DefaultResolvableArtifact$ResolveAction' from a forbidden platform 'software'
-Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet$artifacts$2' from platform 'core' imports class 'org.gradle.api.internal.artifacts.PreResolvedResolvableArtifact' from a forbidden platform 'software'
-Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet$artifacts$2' from platform 'core' imports class 'org.gradle.internal.component.local.model.ComponentFileArtifactIdentifier' from a forbidden platform 'software'
-Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet$artifacts$2' from platform 'core' imports class 'org.gradle.internal.component.model.DefaultIvyArtifactName' from a forbidden platform 'software'
+Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet' from platform 'core' imports class 'org.gradle.api.internal.artifacts.PreResolvedResolvableArtifact' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet' from platform 'core' imports class 'org.gradle.api.internal.artifacts.ivyservice.resolveengine.artifact.ArtifactVisitor' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet' from platform 'core' imports class 'org.gradle.api.internal.artifacts.ivyservice.resolveengine.artifact.ResolvedArtifactSet$Visitor' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet' from platform 'core' imports class 'org.gradle.internal.component.external.model.ImmutableCapabilities' from a forbidden platform 'software'
+Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet' from platform 'core' imports class 'org.gradle.internal.component.local.model.ComponentFileArtifactIdentifier' from a forbidden platform 'software'
+Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$FixedFilesArtifactSet' from platform 'core' imports class 'org.gradle.internal.component.model.DefaultIvyArtifactName' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$encode$2' from platform 'core' imports class 'org.gradle.api.internal.artifacts.ivyservice.resolveengine.artifact.ResolvableArtifact' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec$encode$2' from platform 'core' imports class 'org.gradle.internal.component.model.IvyArtifactName' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.transform.CalculateArtifactsCodec' from platform 'core' imports class 'org.gradle.api.internal.artifacts.ivyservice.resolveengine.artifact.ResolvedArtifactSet' from a forbidden platform 'software'
@@ -179,7 +179,7 @@ Class 'org.gradle.internal.serialize.codecs.dm.transform.TransformsKt' from plat
 Class 'org.gradle.internal.serialize.codecs.dm.transform.TransformsKt' from platform 'core' imports class 'org.gradle.api.internal.artifacts.transform.TransformStep' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.transform.TransformsKt' from platform 'core' imports class 'org.gradle.api.internal.artifacts.transform.TransformStepNode' from a forbidden platform 'software'
 Class 'org.gradle.internal.serialize.codecs.dm.transform.TransformsKt' from platform 'core' imports class 'org.gradle.api.internal.artifacts.transform.TransformUpstreamDependencies' from a forbidden platform 'software'
-Class 'org.gradle.kotlin.dsl.execution.Interpreter$compile$1' from platform 'core' imports class 'org.gradle.internal.resource.TextResource' from a forbidden platform 'software'
+Class 'org.gradle.kotlin.dsl.execution.Interpreter' from platform 'core' imports class 'org.gradle.internal.resource.TextResource' from a forbidden platform 'software'
 Class 'org.gradle.kotlin.dsl.provider.plugins.precompiled.DefaultPrecompiledScriptPluginsSupport' from platform 'core' imports class 'org.gradle.plugin.devel.GradlePluginDevelopmentExtension' from a forbidden platform 'extensibility'
 Class 'org.gradle.kotlin.dsl.provider.plugins.precompiled.DefaultPrecompiledScriptPluginsSupportKt$declareScriptPlugins$1$1' from platform 'core' imports class 'org.gradle.plugin.devel.PluginDeclaration' from a forbidden platform 'extensibility'
 Class 'org.gradle.kotlin.dsl.provider.plugins.precompiled.DefaultPrecompiledScriptPluginsSupportKt$registerCompilePluginsBlocksTask$2' from platform 'core' imports class 'org.gradle.api.plugins.JavaPluginExtension' from a forbidden platform 'jvm'
@@ -190,9 +190,9 @@ Class 'org.gradle.kotlin.dsl.provider.plugins.precompiled.tasks.CompilePrecompil
 Class 'org.gradle.kotlin.dsl.provider.plugins.precompiled.tasks.CompilePrecompiledScriptPluginPlugins' from platform 'core' imports class 'org.gradle.jvm.toolchain.JavaLanguageVersion' from a forbidden platform 'jvm'
 Class 'org.gradle.kotlin.dsl.provider.plugins.precompiled.tasks.CompilePrecompiledScriptPluginPlugins' from platform 'core' imports class 'org.gradle.jvm.toolchain.JavaLauncher' from a forbidden platform 'jvm'
 Class 'org.gradle.kotlin.dsl.provider.plugins.precompiled.tasks.GeneratePrecompiledScriptPluginAccessors' from platform 'core' imports class 'org.gradle.internal.resource.TextFileResourceLoader' from a forbidden platform 'software'
-Class 'org.gradle.kotlin.dsl.support.KotlinScriptHost$fileOperations$2' from platform 'core' imports class 'org.gradle.internal.resource.ResourceLocation' from a forbidden platform 'software'
-Class 'org.gradle.kotlin.dsl.support.KotlinScriptHost$fileOperations$2' from platform 'core' imports class 'org.gradle.internal.resource.TextResource' from a forbidden platform 'software'
-Class 'org.gradle.kotlin.dsl.tooling.builders.BuildSrcClassPathModeConfigurationAction$allSourceSetsRoots$1' from platform 'core' imports class 'org.gradle.api.tasks.SourceSet' from a forbidden platform 'jvm'
+Class 'org.gradle.kotlin.dsl.support.KotlinScriptHost' from platform 'core' imports class 'org.gradle.internal.resource.ResourceLocation' from a forbidden platform 'software'
+Class 'org.gradle.kotlin.dsl.support.KotlinScriptHost' from platform 'core' imports class 'org.gradle.internal.resource.TextResource' from a forbidden platform 'software'
+Class 'org.gradle.kotlin.dsl.tooling.builders.BuildSrcClassPathModeConfigurationAction' from platform 'core' imports class 'org.gradle.api.tasks.SourceSet' from a forbidden platform 'jvm'
 Class 'org.gradle.kotlin.dsl.tooling.builders.KotlinBuildScriptModelBuilder' from platform 'core' imports class 'org.gradle.internal.resource.TextResource' from a forbidden platform 'software'
 Class 'org.gradle.kotlin.dsl.tooling.builders.KotlinBuildScriptModelBuilderKt' from platform 'core' imports class 'org.gradle.api.tasks.SourceSet' from a forbidden platform 'jvm'
 Class 'org.gradle.kotlin.dsl.tooling.builders.KotlinBuildScriptModelBuilderKt' from platform 'core' imports class 'org.gradle.internal.resource.TextFileResourceLoader' from a forbidden platform 'software'
diff --git a/testing/architecture-test/src/changes/archunit-store/public-api-nullability.txt b/testing/architecture-test/src/changes/archunit-store/public-api-nullability.txt
index 1262c347e36..7bf6ebb49ff 100644
--- a/testing/architecture-test/src/changes/archunit-store/public-api-nullability.txt
+++ b/testing/architecture-test/src/changes/archunit-store/public-api-nullability.txt
@@ -162,6 +162,7 @@ Class <org.gradle.api.tasks.testing.AggregateTestReport> is not annotated (direc
 Class <org.gradle.api.tasks.testing.GroupTestEventReporter> is not annotated (directly or via its package) with @org.jspecify.annotations.NullMarked in (GroupTestEventReporter.java:0)
 Class <org.gradle.api.tasks.testing.JUnitXmlReport> is not annotated (directly or via its package) with @org.jspecify.annotations.NullMarked in (JUnitXmlReport.java:0)
 Class <org.gradle.api.tasks.testing.Test$1> is not annotated (directly or via its package) with @org.jspecify.annotations.NullMarked in (Test.java:0)
+Class <org.gradle.api.tasks.testing.Test$2> is not annotated (directly or via its package) with @org.jspecify.annotations.NullMarked in (Test.java:0)
 Class <org.gradle.api.tasks.testing.TestEventReporter> is not annotated (directly or via its package) with @org.jspecify.annotations.NullMarked in (TestEventReporter.java:0)
 Class <org.gradle.api.tasks.testing.TestEventReporterFactory> is not annotated (directly or via its package) with @org.jspecify.annotations.NullMarked in (TestEventReporterFactory.java:0)
 Class <org.gradle.api.tasks.testing.TestExecutionException> is not annotated (directly or via its package) with @org.jspecify.annotations.NullMarked in (TestExecutionException.java:0)
diff --git a/testing/distributions-integ-tests/src/integTest/groovy/org/gradle/DistributionIntegrationSpec.groovy b/testing/distributions-integ-tests/src/integTest/groovy/org/gradle/DistributionIntegrationSpec.groovy
index 0c94dc0041d..af830880ad3 100644
--- a/testing/distributions-integ-tests/src/integTest/groovy/org/gradle/DistributionIntegrationSpec.groovy
+++ b/testing/distributions-integ-tests/src/integTest/groovy/org/gradle/DistributionIntegrationSpec.groovy
@@ -34,7 +34,7 @@ import static org.hamcrest.MatcherAssert.assertThat
 
 abstract class DistributionIntegrationSpec extends AbstractIntegrationSpec {
 
-    protected static final THIRD_PARTY_LIB_COUNT = 128
+    protected static final THIRD_PARTY_LIB_COUNT = 127
 
     @Shared
     String baseVersion = GradleVersion.current().baseVersion.version
diff --git a/testing/internal-integ-testing/build.gradle.kts b/testing/internal-integ-testing/build.gradle.kts
index 25f19a3778e..da776a2373a 100644
--- a/testing/internal-integ-testing/build.gradle.kts
+++ b/testing/internal-integ-testing/build.gradle.kts
@@ -51,6 +51,10 @@ dependencies {
     api(projects.daemonProtocol)
     api(projects.serviceLookup)
 
+    api(testFixtures(projects.core)) {
+        because("HttpServer leaks PortAllocator to spock AST transformer")
+    }
+
     api(libs.gson)
     api(libs.groovy)
     api(libs.groovyXml)
@@ -116,7 +120,6 @@ dependencies {
 
     implementation(testFixtures(projects.buildOperations))
     implementation(testFixtures(projects.buildProcessServices))
-    implementation(testFixtures(projects.core))
 
     implementation(libs.ansiControlSequenceUtil)
     implementation(libs.commonsCompress)
diff --git a/testing/internal-integ-testing/src/main/groovy/org/gradle/test/fixtures/server/http/HttpServerFixture.groovy b/testing/internal-integ-testing/src/main/groovy/org/gradle/test/fixtures/server/http/HttpServerFixture.groovy
index a6495c7b302..11c29246101 100644
--- a/testing/internal-integ-testing/src/main/groovy/org/gradle/test/fixtures/server/http/HttpServerFixture.groovy
+++ b/testing/internal-integ-testing/src/main/groovy/org/gradle/test/fixtures/server/http/HttpServerFixture.groovy
@@ -16,6 +16,7 @@
 
 package org.gradle.test.fixtures.server.http
 
+
 import groovy.transform.CompileStatic
 import org.eclipse.jetty.http.HttpVersion
 import org.eclipse.jetty.server.Connector
@@ -31,11 +32,14 @@ import org.eclipse.jetty.server.handler.HandlerCollection
 import org.eclipse.jetty.util.ssl.SslContextFactory
 import org.gradle.api.Action
 import org.gradle.internal.Actions
+import org.gradle.util.ports.FixedAvailablePortAllocator
+import org.gradle.util.ports.PortAllocator
 
 import java.util.function.Consumer
 
 @CompileStatic
 trait HttpServerFixture {
+    private final PortAllocator portAllocator = FixedAvailablePortAllocator.instance
     private final Server server = new Server()
     private ServerConnector connector
     private ServerConnector sslConnector
@@ -135,16 +139,36 @@ trait HttpServerFixture {
 
         if (!server.started) {
             server.start()
-            createConnector()
-            assert connector.localPort > 0
+            for (int i = 0; i < 5; i++) {
+                if (createConnector() && connector.localPort > 0) {
+                    return
+                }
+                // Has failed to start for some reason - try again
+                releaseConnector()
+            }
+            throw new AssertionError((Object) "SocketConnector failed to start.") // cast because of Groovy bug
         }
     }
 
-    private void createConnector() {
+    private void releaseConnector() {
+        def port = connector.port
+        server.removeConnector(connector)
+        connector.stop()
+        portAllocator.releasePort(port)
+    }
+
+    private boolean createConnector() {
+        def assignedPort = portAllocator.assignPort()
         connector = new ServerConnector(server)
-        connector.port = 0
+        connector.port = assignedPort
         server.addConnector(connector)
-        connector.start()
+        try {
+            connector.start()
+            return true
+        } catch (e) {
+            println "Unable to start connector on port ${assignedPort}"
+        }
+        return false
     }
 
     void stop() {
@@ -192,7 +216,7 @@ trait HttpServerFixture {
 
         sslConnector = new ServerConnector(server,
             connectionFactory, httpConnectionFactory)
-        sslConnector.setPort(0)
+        sslConnector.setPort(portAllocator.assignPort())
         server.addConnector(sslConnector)
         if (server.started) {
             sslConnector.start()
@@ -213,9 +237,11 @@ trait HttpServerFixture {
     }
 
     private void shutdownConnector(ServerConnector connector) {
+        def port = connector.port
         connector.stop()
         connector.close()
         server?.removeConnector(connector)
+        portAllocator.releasePort(port)
     }
 }
 
diff --git a/testing/internal-integ-testing/src/main/groovy/org/gradle/test/fixtures/server/http/TestProxyServer.groovy b/testing/internal-integ-testing/src/main/groovy/org/gradle/test/fixtures/server/http/TestProxyServer.groovy
index f6cbb9689e5..05e5a6f2887 100644
--- a/testing/internal-integ-testing/src/main/groovy/org/gradle/test/fixtures/server/http/TestProxyServer.groovy
+++ b/testing/internal-integ-testing/src/main/groovy/org/gradle/test/fixtures/server/http/TestProxyServer.groovy
@@ -18,6 +18,8 @@ package org.gradle.test.fixtures.server.http
 import io.netty.channel.ChannelHandlerContext
 import io.netty.handler.codec.http.HttpRequest
 import org.gradle.integtests.fixtures.executer.GradleExecuter
+import org.gradle.util.ports.FixedAvailablePortAllocator
+import org.gradle.util.ports.PortAllocator
 import org.junit.rules.ExternalResource
 import org.littleshoot.proxy.HttpFilters
 import org.littleshoot.proxy.HttpFiltersSourceAdapter
@@ -31,6 +33,7 @@ import java.util.concurrent.atomic.AtomicInteger
  * A Proxy Server used for testing that proxies are correctly supported.
  */
 class TestProxyServer extends ExternalResource {
+    private PortAllocator portFinder = FixedAvailablePortAllocator.getInstance()
     private HttpProxyServer proxyServer
     private int port
     private AtomicInteger requestCountInternal = new AtomicInteger()
@@ -45,10 +48,11 @@ class TestProxyServer extends ExternalResource {
     }
 
     void start(final String expectedUsername = null, final String expectedPassword = null) {
-        startHttpProxy(expectedUsername, expectedPassword)
+        port = portFinder.assignPort()
+        startHttpProxy(expectedUsername, expectedPassword, port)
     }
 
-    private void startHttpProxy(String expectedUsername, String expectedPassword) {
+    private void startHttpProxy(String expectedUsername, String expectedPassword, int port) {
         def filters = new HttpFiltersSourceAdapter() {
             HttpFilters filterRequest(HttpRequest originalRequest, ChannelHandlerContext ctx) {
                 requestCountInternal.incrementAndGet()
@@ -72,12 +76,10 @@ class TestProxyServer extends ExternalResource {
         }
 
         proxyServer = DefaultHttpProxyServer.bootstrap()
-            .withPort(0)
+            .withPort(port)
             .withFiltersSource(filters)
             .withProxyAuthenticator(proxyAuthenticator)
             .start()
-
-        port = proxyServer.getListenAddress().getPort()
     }
 
     @Override
@@ -90,6 +92,7 @@ class TestProxyServer extends ExternalResource {
 
     void stop() {
         proxyServer?.stop()
+        portFinder.releasePort(port)
     }
 
     void configureProxy(GradleExecuter executer, String proxyScheme, String userName = null, String password = null) {
diff --git a/testing/internal-performance-testing/src/main/groovy/org/gradle/performance/generator/JavaTestProjectGenerator.groovy b/testing/internal-performance-testing/src/main/groovy/org/gradle/performance/generator/JavaTestProjectGenerator.groovy
index 0b4cffb61f9..e8f190868e3 100644
--- a/testing/internal-performance-testing/src/main/groovy/org/gradle/performance/generator/JavaTestProjectGenerator.groovy
+++ b/testing/internal-performance-testing/src/main/groovy/org/gradle/performance/generator/JavaTestProjectGenerator.groovy
@@ -161,7 +161,7 @@ enum JavaTestProjectGenerator {
             "otel" : "io.opentelemetry:opentelemetry-sdk:1.33.0",
             "jackson" : "com.fasterxml.jackson.core:jackson-databind:2.10.0",
             "junit5" : "org.junit.jupiter:junit-jupiter-engine:5.10.0",
-            "kotlin": "org.jetbrains.kotlin:kotlin-stdlib:2.1.21",
+            "kotlin": "org.jetbrains.kotlin:kotlin-stdlib:2.2.0",
             "testcontainers": "org.testcontainers:mysql:1.15.3",
             "vertx": "io.vertx:vertx-web:4.4.2",
             "keycloak": "org.keycloak:keycloak-core:24.0.1"
