diff --git a/mockwebserver-deprecated/src/main/kotlin/okhttp3/mockwebserver/MockWebServer.kt b/mockwebserver-deprecated/src/main/kotlin/okhttp3/mockwebserver/MockWebServer.kt
index acc23da14..d82f78a99 100644
--- a/mockwebserver-deprecated/src/main/kotlin/okhttp3/mockwebserver/MockWebServer.kt
+++ b/mockwebserver-deprecated/src/main/kotlin/okhttp3/mockwebserver/MockWebServer.kt
@@ -24,6 +24,7 @@ import java.util.logging.Level
 import java.util.logging.Logger
 import javax.net.ServerSocketFactory
 import javax.net.ssl.SSLSocketFactory
+import okhttp3.ExperimentalOkHttpApi
 import okhttp3.HttpUrl
 import okhttp3.Protocol
 import org.junit.rules.ExternalResource
@@ -31,6 +32,7 @@ import org.junit.rules.ExternalResource
 class MockWebServer :
   ExternalResource(),
   Closeable {
+  @ExperimentalOkHttpApi
   val delegate = mockwebserver3.MockWebServer()
 
   val requestCount: Int by delegate::requestCount
@@ -60,7 +62,11 @@ class MockWebServer :
   var protocolNegotiationEnabled: Boolean by delegate::protocolNegotiationEnabled
 
   @get:JvmName("protocols")
-  var protocols: List<Protocol> by delegate::protocols
+  var protocols: List<Protocol>
+    get() = delegate.protocols
+    set(value) {
+      delegate.protocols = value
+    }
 
   init {
     delegate.dispatcher = dispatcher.wrap()
@@ -78,14 +84,27 @@ class MockWebServer :
   }
 
   @JvmName("-deprecated_port")
+  @Deprecated(
+    message = "moved to val",
+    replaceWith = ReplaceWith(expression = "port"),
+    level = DeprecationLevel.ERROR,
+  )
   fun getPort(): Int = port
 
   fun toProxyAddress(): Proxy {
     before() // This implicitly starts the delegate.
-    return delegate.proxyAddress
+    return delegate.toProxyAddress()
   }
 
   @JvmName("-deprecated_serverSocketFactory")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith =
+      ReplaceWith(
+        expression = "run { this.serverSocketFactory = serverSocketFactory }",
+      ),
+    level = DeprecationLevel.ERROR,
+  )
   fun setServerSocketFactory(serverSocketFactory: ServerSocketFactory) {
     delegate.serverSocketFactory = serverSocketFactory
   }
@@ -96,21 +115,47 @@ class MockWebServer :
   }
 
   @JvmName("-deprecated_bodyLimit")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith =
+      ReplaceWith(
+        expression = "run { this.bodyLimit = bodyLimit }",
+      ),
+    level = DeprecationLevel.ERROR,
+  )
   fun setBodyLimit(bodyLimit: Long) {
     delegate.bodyLimit = bodyLimit
   }
 
   @JvmName("-deprecated_protocolNegotiationEnabled")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith =
+      ReplaceWith(
+        expression = "run { this.protocolNegotiationEnabled = protocolNegotiationEnabled }",
+      ),
+    level = DeprecationLevel.ERROR,
+  )
   fun setProtocolNegotiationEnabled(protocolNegotiationEnabled: Boolean) {
     delegate.protocolNegotiationEnabled = protocolNegotiationEnabled
   }
 
   @JvmName("-deprecated_protocols")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith = ReplaceWith(expression = "run { this.protocols = protocols }"),
+    level = DeprecationLevel.ERROR,
+  )
   fun setProtocols(protocols: List<Protocol>) {
     delegate.protocols = protocols
   }
 
   @JvmName("-deprecated_protocols")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith = ReplaceWith(expression = "protocols"),
+    level = DeprecationLevel.ERROR,
+  )
   fun protocols(): List<Protocol> = delegate.protocols
 
   fun useHttps(
@@ -142,6 +187,11 @@ class MockWebServer :
   ): RecordedRequest? = delegate.takeRequest(timeout, unit)?.unwrap()
 
   @JvmName("-deprecated_requestCount")
+  @Deprecated(
+    message = "moved to val",
+    replaceWith = ReplaceWith(expression = "requestCount"),
+    level = DeprecationLevel.ERROR,
+  )
   fun getRequestCount(): Int = delegate.requestCount
 
   fun enqueue(response: MockResponse) {
diff --git a/mockwebserver/api/mockwebserver3.api b/mockwebserver/api/mockwebserver3.api
index 119571dc3..0a0a9a58b 100644
--- a/mockwebserver/api/mockwebserver3.api
+++ b/mockwebserver/api/mockwebserver3.api
@@ -96,13 +96,12 @@ public final class mockwebserver3/MockWebServer : java/io/Closeable {
 	public final fun getBodyLimit ()J
 	public final fun getDispatcher ()Lmockwebserver3/Dispatcher;
 	public final fun getHostName ()Ljava/lang/String;
+	public final fun getInetSocketAddress ()Ljava/net/InetSocketAddress;
 	public final fun getPort ()I
 	public final fun getProtocolNegotiationEnabled ()Z
 	public final fun getProtocols ()Ljava/util/List;
-	public final fun getProxyAddress ()Ljava/net/Proxy;
 	public final fun getRequestCount ()I
 	public final fun getServerSocketFactory ()Ljavax/net/ServerSocketFactory;
-	public final fun getSocketAddress ()Ljava/net/InetSocketAddress;
 	public final fun getStarted ()Z
 	public final fun noClientAuth ()V
 	public final fun requestClientAuth ()V
@@ -112,12 +111,14 @@ public final class mockwebserver3/MockWebServer : java/io/Closeable {
 	public final fun setProtocolNegotiationEnabled (Z)V
 	public final fun setProtocols (Ljava/util/List;)V
 	public final fun setServerSocketFactory (Ljavax/net/ServerSocketFactory;)V
+	public final fun setStarted (Z)V
 	public final fun start ()V
 	public final fun start (I)V
 	public final fun start (Ljava/net/InetAddress;I)V
 	public static synthetic fun start$default (Lmockwebserver3/MockWebServer;IILjava/lang/Object;)V
 	public final fun takeRequest ()Lmockwebserver3/RecordedRequest;
 	public final fun takeRequest (JLjava/util/concurrent/TimeUnit;)Lmockwebserver3/RecordedRequest;
+	public final fun toProxyAddress ()Ljava/net/Proxy;
 	public fun toString ()Ljava/lang/String;
 	public final fun url (Ljava/lang/String;)Lokhttp3/HttpUrl;
 	public final fun useHttps (Ljavax/net/ssl/SSLSocketFactory;)V
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt b/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
index c63d01e2f..b277e5dab 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
@@ -18,7 +18,6 @@
   "CANNOT_OVERRIDE_INVISIBLE_MEMBER",
   "INVISIBLE_MEMBER",
   "INVISIBLE_REFERENCE",
-  "ktlint:standard:property-naming",
 )
 
 package mockwebserver3
@@ -119,17 +118,6 @@ public class MockWebServer : Closeable {
 
   private val atomicRequestCount = AtomicInteger()
 
-  private var serverSocketFactory_: ServerSocketFactory? = null
-  private var serverSocket: ServerSocket? = null
-
-  /** Non-null after [start]. */
-  private var socketAddress_: InetSocketAddress? = null
-
-  private var sslSocketFactory: SSLSocketFactory? = null
-  private var clientAuth = CLIENT_AUTH_NONE
-
-  private var closed: Boolean = false
-
   /**
    * The number of HTTP requests received thus far by this server. This may exceed the number of
    * HTTP connections when connection reuse is in practice.
@@ -140,14 +128,23 @@ public class MockWebServer : Closeable {
   /** The number of bytes of the POST body to keep in memory to the given limit. */
   public var bodyLimit: Long = Long.MAX_VALUE
 
-  public var serverSocketFactory: ServerSocketFactory?
-    @Synchronized get() = serverSocketFactory_
+  public var serverSocketFactory: ServerSocketFactory? = null
+    @Synchronized get() {
+      if (field == null && started) {
+        field = ServerSocketFactory.getDefault() // Build the default value lazily.
+      }
+      return field
+    }
 
     @Synchronized set(value) {
-      check(socketAddress_ == null) { "serverSocketFactory must not be set after start()" }
-      serverSocketFactory_ = value
+      check(!started) { "serverSocketFactory must not be set after start()" }
+      field = value
     }
 
+  private var serverSocket: ServerSocket? = null
+  private var sslSocketFactory: SSLSocketFactory? = null
+  private var clientAuth = CLIENT_AUTH_NONE
+
   /**
    * The dispatcher used to respond to HTTP requests. The default dispatcher is a [QueueDispatcher],
    * which serves a fixed sequence of responses from a [queue][enqueue].
@@ -157,18 +154,26 @@ public class MockWebServer : Closeable {
    */
   public var dispatcher: Dispatcher = QueueDispatcher()
 
-  public val socketAddress: InetSocketAddress
-    get() = socketAddress_ ?: error("call start() first")
-
+  private var portField: Int = -1
   public val port: Int
-    get() = socketAddress.port
+    get() {
+      before()
+      return portField
+    }
 
   public val hostName: String
-    get() = socketAddress.address.hostName
+    get() {
+      before()
+      return _inetSocketAddress!!.address.hostName
+    }
+
+  private var _inetSocketAddress: InetSocketAddress? = null
 
-  /** Returns the address of this server, to connect to it as an HTTP proxy. */
-  public val proxyAddress: Proxy
-    get() = Proxy(Proxy.Type.HTTP, socketAddress)
+  public val inetSocketAddress: InetSocketAddress
+    get() {
+      before()
+      return InetSocketAddress(hostName, portField)
+    }
 
   /**
    * True if ALPN is used on incoming HTTPS connections to negotiate a protocol like HTTP/1.1 or
@@ -196,8 +201,23 @@ public class MockWebServer : Closeable {
       field = protocolList
     }
 
-  public val started: Boolean
-    get() = socketAddress_ != null
+  public var started: Boolean = false
+  private var closed: Boolean = false
+
+  @Synchronized private fun before() {
+    if (started) return // Don't call start() in case we're already shut down.
+    try {
+      start()
+    } catch (e: IOException) {
+      throw RuntimeException(e)
+    }
+  }
+
+  public fun toProxyAddress(): Proxy {
+    before()
+    val address = InetSocketAddress(_inetSocketAddress!!.address.hostName, port)
+    return Proxy(Proxy.Type.HTTP, address)
+  }
 
   /**
    * Returns a URL for connecting to this server.
@@ -317,46 +337,26 @@ public class MockWebServer : Closeable {
   /**
    * Starts the server and binds to the given socket address.
    *
-   * @param socketAddress the socket address to bind the server on
+   * @param inetSocketAddress the socket address to bind the server on
    */
   @Synchronized
   @Throws(IOException::class)
-  private fun start(socketAddress: InetSocketAddress) {
+  private fun start(inetSocketAddress: InetSocketAddress) {
     check(!closed) { "shutdown() already called" }
+    if (started) return
+    started = true
 
-    val alreadyStartedAddress = socketAddress_
-    if (alreadyStartedAddress != null) {
-      check(socketAddress.address == alreadyStartedAddress.address) {
-        "unexpected address"
-      }
-      check(socketAddress.port == 0 || socketAddress.port == alreadyStartedAddress.port) {
-        "unexpected port"
-      }
-      return // Already started.
-    }
+    this._inetSocketAddress = inetSocketAddress
 
-    var boundSocketAddress = socketAddress
-    try {
-      val serverSocketFactory =
-        serverSocketFactory_
-          ?: (ServerSocketFactory.getDefault()!!.also { this.serverSocketFactory_ = it })
+    serverSocket = serverSocketFactory!!.createServerSocket()
 
-      val serverSocket =
-        serverSocketFactory
-          .createServerSocket()!!
-          .also { this.serverSocket = it }
+    // Reuse if the user specified a port
+    serverSocket!!.reuseAddress = inetSocketAddress.port != 0
+    serverSocket!!.bind(inetSocketAddress, 50)
 
-      // Reuse if the user specified a port
-      serverSocket.reuseAddress = socketAddress.port != 0
-      serverSocket.bind(socketAddress, 50)
+    portField = serverSocket!!.localPort
 
-      // If the local port was 0, it'll be non-zero after bind().
-      boundSocketAddress = InetSocketAddress(boundSocketAddress.address, serverSocket.localPort)
-    } finally {
-      this.socketAddress_ = boundSocketAddress
-    }
-
-    taskRunner.newQueue().execute(toString(), cancelable = false) {
+    taskRunner.newQueue().execute("MockWebServer $portField", cancelable = false) {
       try {
         logger.fine("$this starting to accept connections")
         acceptConnections()
@@ -933,14 +933,7 @@ public class MockWebServer : Closeable {
     check(line.isEmpty()) { "Expected empty but was: $line" }
   }
 
-  public override fun toString(): String {
-    val socketAddress = socketAddress_
-    return when {
-      closed -> "MockWebServer{closed}"
-      socketAddress != null -> "MockWebServer{port=${socketAddress.port}}"
-      else -> "MockWebServer{new}"
-    }
-  }
+  public override fun toString(): String = "MockWebServer[$portField]"
 
   /** A buffer wrapper that drops data after [bodyLimit] bytes. */
   private class TruncatingBuffer(
diff --git a/mockwebserver/src/test/java/mockwebserver3/MockResponseSniTest.kt b/mockwebserver/src/test/java/mockwebserver3/MockResponseSniTest.kt
index 8f088f1e9..4db63dffc 100644
--- a/mockwebserver/src/test/java/mockwebserver3/MockResponseSniTest.kt
+++ b/mockwebserver/src/test/java/mockwebserver3/MockResponseSniTest.kt
@@ -194,7 +194,7 @@ class MockResponseSniTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .build()
 
     server.enqueue(
diff --git a/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.kt b/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.kt
index f968d08c7..1fe0f0f82 100644
--- a/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.kt
+++ b/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.kt
@@ -32,7 +32,6 @@ import java.io.IOException
 import java.io.InputStreamReader
 import java.net.ConnectException
 import java.net.HttpURLConnection
-import java.net.InetAddress
 import java.net.ProtocolException
 import java.net.SocketTimeoutException
 import java.nio.charset.StandardCharsets.UTF_8
@@ -489,88 +488,25 @@ class MockWebServerTest {
   }
 
   @Test
-  fun portValidAfterStart() {
+  fun portImplicitlyStarts() {
     assertThat(server.port).isGreaterThan(0)
   }
 
   @Test
-  fun hostNameValidAfterStart() {
+  fun hostnameImplicitlyStarts() {
     assertThat(server.hostName).isNotNull()
   }
 
   @Test
-  fun proxyAddressValidAfterStart() {
-    assertThat(server.proxyAddress).isNotNull()
+  fun toProxyAddressImplicitlyStarts() {
+    assertThat(server.toProxyAddress()).isNotNull()
   }
 
   @Test
   fun differentInstancesGetDifferentPorts() {
     val other = MockWebServer()
-    other.use {
-      other.start()
-      assertThat(other.port).isNotEqualTo(server.port)
-    }
-  }
-
-  @Test
-  fun cannotAccessAddressBeforeStart() {
-    val other = MockWebServer()
-    assertFailsWith<IllegalStateException> {
-      other.socketAddress
-    }
-    assertFailsWith<IllegalStateException> {
-      other.hostName
-    }
-    assertFailsWith<IllegalStateException> {
-      other.port
-    }
-    assertFailsWith<IllegalStateException> {
-      other.proxyAddress
-    }
-    other.use {
-      other.start()
-      assertThat(other.socketAddress).isNotNull()
-      assertThat(other.hostName).isNotNull()
-      assertThat(other.port).isNotNull()
-      assertThat(other.proxyAddress).isNotNull()
-    }
-  }
-
-  @Test
-  fun startIsIdempotentIfAddressIsConsistent() {
-    val other = MockWebServer()
-    val addressA = InetAddress.getByAddress("localhost", byteArrayOf(127, 0, 0, 1))
-    val addressB = InetAddress.getByAddress("localhost", byteArrayOf(127, 0, 0, 2))
-    other.use {
-      other.start(addressA, 0)
-
-      // Same address is okay.
-      other.start(addressA, 0)
-
-      // Same address with bound port is okay.
-      other.start(addressA, other.port)
-
-      // Different address is not okay.
-      assertFailsWith<IllegalStateException> {
-        other.start(addressB, 0)
-      }
-
-      // Different port is not okay.
-      assertFailsWith<IllegalStateException> {
-        other.start(addressA, other.port - 1)
-      }
-    }
-  }
-
-  @Test
-  fun toStringIncludesLifecycleState() {
-    val other = MockWebServer()
-    assertThat(other.toString()).isEqualTo("MockWebServer{new}")
-    other.use {
-      other.start()
-      assertThat(other.toString()).isEqualTo("MockWebServer{port=${other.port}}")
-    }
-    assertThat(other.toString()).isEqualTo("MockWebServer{closed}")
+    assertThat(other.port).isNotEqualTo(server.port)
+    other.close()
   }
 
   @Test
@@ -578,8 +514,11 @@ class MockWebServerTest {
     // Enqueue a request that'll cause MockWebServer to hang on QueueDispatcher.dispatch().
     val connection = server.url("/").toUrl().openConnection() as HttpURLConnection
     connection.readTimeout = 500
-    assertFailsWith<SocketTimeoutException> {
+    try {
       connection.responseCode
+      fail<Unit>()
+    } catch (expected: SocketTimeoutException) {
+      // Expected.
     }
 
     // Closing the server should unblock the dispatcher.
@@ -809,7 +748,7 @@ class MockWebServerTest {
     val proxiedClient =
       OkHttpClient
         .Builder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .readTimeout(Duration.ofMillis(100))
         .build()
     val request = Request.Builder().url("http://android.com/").build()
@@ -833,8 +772,11 @@ class MockWebServerTest {
     val server2 = MockWebServer()
     server2.start()
     server2.close()
-    assertFailsWith<IllegalStateException> {
+    try {
       server2.start()
+      fail<Unit>()
+    } catch (expected: IllegalStateException) {
+      // Expected.
     }
     server2.close()
   }
diff --git a/okhttp/src/jvmTest/kotlin/okhttp3/CallTest.kt b/okhttp/src/jvmTest/kotlin/okhttp3/CallTest.kt
index 9dc8dbf39..74db985cc 100644
--- a/okhttp/src/jvmTest/kotlin/okhttp3/CallTest.kt
+++ b/okhttp/src/jvmTest/kotlin/okhttp3/CallTest.kt
@@ -877,21 +877,21 @@ open class CallTest {
       OkHttpClient
         .Builder()
         .connectionPool(client.connectionPool)
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
     executeSynchronously("/a").assertBody("abc")
     client =
       OkHttpClient
         .Builder()
         .connectionPool(client.connectionPool)
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
     executeSynchronously("/b").assertBody("def")
     client =
       OkHttpClient
         .Builder()
         .connectionPool(client.connectionPool)
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
     executeSynchronously("/c").assertBody("ghi")
     assertThat(server.takeRequest().sequenceNumber).isEqualTo(0)
@@ -904,7 +904,7 @@ open class CallTest {
     client =
       OkHttpClient
         .Builder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
     server.enqueue(MockResponse(body = "abc"))
     server.enqueue(MockResponse(body = "def"))
@@ -1039,7 +1039,7 @@ open class CallTest {
   fun connectTimeoutsAttemptsAlternateRoute() {
     val proxySelector = RecordingProxySelector()
     proxySelector.proxies.add(Proxy(Proxy.Type.HTTP, TestUtil.UNREACHABLE_ADDRESS_IPV4))
-    proxySelector.proxies.add(server.proxyAddress)
+    proxySelector.proxies.add(server.toProxyAddress())
     server.enqueue(MockResponse(body = "success!"))
     client =
       client
@@ -1121,8 +1121,8 @@ open class CallTest {
       MockResponse(body = "success!"),
     )
     val proxySelector = RecordingProxySelector()
-    proxySelector.proxies.add(server.proxyAddress)
-    proxySelector.proxies.add(server2.proxyAddress)
+    proxySelector.proxies.add(server.toProxyAddress())
+    proxySelector.proxies.add(server2.toProxyAddress())
     client =
       client
         .newBuilder()
@@ -3660,7 +3660,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .hostnameVerifier(hostnameVerifier)
         .build()
     val request =
@@ -3706,7 +3706,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .hostnameVerifier(hostnameVerifier)
         .build()
     val request = Request("https://android.com/foo".toHttpUrl())
@@ -3744,7 +3744,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .proxyAuthenticator(RecordingOkAuthenticator("password", "Basic"))
         .hostnameVerifier(RecordingHostnameVerifier())
         .build()
@@ -3777,7 +3777,7 @@ open class CallTest {
     client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .proxyAuthenticator(RecordingOkAuthenticator("password", "Basic"))
         .build()
     val request = Request("http://android.com/foo".toHttpUrl())
@@ -3828,7 +3828,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .proxyAuthenticator(RecordingOkAuthenticator("password", "Basic"))
         .hostnameVerifier(RecordingHostnameVerifier())
         .build()
@@ -3872,7 +3872,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .proxyAuthenticator(RecordingOkAuthenticator("password", "Basic"))
         .hostnameVerifier(RecordingHostnameVerifier())
         .build()
@@ -3903,7 +3903,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .hostnameVerifier(RecordingHostnameVerifier())
         .build()
     val request =
@@ -3938,7 +3938,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .hostnameVerifier(RecordingHostnameVerifier())
         .proxyAuthenticator { _: Route?, response: Response? ->
           assertThat(response!!.request.method).isEqualTo("CONNECT")
@@ -3990,7 +3990,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .hostnameVerifier(RecordingHostnameVerifier())
         .proxyAuthenticator { _: Route?, response: Response ->
           val challenges = response.challenges()
@@ -4029,7 +4029,7 @@ open class CallTest {
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
-        ).proxy(server.proxyAddress)
+        ).proxy(server.toProxyAddress())
         .build()
     val request = Request(server.url("/"))
     assertFailsWith<IOException> {
@@ -4174,7 +4174,7 @@ open class CallTest {
         .newBuilder()
         .proxySelector(
           FakeProxySelector()
-            .addProxy(server2.proxyAddress)
+            .addProxy(server2.toProxyAddress())
             .addProxy(Proxy.NO_PROXY),
         ).build()
     server2.close()
@@ -4443,7 +4443,7 @@ open class CallTest {
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
         ).hostnameVerifier(RecordingHostnameVerifier())
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
   }
 
diff --git a/okhttp/src/jvmTest/kotlin/okhttp3/ConnectionListenerTest.kt b/okhttp/src/jvmTest/kotlin/okhttp3/ConnectionListenerTest.kt
index 6df76e29f..6ba4f19d0 100644
--- a/okhttp/src/jvmTest/kotlin/okhttp3/ConnectionListenerTest.kt
+++ b/okhttp/src/jvmTest/kotlin/okhttp3/ConnectionListenerTest.kt
@@ -312,7 +312,7 @@ open class ConnectionListenerTest {
   @Throws(IOException::class)
   fun successfulHttpProxyConnect() {
     server!!.enqueue(MockResponse())
-    val proxy = server!!.proxyAddress
+    val proxy = server!!.toProxyAddress()
     client =
       client
         .newBuilder()
diff --git a/okhttp/src/jvmTest/kotlin/okhttp3/EventListenerTest.kt b/okhttp/src/jvmTest/kotlin/okhttp3/EventListenerTest.kt
index e7870fd50..491ebebbc 100644
--- a/okhttp/src/jvmTest/kotlin/okhttp3/EventListenerTest.kt
+++ b/okhttp/src/jvmTest/kotlin/okhttp3/EventListenerTest.kt
@@ -916,7 +916,7 @@ class EventListenerTest {
     client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
     val call =
       client.newCall(
@@ -935,7 +935,7 @@ class EventListenerTest {
     assertThat(connectStart.call).isSameAs(call)
     assertThat(connectStart.inetSocketAddress).isEqualTo(expectedAddress)
     assertThat(connectStart.proxy).isEqualTo(
-      server.proxyAddress,
+      server.toProxyAddress(),
     )
     val connectEnd = listener.removeUpToEvent<CallEvent.ConnectEnd>()
     assertThat(connectEnd.call).isSameAs(call)
@@ -1001,7 +1001,7 @@ class EventListenerTest {
     client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .proxyAuthenticator(RecordingOkAuthenticator("password", "Basic"))
         .build()
     val call =
@@ -1081,7 +1081,7 @@ class EventListenerTest {
     client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
     val call =
       client.newCall(
@@ -1890,7 +1890,6 @@ class EventListenerTest {
   @Test
   fun redirectUsingNewConnectionEventSequence() {
     val otherServer = MockWebServer()
-    otherServer.start()
     server.enqueue(
       MockResponse
         .Builder()
@@ -1938,7 +1937,6 @@ class EventListenerTest {
     assertThat(listener.findEvent<FollowUpDecision>()).all {
       prop(FollowUpDecision::nextRequest).isNotNull()
     }
-    otherServer.close()
   }
 
   @Test
diff --git a/okhttp/src/jvmTest/kotlin/okhttp3/RouteFailureTest.kt b/okhttp/src/jvmTest/kotlin/okhttp3/RouteFailureTest.kt
index a2b852f68..00ab9ee06 100644
--- a/okhttp/src/jvmTest/kotlin/okhttp3/RouteFailureTest.kt
+++ b/okhttp/src/jvmTest/kotlin/okhttp3/RouteFailureTest.kt
@@ -94,8 +94,8 @@ class RouteFailureTest {
     server2.enqueue(bodyResponse)
 
     dns[server1.hostName] = listOf(ipv6, ipv4)
-    socketFactory[ipv6] = server1.socketAddress
-    socketFactory[ipv4] = server2.socketAddress
+    socketFactory[ipv6] = server1.inetSocketAddress
+    socketFactory[ipv4] = server2.inetSocketAddress
 
     client =
       client
@@ -131,8 +131,8 @@ class RouteFailureTest {
     server2.enqueue(bodyResponse)
 
     dns[server1.hostName] = listOf(ipv6, ipv4)
-    socketFactory[ipv6] = server1.socketAddress
-    socketFactory[ipv4] = server2.socketAddress
+    socketFactory[ipv6] = server1.inetSocketAddress
+    socketFactory[ipv4] = server2.inetSocketAddress
 
     client =
       client
@@ -174,8 +174,8 @@ class RouteFailureTest {
     server2.enqueue(bodyResponse)
 
     dns[server1.hostName] = listOf(ipv6, ipv4)
-    socketFactory[ipv6] = server1.socketAddress
-    socketFactory[ipv4] = server2.socketAddress
+    socketFactory[ipv6] = server1.inetSocketAddress
+    socketFactory[ipv4] = server2.inetSocketAddress
 
     client =
       client
@@ -211,8 +211,8 @@ class RouteFailureTest {
     server2.enqueue(bodyResponse)
 
     dns[server1.hostName] = listOf(ipv6, ipv4)
-    socketFactory[ipv6] = server1.socketAddress
-    socketFactory[ipv4] = server2.socketAddress
+    socketFactory[ipv6] = server1.inetSocketAddress
+    socketFactory[ipv4] = server2.inetSocketAddress
 
     client =
       client
@@ -254,7 +254,7 @@ class RouteFailureTest {
     server1.enqueue(refusedStream)
 
     dns[server1.hostName] = listOf(ipv6)
-    socketFactory[ipv6] = server1.socketAddress
+    socketFactory[ipv6] = server1.inetSocketAddress
 
     client =
       client
@@ -288,7 +288,7 @@ class RouteFailureTest {
     server1.enqueue(refusedStream)
 
     dns[server1.hostName] = listOf(ipv6)
-    socketFactory[ipv6] = server1.socketAddress
+    socketFactory[ipv6] = server1.inetSocketAddress
 
     client =
       client
@@ -324,13 +324,13 @@ class RouteFailureTest {
     val proxyServer1 = InetAddress.getByAddress("proxyServer1", byteArrayOf(127, 0, 0, 2))
     val proxyServer2 = InetAddress.getByAddress("proxyServer2", byteArrayOf(127, 0, 0, 3))
 
-    println("Proxy Server 1 is ${server1.socketAddress}")
-    println("Proxy Server 2 is ${server2.socketAddress}")
+    println("Proxy Server 1 is ${server1.inetSocketAddress}")
+    println("Proxy Server 2 is ${server2.inetSocketAddress}")
 
     // Since myproxy:8008 won't resolve, redirect with DNS to proxyServer1
     // Then redirect socket connection to server1
     dns["myproxy"] = listOf(proxyServer1)
-    socketFactory[proxyServer1] = server1.socketAddress
+    socketFactory[proxyServer1] = server1.inetSocketAddress
 
     client = client.newBuilder().proxySelector(proxySelector).build()
 
@@ -340,7 +340,7 @@ class RouteFailureTest {
     server2.enqueue(MockResponse(200))
     server2.enqueue(MockResponse(200))
 
-    println("\n\nRequest to ${server1.socketAddress}")
+    println("\n\nRequest to ${server1.inetSocketAddress}")
     executeSynchronously(request)
       .assertSuccessful()
       .assertCode(200)
@@ -356,9 +356,9 @@ class RouteFailureTest {
     // Now redirect with DNS to proxyServer2
     // Then redirect socket connection to server2
     dns["myproxy"] = listOf(proxyServer2)
-    socketFactory[proxyServer2] = server2.socketAddress
+    socketFactory[proxyServer2] = server2.inetSocketAddress
 
-    println("\n\nRequest to ${server2.socketAddress}")
+    println("\n\nRequest to ${server2.inetSocketAddress}")
     executeSynchronously(request)
       .apply {
         // We may have a single failed request if not clean shutdown
@@ -372,7 +372,7 @@ class RouteFailureTest {
         }
       }
 
-    println("\n\nRequest to ${server2.socketAddress}")
+    println("\n\nRequest to ${server2.inetSocketAddress}")
     executeSynchronously(request)
       .assertSuccessful()
       .assertCode(200)
diff --git a/okhttp/src/jvmTest/kotlin/okhttp3/URLConnectionTest.kt b/okhttp/src/jvmTest/kotlin/okhttp3/URLConnectionTest.kt
index 649bc6c19..67d9e9dc8 100644
--- a/okhttp/src/jvmTest/kotlin/okhttp3/URLConnectionTest.kt
+++ b/okhttp/src/jvmTest/kotlin/okhttp3/URLConnectionTest.kt
@@ -298,7 +298,7 @@ class URLConnectionTest {
         .newBuilder()
         .proxySelector(
           FakeProxySelector()
-            .addProxy(server2.proxyAddress)
+            .addProxy(server2.toProxyAddress())
             .addProxy(Proxy.NO_PROXY),
         ).build()
     server2.close()
@@ -1028,7 +1028,7 @@ class URLConnectionTest {
           handshakeCertificates.trustManager,
         ).connectionSpecs(listOf(ConnectionSpec.MODERN_TLS))
         .hostnameVerifier(RecordingHostnameVerifier())
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
     val response =
       getResponse(
@@ -1069,7 +1069,7 @@ class URLConnectionTest {
     client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
@@ -1120,7 +1120,7 @@ class URLConnectionTest {
       client
         .newBuilder()
         .proxyAuthenticator(Authenticator.JAVA_NET_AUTHENTICATOR)
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
@@ -1161,7 +1161,7 @@ class URLConnectionTest {
     client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .sslSocketFactory(
           handshakeCertificates.sslSocketFactory(),
           handshakeCertificates.trustManager,
@@ -1194,7 +1194,7 @@ class URLConnectionTest {
     client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .sslSocketFactory(socketFactory, handshakeCertificates.trustManager)
         .hostnameVerifier(hostnameVerifier)
         .build()
@@ -1215,7 +1215,7 @@ class URLConnectionTest {
         .newBuilder()
         .proxySelector(
           object : ProxySelector() {
-            override fun select(uri: URI): List<Proxy> = listOf(server.proxyAddress)
+            override fun select(uri: URI): List<Proxy> = listOf(server.toProxyAddress())
 
             override fun connectFailed(
               uri: URI,
@@ -1887,7 +1887,7 @@ class URLConnectionTest {
       client =
         client
           .newBuilder()
-          .proxy(server.proxyAddress)
+          .proxy(server.toProxyAddress())
           .proxyAuthenticator(JavaNetAuthenticator())
           .build()
       response = getResponse(Request("http://android.com/".toHttpUrl()))
@@ -2540,7 +2540,7 @@ class URLConnectionTest {
             override fun select(uri: URI): List<Proxy> {
               proxySelectionRequests.add(uri)
               val proxyServer = if (uri.port == server.port) server else server2
-              return listOf(proxyServer.proxyAddress)
+              return listOf(proxyServer.toProxyAddress())
             }
 
             override fun connectFailed(
@@ -4396,7 +4396,7 @@ class URLConnectionTest {
       ): Call.Factory =
         client
           .newBuilder()
-          .proxy(server.proxyAddress)
+          .proxy(server.toProxyAddress())
           .build()
     },
     PROXY_SYSTEM_PROPERTY {
diff --git a/okhttp/src/jvmTest/kotlin/okhttp3/WholeOperationTimeoutTest.kt b/okhttp/src/jvmTest/kotlin/okhttp3/WholeOperationTimeoutTest.kt
index 90e72d712..8169fb709 100644
--- a/okhttp/src/jvmTest/kotlin/okhttp3/WholeOperationTimeoutTest.kt
+++ b/okhttp/src/jvmTest/kotlin/okhttp3/WholeOperationTimeoutTest.kt
@@ -340,7 +340,6 @@ class WholeOperationTimeoutTest {
   @Test
   fun timeoutFollowingRedirectOnNewConnection() {
     val otherServer = MockWebServer()
-    otherServer.start()
     server.enqueue(
       MockResponse
         .Builder()
diff --git a/okhttp/src/jvmTest/kotlin/okhttp3/internal/http2/HttpOverHttp2Test.kt b/okhttp/src/jvmTest/kotlin/okhttp3/internal/http2/HttpOverHttp2Test.kt
index 8c453f6e5..aa2ff0b8a 100644
--- a/okhttp/src/jvmTest/kotlin/okhttp3/internal/http2/HttpOverHttp2Test.kt
+++ b/okhttp/src/jvmTest/kotlin/okhttp3/internal/http2/HttpOverHttp2Test.kt
@@ -2145,7 +2145,7 @@ class HttpOverHttp2Test {
     client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
     val call1 = client.newCall(Request("https://android.com/call1".toHttpUrl()))
     val response2 = call1.execute()
@@ -2334,7 +2334,7 @@ class HttpOverHttp2Test {
     val client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .build()
 
     val url = server.url("/").resolve("//android.com/foo")!!
@@ -2387,7 +2387,7 @@ class HttpOverHttp2Test {
     val client =
       client
         .newBuilder()
-        .proxy(server.proxyAddress)
+        .proxy(server.toProxyAddress())
         .proxyAuthenticator(RecordingOkAuthenticator("password", "Basic"))
         .build()
 
