diff --git a/ktor-server/ktor-server-core/api/ktor-server-core.api b/ktor-server/ktor-server-core/api/ktor-server-core.api
index 70e212431..f441f403c 100644
--- a/ktor-server/ktor-server-core/api/ktor-server-core.api
+++ b/ktor-server/ktor-server-core/api/ktor-server-core.api
@@ -737,8 +737,10 @@ public abstract interface class io/ktor/server/engine/EngineSSLConnectorConfig :
 
 public final class io/ktor/server/engine/ShutDownUrl {
 	public static final field Companion Lio/ktor/server/engine/ShutDownUrl$Companion;
-	public fun <init> (Ljava/lang/String;Lkotlin/jvm/functions/Function1;)V
+	public fun <init> (Ljava/lang/String;Lkotlin/jvm/functions/Function1;Lkotlin/jvm/functions/Function1;)V
+	public synthetic fun <init> (Ljava/lang/String;Lkotlin/jvm/functions/Function1;Lkotlin/jvm/functions/Function1;ILkotlin/jvm/internal/DefaultConstructorMarker;)V
 	public final fun doShutdown (Lio/ktor/server/application/ApplicationCall;Lkotlin/coroutines/Continuation;)Ljava/lang/Object;
+	public final fun getExit ()Lkotlin/jvm/functions/Function1;
 	public final fun getExitCode ()Lkotlin/jvm/functions/Function1;
 	public final fun getUrl ()Ljava/lang/String;
 }
@@ -749,8 +751,10 @@ public final class io/ktor/server/engine/ShutDownUrl$Companion {
 
 public final class io/ktor/server/engine/ShutDownUrl$Config {
 	public fun <init> ()V
+	public final fun getExit ()Lkotlin/jvm/functions/Function1;
 	public final fun getExitCodeSupplier ()Lkotlin/jvm/functions/Function1;
 	public final fun getShutDownUrl ()Ljava/lang/String;
+	public final fun setExit (Lkotlin/jvm/functions/Function1;)V
 	public final fun setExitCodeSupplier (Lkotlin/jvm/functions/Function1;)V
 	public final fun setShutDownUrl (Ljava/lang/String;)V
 }
diff --git a/ktor-server/ktor-server-core/jvm/src/io/ktor/server/engine/ShutDownUrl.kt b/ktor-server/ktor-server-core/jvm/src/io/ktor/server/engine/ShutDownUrl.kt
index 7917e262a..c70c87f02 100644
--- a/ktor-server/ktor-server-core/jvm/src/io/ktor/server/engine/ShutDownUrl.kt
+++ b/ktor-server/ktor-server-core/jvm/src/io/ktor/server/engine/ShutDownUrl.kt
@@ -24,8 +24,13 @@ import kotlin.system.*
  *
  * @property url to handle
  * @property exitCode is a function to compute a process exit code
+ * @property exit the function for exiting the process; defaults to the system function [exitProcess]
  */
-public class ShutDownUrl(public val url: String, public val exitCode: ApplicationCall.() -> Int) {
+public class ShutDownUrl(
+    public val url: String,
+    public val exitCode: ApplicationCall.() -> Int,
+    public val exit: (Int) -> Unit = ::exitProcess
+) {
     /**
      * Shuts down an application using the specified [call].
      *
@@ -33,19 +38,27 @@ public class ShutDownUrl(public val url: String, public val exitCode: Applicatio
      */
     @OptIn(InternalAPI::class)
     public suspend fun doShutdown(call: ApplicationCall) {
-        call.application.log.warn("Shutdown URL was called: server is going down")
         val application = call.application
+        val log = application.log
         val environment = application.environment
-        val exitCode = exitCode(call)
+        log.warn("Shutdown URL was called: server is going down")
 
         val latch = CompletableDeferred<Nothing>()
-        call.application.launch {
-            latch.join()
 
-            application.monitor.raise(ApplicationStopPreparing, environment)
-            application.disposeAndJoin()
+        // Launch in an independent scope,
+        // so it may outlive the application for process shutdown
+        CoroutineScope(Dispatchers.Default).launch {
+            try {
+                latch.join()
 
-            exitProcess(exitCode)
+                application.monitor.raise(ApplicationStopPreparing, environment)
+                application.disposeAndJoin()
+
+                exit(this@ShutDownUrl.exitCode(call))
+            } catch (e: Exception) {
+                log.error("Exception occurred during shutdown!", e)
+                exit(1)
+            }
         }
 
         try {
@@ -98,6 +111,11 @@ public class ShutDownUrl(public val url: String, public val exitCode: Applicatio
          * [Report a problem](https://ktor.io/feedback/?fqname=io.ktor.server.engine.ShutDownUrl.Config.exitCodeSupplier)
          */
         public var exitCodeSupplier: ApplicationCall.() -> Int = { 0 }
+
+        /**
+         * Internal config item for testing shutdown.
+         */
+        public var exit: (Int) -> Unit = ::exitProcess
     }
 
     public companion object {
@@ -109,7 +127,11 @@ public class ShutDownUrl(public val url: String, public val exitCode: Applicatio
          */
         public val ApplicationCallPlugin: BaseApplicationPlugin<Application, Config, PluginInstance> =
             createApplicationPlugin("shutdown.url", ::Config) {
-                val plugin = ShutDownUrl(pluginConfig.shutDownUrl, pluginConfig.exitCodeSupplier)
+                val plugin = ShutDownUrl(
+                    pluginConfig.shutDownUrl,
+                    pluginConfig.exitCodeSupplier,
+                    pluginConfig.exit
+                )
 
                 onCall { call ->
                     if (call.request.uri == plugin.url) {
