diff --git a/platforms/software/dependency-management/src/integTest/groovy/org/gradle/integtests/resolve/ProjectDependenciesIntegrationTest.groovy b/platforms/software/dependency-management/src/integTest/groovy/org/gradle/integtests/resolve/ProjectDependenciesIntegrationTest.groovy
index 5b92f94b4e0..f009fd74f35 100644
--- a/platforms/software/dependency-management/src/integTest/groovy/org/gradle/integtests/resolve/ProjectDependenciesIntegrationTest.groovy
+++ b/platforms/software/dependency-management/src/integTest/groovy/org/gradle/integtests/resolve/ProjectDependenciesIntegrationTest.groovy
@@ -100,6 +100,27 @@ class ProjectDependenciesIntegrationTest extends AbstractDependencyResolutionTes
         failureHasCause("Required keys [path] are missing from map")
     }
 
+    @Issue("https://github.com/gradle/gradle/issues/34692")
+    def "throws UnknownProjectException when creating project dependency from map with unknown project"() {
+        buildFile("""
+            configurations.dependencyScope("deps")
+            dependencies {
+                try {
+                    deps(project(path: "unknown"))
+                } catch (Exception e) {
+                    assert e instanceof UnknownProjectException
+                    throw e
+                }
+            }
+        """)
+
+        when:
+        fails("help")
+
+        then:
+        failure.assertHasCause("Project with path ':unknown' could not be found.")
+    }
+
     def "can add constraint on root project"() {
         given:
         mavenRepo.module("org", "foo").publish()
diff --git a/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/DefaultProjectDependencyFactory.java b/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/DefaultProjectDependencyFactory.java
index de85e690423..e500f8ba33e 100644
--- a/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/DefaultProjectDependencyFactory.java
+++ b/platforms/software/dependency-management/src/main/java/org/gradle/api/internal/artifacts/DefaultProjectDependencyFactory.java
@@ -16,6 +16,7 @@
 
 package org.gradle.api.internal.artifacts;
 
+import org.gradle.api.UnknownProjectException;
 import org.gradle.api.artifacts.ProjectDependency;
 import org.gradle.api.capabilities.Capability;
 import org.gradle.api.internal.artifacts.dependencies.DefaultProjectDependency;
@@ -59,7 +60,10 @@ public ProjectDependency create(ProjectState projectState) {
     }
 
     public ProjectDependency create(Path projectIdentityPath) {
-        ProjectState projectState = projectStateRegistry.stateFor(projectIdentityPath);
+        ProjectState projectState = projectStateRegistry.findProjectState(projectIdentityPath);
+        if (projectState == null) {
+            throw new UnknownProjectException(String.format("Project with path '%s' could not be found.", projectIdentityPath.getPath()));
+        }
         return create(projectState);
     }
 
diff --git a/subprojects/core/src/main/java/org/gradle/api/internal/project/DefaultProjectStateRegistry.java b/subprojects/core/src/main/java/org/gradle/api/internal/project/DefaultProjectStateRegistry.java
index f1dc6ecc88d..b575644ea68 100644
--- a/subprojects/core/src/main/java/org/gradle/api/internal/project/DefaultProjectStateRegistry.java
+++ b/subprojects/core/src/main/java/org/gradle/api/internal/project/DefaultProjectStateRegistry.java
@@ -157,6 +157,13 @@ public ProjectState stateFor(Path identityPath) {
         }
     }
 
+    @Override
+    public @Nullable ProjectState findProjectState(Path identityPath) {
+        synchronized (lock) {
+            return projectsByPath.get(identityPath);
+        }
+    }
+
     @Override
     public BuildProjectRegistry projectsFor(BuildIdentifier buildIdentifier) throws IllegalArgumentException {
         synchronized (lock) {
diff --git a/subprojects/core/src/main/java/org/gradle/api/internal/project/ProjectStateRegistry.java b/subprojects/core/src/main/java/org/gradle/api/internal/project/ProjectStateRegistry.java
index a4b85b08fd4..2c39b5ab9cd 100644
--- a/subprojects/core/src/main/java/org/gradle/api/internal/project/ProjectStateRegistry.java
+++ b/subprojects/core/src/main/java/org/gradle/api/internal/project/ProjectStateRegistry.java
@@ -56,6 +56,11 @@ public interface ProjectStateRegistry {
      */
     ProjectState stateFor(Path identityPath) throws IllegalArgumentException;
 
+    /**
+     * Locates the state object that owns the project with the given identity path, or null if this project is not present.
+     */
+    @Nullable ProjectState findProjectState(Path identityPath);
+
     /**
      * Locates the state objects for all projects of the given build.
      */
