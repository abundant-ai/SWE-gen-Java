diff --git a/buildSrc/build.gradle.kts b/buildSrc/build.gradle.kts
index 2b398113e..4df27361f 100644
--- a/buildSrc/build.gradle.kts
+++ b/buildSrc/build.gradle.kts
@@ -42,7 +42,6 @@ dependencies {
     implementation(files(libs.javaClass.superclass.protectionDomain.codeSource.location))
 }
 
-// Should be synced with gradle/gradle-daemon-jvm.properties
 kotlin {
-    jvmToolchain(21)
+    jvmToolchain(8)
 }
diff --git a/buildSrc/src/main/kotlin/JvmConfig.kt b/buildSrc/src/main/kotlin/JvmConfig.kt
index 351345000..ca3b3d1f1 100644
--- a/buildSrc/src/main/kotlin/JvmConfig.kt
+++ b/buildSrc/src/main/kotlin/JvmConfig.kt
@@ -50,12 +50,11 @@ fun Project.configureJvm() {
         }
     }
 
-    val testJdk = project.testJdk
     val jvmTest = tasks.named<KotlinJvmTest>("jvmTest") {
         maxHeapSize = "2g"
         exclude("**/*StressTest*")
         useJUnitPlatform()
-        configureJavaToolchain(compileJdk, testJdk)
+        configureJavaToolchain(compileJdk)
     }
 
     tasks.register<Test>("stressTest") {
@@ -68,7 +67,7 @@ fun Project.configureJvm() {
         systemProperty("enable.stress.tests", "true")
         include("**/*StressTest*")
         useJUnitPlatform()
-        configureJavaToolchain(compileJdk, testJdk)
+        configureJavaToolchain(compileJdk)
     }
 
     val configuredVersion: String by rootProject.extra
@@ -84,14 +83,14 @@ fun Project.configureJvm() {
     }
 }
 
-/** Configure tests against different JDK versions. */
-private fun Test.configureJavaToolchain(compileJdk: Int, testJdk: Int) {
-    if (testJdk < compileJdk) {
-        enabled = false
-        return
-    }
-
+/**
+ * On local machine use for tests the JDK used for compilation.
+ * On CI use the default JDK.
+ */
+private fun Test.configureJavaToolchain(compileJdk: Int) {
+    val testJdk = if (CI) currentJdk else compileJdk
     val javaToolchains = project.the<JavaToolchainService>()
+
     javaLauncher = javaToolchains.launcherFor {
         languageVersion = JavaLanguageVersion.of(testJdk)
     }
diff --git a/buildSrc/src/main/kotlin/KtorBuildProperties.kt b/buildSrc/src/main/kotlin/KtorBuildProperties.kt
index 8450b18ac..38768aed4 100644
--- a/buildSrc/src/main/kotlin/KtorBuildProperties.kt
+++ b/buildSrc/src/main/kotlin/KtorBuildProperties.kt
@@ -16,24 +16,7 @@ val HOST_NAME = when {
     else -> error("Unknown os name `$OS_NAME`")
 }
 
-private var _testJdk = 0
-
-/**
- * Retrieves the JDK version for running tests.
- *
- * Takes the version from property "test.jdk" or uses Gradle JDK by default.
- * For example, to run tests against JDK 8, run test task with flag "-Ptest.jdk=8"
- * or put this property to `gradle.properties`.
- */
-val Project.testJdk: Int
-    get() {
-        if (_testJdk == 0) {
-            _testJdk = rootProject.properties["test.jdk"]?.toString()?.toInt()
-                ?: JavaVersion.current().majorVersion.toInt()
-            logger.info("Running tests against JDK $_testJdk")
-        }
-        return _testJdk
-    }
+val currentJdk = JavaVersion.current().majorVersion.toInt()
 
 val Project.requiredJdkVersion: Int
     get() = when {
diff --git a/buildSrc/src/main/kotlin/conventions.gradleDoctor.gradle.kts b/buildSrc/src/main/kotlin/conventions.gradleDoctor.gradle.kts
index ebb77fc43..8577c56b4 100644
--- a/buildSrc/src/main/kotlin/conventions.gradleDoctor.gradle.kts
+++ b/buildSrc/src/main/kotlin/conventions.gradleDoctor.gradle.kts
@@ -10,13 +10,6 @@ plugins {
 
 doctor {
     enableTestCaching = false
-
-    // Disable JAVA_HOME validation as we use "Daemon JVM discovery" feature
-    // https://docs.gradle.org/current/userguide/gradle_daemon.html#sec:daemon_jvm_criteria
-    javaHome {
-        ensureJavaHomeIsSet = false
-        ensureJavaHomeMatches = false
-    }
 }
 
 // Always monitor tasks on CI, but disable it locally by default with providing an option to opt-in.
diff --git a/buildSrc/src/main/kotlin/test/server/TestServer.kt b/buildSrc/src/main/kotlin/test/server/TestServer.kt
index e5e46d9fc..ac4e446b7 100644
--- a/buildSrc/src/main/kotlin/test/server/TestServer.kt
+++ b/buildSrc/src/main/kotlin/test/server/TestServer.kt
@@ -1,5 +1,5 @@
 /*
- * Copyright 2014-2024 JetBrains s.r.o and contributors. Use of this source code is governed by the Apache 2.0 license.
+ * Copyright 2014-2022 JetBrains s.r.o and contributors. Use of this source code is governed by the Apache 2.0 license.
  */
 
 package test.server
@@ -7,7 +7,7 @@ package test.server
 import io.ktor.network.tls.certificates.*
 import io.ktor.server.cio.*
 import io.ktor.server.engine.*
-import io.ktor.server.jetty.jakarta.*
+import io.ktor.server.jetty.*
 import test.server.tests.*
 import java.io.*
 import java.util.concurrent.*
diff --git a/gradle-settings-conventions/src/main/kotlin/conventions-dependency-resolution-management.settings.gradle.kts b/gradle-settings-conventions/src/main/kotlin/conventions-dependency-resolution-management.settings.gradle.kts
index 27985787d..363b6addf 100644
--- a/gradle-settings-conventions/src/main/kotlin/conventions-dependency-resolution-management.settings.gradle.kts
+++ b/gradle-settings-conventions/src/main/kotlin/conventions-dependency-resolution-management.settings.gradle.kts
@@ -88,7 +88,7 @@ dependencyResolutionManagement {
 }
 
 fun VersionCatalogBuilder.downgradeTestDependencies() {
-    val testJdk = providers.gradleProperty("test.jdk").orNull?.toInt() ?: return
+    val testJdk = JavaVersion.current().majorVersion.toInt()
 
     if (testJdk < 11) version("logback", "1.3.14") // Java 8 support dropped in Logback 1.4.x
 }
diff --git a/gradle/gradle-daemon-jvm.properties b/gradle/gradle-daemon-jvm.properties
deleted file mode 100644
index 63e5bbdf4..000000000
--- a/gradle/gradle-daemon-jvm.properties
+++ /dev/null
@@ -1,2 +0,0 @@
-#This file is generated by updateDaemonJvm
-toolchainVersion=21
diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
index 34e75a582..5c56517ba 100644
--- a/gradle/libs.versions.toml
+++ b/gradle/libs.versions.toml
@@ -99,7 +99,7 @@ ktor-server-compression = { module = "io.ktor:ktor-server-compression", version.
 ktor-server-conditional-headers = { module = "io.ktor:ktor-server-conditional-headers", version.ref = "ktor" }
 ktor-server-content-negotiation = { module = "io.ktor:ktor-server-content-negotiation", version.ref = "ktor" }
 ktor-server-default-headers = { module = "io.ktor:ktor-server-default-headers", version.ref = "ktor" }
-ktor-server-jetty = { module = "io.ktor:ktor-server-jetty-jakarta", version.ref = "ktor" }
+ktor-server-jetty = { module = "io.ktor:ktor-server-jetty", version.ref = "ktor" }
 ktor-server-netty = { module = "io.ktor:ktor-server-netty", version.ref = "ktor" }
 ktor-server-status-pages = { module = "io.ktor:ktor-server-status-pages", version.ref = "ktor" }
 ktor-server-websockets = { module = "io.ktor:ktor-server-websockets", version.ref = "ktor" }
diff --git a/ktor-client/ktor-client-tests/build.gradle.kts b/ktor-client/ktor-client-tests/build.gradle.kts
index cf6c91fdb..811f2d63e 100644
--- a/ktor-client/ktor-client-tests/build.gradle.kts
+++ b/ktor-client/ktor-client-tests/build.gradle.kts
@@ -58,7 +58,7 @@ kotlin.sourceSets {
             api(project(":ktor-client:ktor-client-apache5"))
             runtimeOnly(project(":ktor-client:ktor-client-android"))
             runtimeOnly(project(":ktor-client:ktor-client-okhttp"))
-            if (testJdk >= 11) {
+            if (currentJdk >= 11) {
                 runtimeOnly(project(":ktor-client:ktor-client-java"))
             }
             implementation(project(":ktor-client:ktor-client-plugins:ktor-client-logging"))
diff --git a/settings.gradle.kts b/settings.gradle.kts
index eb60c53a4..b80d5536b 100644
--- a/settings.gradle.kts
+++ b/settings.gradle.kts
@@ -24,12 +24,8 @@ include(":ktor-server:ktor-server-test-base")
 include(":ktor-server:ktor-server-test-suites")
 include(":ktor-server:ktor-server-jetty")
 include(":ktor-server:ktor-server-jetty:ktor-server-jetty-test-http2")
-include(":ktor-server:ktor-server-jetty-jakarta")
-include(":ktor-server:ktor-server-jetty-jakarta:ktor-server-jetty-test-http2-jakarta")
 include(":ktor-server:ktor-server-servlet")
-include(":ktor-server:ktor-server-servlet-jakarta")
 include(":ktor-server:ktor-server-tomcat")
-include(":ktor-server:ktor-server-tomcat-jakarta")
 include(":ktor-server:ktor-server-netty")
 include(":ktor-server:ktor-server-cio")
 include(":ktor-client")
@@ -44,9 +40,15 @@ include(":ktor-client:ktor-client-ios")
 include(":ktor-client:ktor-client-darwin")
 include(":ktor-client:ktor-client-darwin-legacy")
 include(":ktor-client:ktor-client-winhttp")
-include(":ktor-client:ktor-client-java")
+if (JavaVersion.current() >= JavaVersion.VERSION_11) {
+    include(":ktor-client:ktor-client-java")
+    include(":ktor-client:ktor-client-jetty-jakarta")
+    include(":ktor-server:ktor-server-servlet-jakarta")
+    include(":ktor-server:ktor-server-jetty-jakarta")
+    include(":ktor-server:ktor-server-jetty-jakarta:ktor-server-jetty-test-http2-jakarta")
+    include(":ktor-server:ktor-server-tomcat-jakarta")
+}
 include(":ktor-client:ktor-client-jetty")
-include(":ktor-client:ktor-client-jetty-jakarta")
 include(":ktor-client:ktor-client-js")
 include(":ktor-client:ktor-client-mock")
 include(":ktor-client:ktor-client-okhttp")
