diff --git a/okhttp/api/okhttp.api b/okhttp/api/okhttp.api
index 3a18a38a3..8af317f3d 100644
--- a/okhttp/api/okhttp.api
+++ b/okhttp/api/okhttp.api
@@ -1010,7 +1010,6 @@ public final class okhttp3/Request {
 	public final fun newBuilder ()Lokhttp3/Request$Builder;
 	public final fun tag ()Ljava/lang/Object;
 	public final fun tag (Ljava/lang/Class;)Ljava/lang/Object;
-	public final fun tag (Lkotlin/reflect/KClass;)Ljava/lang/Object;
 	public fun toString ()Ljava/lang/String;
 	public final fun url ()Lokhttp3/HttpUrl;
 }
@@ -1034,7 +1033,6 @@ public class okhttp3/Request$Builder {
 	public fun removeHeader (Ljava/lang/String;)Lokhttp3/Request$Builder;
 	public fun tag (Ljava/lang/Class;Ljava/lang/Object;)Lokhttp3/Request$Builder;
 	public fun tag (Ljava/lang/Object;)Lokhttp3/Request$Builder;
-	public final fun tag (Lkotlin/reflect/KClass;Ljava/lang/Object;)Lokhttp3/Request$Builder;
 	public fun url (Ljava/lang/String;)Lokhttp3/Request$Builder;
 	public fun url (Ljava/net/URL;)Lokhttp3/Request$Builder;
 	public fun url (Lokhttp3/HttpUrl;)Lokhttp3/Request$Builder;
diff --git a/okhttp/src/commonMain/kotlin/okhttp3/Request.kt b/okhttp/src/commonMain/kotlin/okhttp3/Request.kt
index 88522a13d..be491f333 100644
--- a/okhttp/src/commonMain/kotlin/okhttp3/Request.kt
+++ b/okhttp/src/commonMain/kotlin/okhttp3/Request.kt
@@ -15,7 +15,6 @@
  */
 package okhttp3
 
-import kotlin.reflect.KClass
 import okhttp3.internal.HttpUrlRepresentation
 import okhttp3.internal.commonEmptyRequestBody
 
@@ -28,7 +27,6 @@ expect class Request private constructor(builder: Builder) {
   val method: String
   val headers: Headers
   val body: RequestBody?
-  internal val tags: Map<KClass<*>, Any>
 
   internal var lazyCacheControl: CacheControl?
 
@@ -38,11 +36,21 @@ expect class Request private constructor(builder: Builder) {
 
   fun headers(name: String): List<String>
 
-  /** Returns the tag attached with [T] as a key, or null if no tag is attached with that key. */
-  inline fun <reified T : Any> tag(): T?
-
-  /** Returns the tag attached with [type] as a key, or null if no tag is attached with that key. */
-  fun <T : Any> tag(type: KClass<T>): T?
+  // /**
+  //  * Returns the tag attached with `Object.class` as a key, or null if no tag is attached with
+  //  * that key.
+  //  *
+  //  * Prior to OkHttp 3.11, this method never returned null if no tag was attached. Instead it
+  //  * returned either this request, or the request upon which this request was derived with
+  //  * [newBuilder].
+  //  */
+  // fun tag(): Any? = tag(Any::class.java)
+  //
+  // /**
+  //  * Returns the tag attached with [type] as a key, or null if no tag is attached with that
+  //  * key.
+  //  */
+  // fun <T> tag(type: Class<out T>): T? = type.cast(tags[type])
 
   fun newBuilder(): Builder
 
@@ -58,9 +66,6 @@ expect class Request private constructor(builder: Builder) {
     internal var headers: Headers.Builder
     internal var body: RequestBody?
 
-    /** A mutable map of tags, or an immutable empty map if we don't have any. */
-    internal var tags: Map<KClass<*>, Any>
-
     constructor()
 
     internal constructor(request: Request)
@@ -121,23 +126,26 @@ expect class Request private constructor(builder: Builder) {
 
     open fun method(method: String, body: RequestBody?): Builder
 
-    /**
-     * Attaches [tag] to the request using [T] as a key. Tags can be read from a request using
-     * [Request.tag]. Use null to remove any existing tag assigned for [T].
-     *
-     * Use this API to attach timing, debugging, or other application data to a request so that
-     * you may read it in interceptors, event listeners, or callbacks.
-     */
-    inline fun <reified T : Any> tag(tag: T?): Builder
-
-    /**
-     * Attaches [tag] to the request using [type] as a key. Tags can be read from a request using
-     * [Request.tag]. Use null to remove any existing tag assigned for [type].
-     *
-     * Use this API to attach timing, debugging, or other application data to a request so that
-     * you may read it in interceptors, event listeners, or callbacks.
-     */
-    fun <T : Any> tag(type: KClass<T>, tag: T?): Builder
+    // /** Attaches [tag] to the request using `Object.class` as a key. */
+    // open fun tag(tag: Any?): Builder = tag(Any::class.java, tag)
+    //
+    // /**
+    //  * Attaches [tag] to the request using [type] as a key. Tags can be read from a
+    //  * request using [Request.tag]. Use null to remove any existing tag assigned for [type].
+    //  *
+    //  * Use this API to attach timing, debugging, or other application data to a request so that
+    //  * you may read it in interceptors, event listeners, or callbacks.
+    //  */
+    // open fun <T> tag(type: Class<in T>, tag: T?) = apply {
+    //   if (tag == null) {
+    //     tags.remove(type)
+    //   } else {
+    //     if (tags.isEmpty()) {
+    //       tags = mutableMapOf()
+    //     }
+    //     tags[type] = type.cast(tag)!! // Force-unwrap due to lack of contracts on Class#cast()
+    //   }
+    // }
 
     open fun build(): Request
   }
diff --git a/okhttp/src/commonMain/kotlin/okhttp3/internal/-RequestCommon.kt b/okhttp/src/commonMain/kotlin/okhttp3/internal/-RequestCommon.kt
index 044b7d6fc..958440005 100644
--- a/okhttp/src/commonMain/kotlin/okhttp3/internal/-RequestCommon.kt
+++ b/okhttp/src/commonMain/kotlin/okhttp3/internal/-RequestCommon.kt
@@ -16,7 +16,6 @@
 
 package okhttp3.internal
 
-import kotlin.reflect.KClass
 import okhttp3.CacheControl
 import okhttp3.Headers
 import okhttp3.Request
@@ -104,17 +103,3 @@ fun Request.Builder.commonMethod(method: String, body: RequestBody?): Request.Bu
   this.method = method
   this.body = body
 }
-
-fun <T : Any> Request.Builder.commonTag(type: KClass<T>, tag: T?) = apply {
-  if (tag == null) {
-    if (tags.isNotEmpty()) {
-      (tags as MutableMap).remove(type)
-    }
-  } else {
-    val mutableTags: MutableMap<KClass<*>, Any> = when {
-      tags.isEmpty() -> mutableMapOf<KClass<*>, Any>().also { tags = it }
-      else -> tags as MutableMap<KClass<*>, Any>
-    }
-    mutableTags[type] = tag
-  }
-}
diff --git a/okhttp/src/jvmMain/kotlin/okhttp3/Request.kt b/okhttp/src/jvmMain/kotlin/okhttp3/Request.kt
index 632eb514c..15303d1d5 100644
--- a/okhttp/src/jvmMain/kotlin/okhttp3/Request.kt
+++ b/okhttp/src/jvmMain/kotlin/okhttp3/Request.kt
@@ -16,7 +16,6 @@
 package okhttp3
 
 import java.net.URL
-import kotlin.reflect.KClass
 import okhttp3.HttpUrl.Companion.toHttpUrl
 import okhttp3.internal.canonicalUrl
 import okhttp3.internal.commonAddHeader
@@ -31,7 +30,7 @@ import okhttp3.internal.commonPatch
 import okhttp3.internal.commonPost
 import okhttp3.internal.commonPut
 import okhttp3.internal.commonRemoveHeader
-import okhttp3.internal.commonTag
+import okhttp3.internal.toImmutableMap
 
 actual class Request internal actual constructor(builder: Builder) {
   @get:JvmName("url")
@@ -46,7 +45,7 @@ actual class Request internal actual constructor(builder: Builder) {
   @get:JvmName("body")
   actual val body: RequestBody? = builder.body
 
-  internal actual val tags: Map<KClass<*>, Any> = builder.tags.toMap()
+  internal val tags: Map<Class<*>, Any> = builder.tags.toImmutableMap()
 
   internal actual var lazyCacheControl: CacheControl? = null
 
@@ -83,11 +82,6 @@ actual class Request internal actual constructor(builder: Builder) {
 
   actual fun headers(name: String): List<String> = commonHeaders(name)
 
-  @JvmName("reifiedTag")
-  actual inline fun <reified T : Any> tag(): T? = tag(T::class)
-
-  actual fun <T : Any> tag(type: KClass<T>): T? = type.java.cast(tags[type])
-
   /**
    * Returns the tag attached with `Object.class` as a key, or null if no tag is attached with
    * that key.
@@ -96,13 +90,13 @@ actual class Request internal actual constructor(builder: Builder) {
    * returned either this request, or the request upon which this request was derived with
    * [newBuilder].
    */
-  fun tag(): Any? = tag<Any>()
+  fun tag(): Any? = tag(Any::class.java)
 
   /**
    * Returns the tag attached with [type] as a key, or null if no tag is attached with that
    * key.
    */
-  fun <T> tag(type: Class<out T>): T? = tag(type.kotlin)
+  fun <T> tag(type: Class<out T>): T? = type.cast(tags[type])
 
   actual fun newBuilder(): Builder = Builder(this)
 
@@ -180,7 +174,9 @@ actual class Request internal actual constructor(builder: Builder) {
     internal actual var method: String
     internal actual var headers: Headers.Builder
     internal actual var body: RequestBody? = null
-    internal actual var tags = mapOf<KClass<*>, Any>()
+
+    /** A mutable map of tags, or an immutable empty map if we don't have any. */
+    internal var tags: MutableMap<Class<*>, Any> = mutableMapOf()
 
     actual constructor() {
       this.method = "GET"
@@ -191,9 +187,10 @@ actual class Request internal actual constructor(builder: Builder) {
       this.url = request.url
       this.method = request.method
       this.body = request.body
-      this.tags = when {
-        request.tags.isEmpty() -> mapOf()
-        else -> request.tags.toMutableMap()
+      this.tags = if (request.tags.isEmpty()) {
+        mutableMapOf()
+      } else {
+        request.tags.toMutableMap()
       }
       this.headers = request.headers.newBuilder()
     }
@@ -238,13 +235,8 @@ actual class Request internal actual constructor(builder: Builder) {
 
     actual open fun method(method: String, body: RequestBody?): Builder = commonMethod(method, body)
 
-    @JvmName("reifiedTag")
-    actual inline fun <reified T : Any> tag(tag: T?): Builder = tag(T::class, tag)
-
-    actual fun <T : Any> tag(type: KClass<T>, tag: T?): Builder = commonTag(type, tag)
-
     /** Attaches [tag] to the request using `Object.class` as a key. */
-    open fun tag(tag: Any?): Builder = commonTag(Any::class, tag)
+    open fun tag(tag: Any?): Builder = tag(Any::class.java, tag)
 
     /**
      * Attaches [tag] to the request using [type] as a key. Tags can be read from a
@@ -253,7 +245,16 @@ actual class Request internal actual constructor(builder: Builder) {
      * Use this API to attach timing, debugging, or other application data to a request so that
      * you may read it in interceptors, event listeners, or callbacks.
      */
-    open fun <T> tag(type: Class<in T>, tag: T?) = commonTag(type.kotlin, tag)
+    open fun <T> tag(type: Class<in T>, tag: T?) = apply {
+      if (tag == null) {
+        tags.remove(type)
+      } else {
+        if (tags.isEmpty()) {
+          tags = mutableMapOf()
+        }
+        tags[type] = type.cast(tag)!! // Force-unwrap due to lack of contracts on Class#cast()
+      }
+    }
 
     actual open fun build() = Request(this)
   }
diff --git a/okhttp/src/jvmMain/kotlin/okhttp3/internal/-UtilJvm.kt b/okhttp/src/jvmMain/kotlin/okhttp3/internal/-UtilJvm.kt
index 5362de662..441440cf1 100644
--- a/okhttp/src/jvmMain/kotlin/okhttp3/internal/-UtilJvm.kt
+++ b/okhttp/src/jvmMain/kotlin/okhttp3/internal/-UtilJvm.kt
@@ -223,6 +223,15 @@ fun <T> immutableListOf(vararg elements: T): List<T> {
   return Collections.unmodifiableList(listOf(*elements.clone()))
 }
 
+/** Returns an immutable copy of this. */
+internal fun <K, V> Map<K, V>.toImmutableMap(): Map<K, V> {
+  return if (isEmpty()) {
+    emptyMap()
+  } else {
+    Collections.unmodifiableMap(LinkedHashMap(this))
+  }
+}
+
 /** Closes this, ignoring any checked exceptions. */
 internal fun Socket.closeQuietly() {
   try {
diff --git a/okhttp/src/jvmTest/java/okhttp3/KotlinSourceModernTest.kt b/okhttp/src/jvmTest/java/okhttp3/KotlinSourceModernTest.kt
index 4ff00a8c7..4471bc13d 100644
--- a/okhttp/src/jvmTest/java/okhttp3/KotlinSourceModernTest.kt
+++ b/okhttp/src/jvmTest/java/okhttp3/KotlinSourceModernTest.kt
@@ -957,8 +957,6 @@ class KotlinSourceModernTest {
     val header: String? = request.header("")
     val headersForName: List<String> = request.headers("")
     val body: RequestBody? = request.body
-    var stringTag: String? = request.tag(String::class)
-    stringTag = request.tag<String>()
     var tag: Any? = request.tag()
     tag = request.tag(Any::class.java)
     val builder: Request.Builder = request.newBuilder()
diff --git a/okhttp/src/jvmTest/java/okhttp3/RequestTest.kt b/okhttp/src/jvmTest/java/okhttp3/RequestTest.kt
index 49be81465..fc95d9690 100644
--- a/okhttp/src/jvmTest/java/okhttp3/RequestTest.kt
+++ b/okhttp/src/jvmTest/java/okhttp3/RequestTest.kt
@@ -335,10 +335,6 @@ class RequestTest {
     assertThat(request.tag(Any::class.java)).isNull()
     assertThat(request.tag(UUID::class.java)).isNull()
     assertThat(request.tag(String::class.java)).isNull()
-
-    // Alternate access APIs also work.
-    assertThat(request.tag<String>()).isNull()
-    assertThat(request.tag(String::class)).isNull()
   }
 
   @Test
@@ -352,10 +348,6 @@ class RequestTest {
     assertThat(request.tag(Any::class.java)).isSameAs(tag)
     assertThat(request.tag(UUID::class.java)).isNull()
     assertThat(request.tag(String::class.java)).isNull()
-
-    // Alternate access APIs also work.
-    assertThat(request.tag<Any>()).isSameAs(tag)
-    assertThat(request.tag(Any::class)).isSameAs(tag)
   }
 
   @Test
@@ -388,61 +380,19 @@ class RequestTest {
     assertThat(request.tag(Any::class.java)).isSameAs(tag)
     assertThat(request.tag(UUID::class.java)).isNull()
     assertThat(request.tag(String::class.java)).isNull()
-
-    // Alternate access APIs also work.
-    assertThat(request.tag(Any::class)).isSameAs(tag)
-    assertThat(request.tag<Any>()).isSameAs(tag)
   }
 
   @Test
-  fun javaClassTag() {
+  fun typedTag() {
     val uuidTag = UUID.randomUUID()
     val request = Request.Builder()
       .url("https://square.com")
-      .tag(UUID::class.java, uuidTag) // Use the Class<*> parameter.
+      .tag(UUID::class.java, uuidTag)
       .build()
     assertThat(request.tag()).isNull()
     assertThat(request.tag(Any::class.java)).isNull()
     assertThat(request.tag(UUID::class.java)).isSameAs(uuidTag)
     assertThat(request.tag(String::class.java)).isNull()
-
-    // Alternate access APIs also work.
-    assertThat(request.tag(UUID::class)).isSameAs(uuidTag)
-    assertThat(request.tag<UUID>()).isSameAs(uuidTag)
-  }
-
-  @Test
-  fun kotlinReifiedTag() {
-    val uuidTag = UUID.randomUUID()
-    val request = Request.Builder()
-      .url("https://square.com")
-      .tag<UUID>(uuidTag) // Use the type parameter.
-      .build()
-    assertThat(request.tag()).isNull()
-    assertThat(request.tag<Any>()).isNull()
-    assertThat(request.tag<UUID>()).isSameAs(uuidTag)
-    assertThat(request.tag<String>()).isNull()
-
-    // Alternate access APIs also work.
-    assertThat(request.tag(UUID::class.java)).isSameAs(uuidTag)
-    assertThat(request.tag(UUID::class)).isSameAs(uuidTag)
-  }
-
-  @Test
-  fun kotlinClassTag() {
-    val uuidTag = UUID.randomUUID()
-    val request = Request.Builder()
-      .url("https://square.com")
-      .tag(UUID::class, uuidTag) // Use the KClass<*> parameter.
-      .build()
-    assertThat(request.tag()).isNull()
-    assertThat(request.tag(Any::class)).isNull()
-    assertThat(request.tag(UUID::class)).isSameAs(uuidTag)
-    assertThat(request.tag(String::class)).isNull()
-
-    // Alternate access APIs also work.
-    assertThat(request.tag(UUID::class.java)).isSameAs(uuidTag)
-    assertThat(request.tag<UUID>()).isSameAs(uuidTag)
   }
 
   @Test
diff --git a/okhttp/src/jvmTest/java/okhttp3/internal/UtilTest.kt b/okhttp/src/jvmTest/java/okhttp3/internal/UtilTest.kt
index 0e29b5560..3c0c37494 100644
--- a/okhttp/src/jvmTest/java/okhttp3/internal/UtilTest.kt
+++ b/okhttp/src/jvmTest/java/okhttp3/internal/UtilTest.kt
@@ -18,12 +18,28 @@ package okhttp3.internal
 import java.net.InetAddress
 import java.net.ServerSocket
 import java.net.Socket
+import java.util.LinkedHashMap
 import okio.buffer
 import okio.source
 import org.assertj.core.api.Assertions.assertThat
+import org.junit.jupiter.api.Assertions.fail
 import org.junit.jupiter.api.Test
 
 class UtilTest {
+  @Test fun immutableMap() {
+    val map = LinkedHashMap<String, String>()
+    map["a"] = "A"
+    val immutableCopy = map.toImmutableMap()
+    assertThat(mapOf("a" to "A")).isEqualTo(immutableCopy)
+    map.clear()
+    assertThat(mapOf("a" to "A")).isEqualTo(immutableCopy)
+    try {
+      (immutableCopy as MutableMap).clear()
+      fail()
+    } catch (_: UnsupportedOperationException) {
+    }
+  }
+
   @Test fun socketIsHealthy() {
     val localhost = InetAddress.getLoopbackAddress()
     val serverSocket = ServerSocket(0, 1, localhost)
diff --git a/okhttp/src/nonJvmMain/kotlin/okhttp3/Request.kt b/okhttp/src/nonJvmMain/kotlin/okhttp3/Request.kt
index 2258488d3..77a117f1c 100644
--- a/okhttp/src/nonJvmMain/kotlin/okhttp3/Request.kt
+++ b/okhttp/src/nonJvmMain/kotlin/okhttp3/Request.kt
@@ -15,7 +15,6 @@
  */
 package okhttp3
 
-import kotlin.reflect.KClass
 import okhttp3.internal.canonicalUrl
 import okhttp3.internal.commonAddHeader
 import okhttp3.internal.commonCacheControl
@@ -30,14 +29,12 @@ import okhttp3.internal.commonPatch
 import okhttp3.internal.commonPost
 import okhttp3.internal.commonPut
 import okhttp3.internal.commonRemoveHeader
-import okhttp3.internal.commonTag
 
 actual class Request internal actual constructor(builder: Builder) {
   actual val url: String = checkNotNull(builder.url) { "url == null" }
   actual val method: String = builder.method
   actual val headers: Headers = builder.headers.build()
   actual val body: RequestBody? = builder.body
-  internal actual val tags: Map<KClass<*>, Any> = builder.tags.toMap()
 
   internal actual var lazyCacheControl: CacheControl? = null
 
@@ -79,10 +76,6 @@ actual class Request internal actual constructor(builder: Builder) {
   actual val cacheControl: CacheControl
     get() = commonCacheControl()
 
-  actual inline fun <reified T : Any> tag(): T? = tag(T::class)
-
-  actual fun <T : Any> tag(type: KClass<T>): T? = tags[type] as T?
-
   override fun toString(): String = buildString {
     append("Request{method=")
     append(method)
@@ -112,7 +105,6 @@ actual class Request internal actual constructor(builder: Builder) {
     internal actual var method: String
     internal actual var headers: Headers.Builder
     internal actual var body: RequestBody? = null
-    internal actual var tags = mapOf<KClass<*>, Any>()
 
     // /** A mutable map of tags, or an immutable empty map if we don't have any. */
     // internal var tags: MutableMap<Class<*>, Any> = mutableMapOf()
@@ -126,10 +118,11 @@ actual class Request internal actual constructor(builder: Builder) {
       this.url = request.url
       this.method = request.method
       this.body = request.body
-      this.tags = when {
-        request.tags.isEmpty() -> mapOf()
-        else -> request.tags.toMutableMap()
-      }
+      // this.tags = if (request.tags.isEmpty()) {
+      //   mutableMapOf()
+      // } else {
+      //   request.tags.toMutableMap()
+      // }
       this.headers = request.headers.newBuilder()
     }
 
@@ -165,9 +158,26 @@ actual class Request internal actual constructor(builder: Builder) {
 
     actual open fun method(method: String, body: RequestBody?): Builder = commonMethod(method, body)
 
-    actual inline fun <reified T : Any> tag(tag: T?): Builder = tag(T::class, tag)
-
-    actual fun <T : Any> tag(type: KClass<T>, tag: T?): Builder = commonTag(type, tag)
+    // /** Attaches [tag] to the request using `Object.class` as a key. */
+    // open fun tag(tag: Any?): Builder = tag(Any::class.java, tag)
+
+    // /**
+    //  * Attaches [tag] to the request using [type] as a key. Tags can be read from a
+    //  * request using [Request.tag]. Use null to remove any existing tag assigned for [type].
+    //  *
+    //  * Use this API to attach timing, debugging, or other application data to a request so that
+    //  * you may read it in interceptors, event listeners, or callbacks.
+    //  */
+    // open fun <T> tag(type: Class<in T>, tag: T?) = apply {
+    //   if (tag == null) {
+    //     tags.remove(type)
+    //   } else {
+    //     if (tags.isEmpty()) {
+    //       tags = mutableMapOf()
+    //     }
+    //     tags[type] = type.cast(tag)!! // Force-unwrap due to lack of contracts on Class#cast()
+    //   }
+    // }
 
     actual open fun build() = Request(this)
   }
