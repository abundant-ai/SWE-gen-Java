diff --git a/http-server-netty/src/main/java/io/micronaut/http/server/netty/NettyHttpRequest.java b/http-server-netty/src/main/java/io/micronaut/http/server/netty/NettyHttpRequest.java
index 08652fb2b5..5bfdc73c76 100644
--- a/http-server-netty/src/main/java/io/micronaut/http/server/netty/NettyHttpRequest.java
+++ b/http-server-netty/src/main/java/io/micronaut/http/server/netty/NettyHttpRequest.java
@@ -20,6 +20,7 @@ import io.micronaut.core.annotation.Internal;
 import io.micronaut.core.annotation.NonNull;
 import io.micronaut.core.annotation.Nullable;
 import io.micronaut.core.async.publisher.Publishers;
+import io.micronaut.core.attr.AttributeHolder;
 import io.micronaut.core.bind.ArgumentBinder;
 import io.micronaut.core.convert.ArgumentConversionContext;
 import io.micronaut.core.convert.ConversionService;
@@ -115,7 +116,7 @@ import java.util.function.Supplier;
  * @since 1.0
  */
 @Internal
-public final class NettyHttpRequest<T> extends AbstractNettyHttpRequest<T> implements HttpRequest<T>, PushCapableHttpRequest<T>, io.micronaut.http.FullHttpRequest<T>, ServerHttpRequest<T> {
+public class NettyHttpRequest<T> extends AbstractNettyHttpRequest<T> implements HttpRequest<T>, PushCapableHttpRequest<T>, io.micronaut.http.FullHttpRequest<T>, ServerHttpRequest<T> {
     private static final Logger LOG = LoggerFactory.getLogger(NettyHttpRequest.class);
 
     /**
@@ -207,23 +208,23 @@ public final class NettyHttpRequest<T> extends AbstractNettyHttpRequest<T> imple
     }
 
     @Override
-    public ByteBody byteBody() {
+    public final ByteBody byteBody() {
         return body;
     }
 
-    public void setLegacyBody(Object legacyBody) {
+    public final void setLegacyBody(Object legacyBody) {
         this.legacyBody = legacyBody;
     }
 
-    public void addRouteWaitsFor(ExecutionFlow<?> executionFlow) {
+    public final void addRouteWaitsFor(ExecutionFlow<?> executionFlow) {
         routeWaitsFor = routeWaitsFor.then(() -> executionFlow);
     }
 
-    public ExecutionFlow<?> getRouteWaitsFor() {
+    public final ExecutionFlow<?> getRouteWaitsFor() {
         return routeWaitsFor;
     }
 
-    public FormRouteCompleter formRouteCompleter() {
+    public final FormRouteCompleter formRouteCompleter() {
         assert isFormOrMultipartData();
         if (formRouteCompleter == null) {
             formRouteCompleter = new FormRouteCompleter((RouteMatch<?>) getAttribute(HttpAttributes.ROUTE_MATCH).get(), getChannelHandlerContext().channel().eventLoop());
@@ -231,7 +232,7 @@ public final class NettyHttpRequest<T> extends AbstractNettyHttpRequest<T> imple
         return formRouteCompleter;
     }
 
-    public boolean hasFormRouteCompleter() {
+    public final boolean hasFormRouteCompleter() {
         return formRouteCompleter != null;
     }
 
@@ -385,46 +386,43 @@ public final class NettyHttpRequest<T> extends AbstractNettyHttpRequest<T> imple
      */
     @Internal
     public void release() {
+        Object routeMatchO = ((AttributeHolder) this).getAttribute(HttpAttributes.ROUTE_MATCH).orElse(null);
+        // usually this is a DefaultUriRouteMatch, avoid scalability issues here
+        RouteMatch<?> routeMatch = routeMatchO instanceof DefaultUriRouteMatch<?, ?> urm ? urm : (RouteMatch<?>) routeMatchO;
+        if (routeMatch != null) {
+            // discard parameters that have already been bound
+            for (Object toDiscard : routeMatch.getVariableValues().values()) {
+                if (toDiscard instanceof io.micronaut.core.io.buffer.ReferenceCounted rc) {
+                    rc.release();
+                }
+                if (toDiscard instanceof io.netty.util.ReferenceCounted rc) {
+                    rc.release();
+                }
+                if (toDiscard instanceof NettyCompletedFileUpload fu) {
+                    fu.discard();
+                }
+            }
+        }
         body.close();
         if (formRouteCompleter != null) {
             formRouteCompleter.release();
         }
         if (attributes != null) {
-            attributes.forEach(NettyHttpRequest::cleanup);
-        }
-    }
-
-    private static void cleanup(String k, Object v) {
-        //noinspection StringEquality
-        if (k == HttpAttributes.ROUTE_MATCH.toString()) {
-            // usually this is a DefaultUriRouteMatch, avoid scalability issues here
-            RouteMatch<?> routeMatch = v instanceof DefaultUriRouteMatch<?, ?> urm ? urm : (RouteMatch<?>) v;
-            if (routeMatch != null) {
-                // discard parameters that have already been bound
-                for (Object toDiscard : routeMatch.getVariableValues().values()) {
-                    if (toDiscard instanceof io.micronaut.core.io.buffer.ReferenceCounted rc) {
-                        rc.release();
-                    }
-                    if (toDiscard instanceof ReferenceCounted rc) {
-                        rc.release();
-                    }
-                    if (toDiscard instanceof NettyCompletedFileUpload fu) {
-                        fu.discard();
-                    }
+            attributes.forEach((k, v) -> {
+                //noinspection StringEquality
+                if (k == HttpAttributes.ROUTE_MATCH.toString() || k == HttpAttributes.ROUTE_INFO.toString() || v instanceof String) {
+                    // perf: avoid an instanceof in releaseIfNecessary
+                    return;
                 }
-            }
-            // perf: avoid an instanceof in releaseIfNecessary
-            return;
-        }
-        //noinspection StringEquality
-        if (k == HttpAttributes.ROUTE_INFO.toString() || v instanceof String) {
-            // perf: avoid an instanceof in releaseIfNecessary
-            return;
+                releaseIfNecessary(v);
+            });
         }
-        releaseIfNecessary(v);
     }
 
-    private static void releaseIfNecessary(Object value) {
+    /**
+     * @param value An object with a value
+     */
+    protected void releaseIfNecessary(Object value) {
         if (value instanceof ReferenceCounted referenceCounted) {
             int i = referenceCounted.refCnt();
             if (i != 0) {
@@ -612,7 +610,7 @@ public final class NettyHttpRequest<T> extends AbstractNettyHttpRequest<T> imple
      * @return Return true if the request is form data.
      */
     @Internal
-    public boolean isFormOrMultipartData() {
+    public final boolean isFormOrMultipartData() {
         MediaType ct = getContentType().orElse(null);
         return ct != null && (ct.equals(MediaType.APPLICATION_FORM_URLENCODED_TYPE) || ct.equals(MediaType.MULTIPART_FORM_DATA_TYPE));
     }
@@ -910,6 +908,10 @@ public final class NettyHttpRequest<T> extends AbstractNettyHttpRequest<T> imple
             return nextConvertor.convert(conversionContext, value);
         }
 
+        public void cleanup() {
+            nextConvertor = null;
+        }
+
     }
 
 }
diff --git a/http/src/main/java/io/micronaut/http/HttpMessage.java b/http/src/main/java/io/micronaut/http/HttpMessage.java
index ffe903c3b0..c74d6154b6 100644
--- a/http/src/main/java/io/micronaut/http/HttpMessage.java
+++ b/http/src/main/java/io/micronaut/http/HttpMessage.java
@@ -75,7 +75,7 @@ public interface HttpMessage<B> extends MutableAttributeHolder {
      * @return The request character encoding. Defaults to {@link StandardCharsets#UTF_8}
      */
     default @NonNull Charset getCharacterEncoding() {
-        return HttpUtil.getCharset(this);
+        return HttpUtil.resolveCharset(this).orElse(StandardCharsets.UTF_8);
     }
 
     @Override
diff --git a/http/src/main/java/io/micronaut/http/MediaType.java b/http/src/main/java/io/micronaut/http/MediaType.java
index ee817fcaee..8607cac7a7 100644
--- a/http/src/main/java/io/micronaut/http/MediaType.java
+++ b/http/src/main/java/io/micronaut/http/MediaType.java
@@ -959,24 +959,12 @@ public class MediaType implements CharSequence, Comparable<MediaType> {
     }
 
     /**
-     * @return The parameters of the media type
+     * @return The parameters to the media type
      */
     public OptionalValues<String> getParameters() {
         return OptionalValues.of(String.class, parameters);
     }
 
-    /**
-     * @return The parameters map of the media type
-     * @since 4.8
-     */
-    @NonNull
-    public Map<CharSequence, String> getParametersMap() {
-        if (parameters == null) {
-            return Collections.emptyMap();
-        }
-        return Collections.unmodifiableMap(parameters);
-    }
-
     /**
      * @return The quality of the Mime type
      */
@@ -1002,11 +990,7 @@ public class MediaType implements CharSequence, Comparable<MediaType> {
      * @return The charset of the media type if specified
      */
     public Optional<Charset> getCharset() {
-        String charset = parameters.get(CHARSET_PARAMETER);
-        if (charset == null) {
-            return Optional.empty();
-        }
-        return Optional.of(Charset.forName(charset));
+        return getParameters().get(CHARSET_PARAMETER).map(Charset::forName);
     }
 
     @Override
diff --git a/http/src/main/java/io/micronaut/http/uri/UriMatchTemplate.java b/http/src/main/java/io/micronaut/http/uri/UriMatchTemplate.java
index 75cacc4f1e..3ddc52e65c 100644
--- a/http/src/main/java/io/micronaut/http/uri/UriMatchTemplate.java
+++ b/http/src/main/java/io/micronaut/http/uri/UriMatchTemplate.java
@@ -299,7 +299,7 @@ public class UriMatchTemplate extends UriTemplate implements UriMatcher {
             this.uri = uri;
             this.variableValues = variableValues;
             this.variables = variables;
-            LinkedHashMap<String, UriMatchVariable> vm = CollectionUtils.newLinkedHashMap(variables.size());
+            LinkedHashMap<String, UriMatchVariable> vm = new LinkedHashMap<>(variables.size());
             for (UriMatchVariable variable : variables) {
                 vm.put(variable.getName(), variable);
             }
diff --git a/http/src/main/java/io/micronaut/http/util/HttpUtil.java b/http/src/main/java/io/micronaut/http/util/HttpUtil.java
index 736e02f4ac..47f128feb9 100644
--- a/http/src/main/java/io/micronaut/http/util/HttpUtil.java
+++ b/http/src/main/java/io/micronaut/http/util/HttpUtil.java
@@ -15,7 +15,6 @@
  */
 package io.micronaut.http.util;
 
-import io.micronaut.core.annotation.NonNull;
 import io.micronaut.http.HttpMessage;
 import io.micronaut.http.HttpRequest;
 import io.micronaut.http.MediaType;
@@ -55,53 +54,32 @@ public class HttpUtil {
      * @param request The request
      * @return An {@link Optional} of {@link Charset}
      */
-    public static Optional<Charset> resolveCharset(@NonNull HttpMessage<?> request) {
-        try {
-            MediaType contentType = request
-                .getContentType().orElse(null);
-            if (contentType != null) {
-                String charset = contentType.getParametersMap().get(MediaType.CHARSET_PARAMETER);
-                if (charset != null) {
-                    try {
-                        return Optional.of(Charset.forName(charset));
-                    } catch (Exception e) {
-                        // unsupported charset, default to UTF-8
-                        return Optional.of(Charset.defaultCharset());
-                    }
-                }
-            }
-        } catch (UnsupportedCharsetException e) {
-            return Optional.empty();
-        }
-        return request.getHeaders().findAcceptCharset();
-    }
-
-    /**
-     * Resolve the {@link Charset} to use for the request.
-     *
-     * @param request The request
-     * @return An {@link Optional} of {@link Charset}
-     * @since 4.8
-     */
     @SuppressWarnings("Duplicates")
-    @NonNull
-    public static Charset getCharset(@NonNull HttpMessage<?> request) {
+    public static Optional<Charset> resolveCharset(HttpMessage<?> request) {
         try {
-            MediaType contentType = request.getContentType().orElse(null);
-            if (contentType != null) {
-                String charset = contentType.getParametersMap().get(MediaType.CHARSET_PARAMETER);
-                if (charset != null) {
-                    try {
-                        return Charset.forName(charset);
-                    } catch (Exception e) {
-                        // unsupported charset, default to UTF-8
-                        return Charset.defaultCharset();
+            Optional<Charset> contentTypeCharset = request
+                .getContentType()
+                .map(contentType -> {
+                    Optional<String> charset = contentType.getParameters().get(MediaType.CHARSET_PARAMETER);
+                    if (charset.isPresent()) {
+                        try {
+                            return Charset.forName(charset.get());
+                        } catch (Exception e) {
+                            // unsupported charset, default to UTF-8
+                            return StandardCharsets.UTF_8;
+                        }
+                    } else {
+                        return null;
                     }
-                }
+                });
+
+            if (contentTypeCharset.isPresent()) {
+                return contentTypeCharset;
+            } else {
+                return request.getHeaders().findAcceptCharset();
             }
         } catch (UnsupportedCharsetException e) {
-            return StandardCharsets.UTF_8;
+            return Optional.empty();
         }
-        return request.getHeaders().findAcceptCharset().orElse(StandardCharsets.UTF_8);
     }
 }
diff --git a/http/src/test/groovy/io/micronaut/http/util/HttpUtilSpec.groovy b/http/src/test/groovy/io/micronaut/http/util/HttpUtilSpec.groovy
index 3eb5507568..364b6a0fc4 100644
--- a/http/src/test/groovy/io/micronaut/http/util/HttpUtilSpec.groovy
+++ b/http/src/test/groovy/io/micronaut/http/util/HttpUtilSpec.groovy
@@ -1,6 +1,6 @@
 package io.micronaut.http.util
 
-
+import io.micronaut.http.HttpHeaders
 import io.micronaut.http.HttpMessage
 import io.micronaut.http.MediaType
 import spock.lang.Issue
@@ -21,15 +21,4 @@ class HttpUtilSpec extends Specification {
         then:
         charset.get() == StandardCharsets.UTF_8
     }
-
-    @Issue("https://github.com/micronaut-projects/micronaut-core/issues/4332")
-    void "test an invalid charset returns the default 2"() {
-        when:
-        Charset charset = HttpUtil.getCharset(Mock(HttpMessage) {
-            getContentType() >> Optional.of(MediaType.of("text/xml;charset=\"invalid\""))
-        })
-
-        then:
-        charset == StandardCharsets.UTF_8
-    }
 }
diff --git a/router/src/main/java/io/micronaut/web/router/AbstractRouteMatch.java b/router/src/main/java/io/micronaut/web/router/AbstractRouteMatch.java
index affe3e384d..9b55f7baef 100644
--- a/router/src/main/java/io/micronaut/web/router/AbstractRouteMatch.java
+++ b/router/src/main/java/io/micronaut/web/router/AbstractRouteMatch.java
@@ -378,11 +378,12 @@ abstract class AbstractRouteMatch<T, R> implements MethodBasedRouteMatch<T, R> {
     }
 
     private <E> ArgumentConversionContext<E> newContext(Argument<E> argument, HttpRequest<?> request) {
-        return ConversionContext.of(
+        ArgumentConversionContext<E> conversionContext = ConversionContext.of(
             argument,
             request.getLocale().orElse(null),
             request.getCharacterEncoding()
         );
+        return conversionContext;
     }
 
     private <E> void fulfillValue(int index, Argument<E> argument, ArgumentBinder.BindingResult<E> bindingResult) {
diff --git a/router/src/main/java/io/micronaut/web/router/DefaultUriRouteMatch.java b/router/src/main/java/io/micronaut/web/router/DefaultUriRouteMatch.java
index 421b9a151a..ba69d5423f 100644
--- a/router/src/main/java/io/micronaut/web/router/DefaultUriRouteMatch.java
+++ b/router/src/main/java/io/micronaut/web/router/DefaultUriRouteMatch.java
@@ -41,7 +41,7 @@ public final class DefaultUriRouteMatch<T, R> extends AbstractRouteMatch<T, R> i
     private final UriMatchInfo matchInfo;
     private final UriRouteInfo<T, R> uriRouteInfo;
     private final Charset defaultCharset;
-    private Map<String, Object> variables;
+
     /**
      * @param matchInfo The URI match info
      * @param routeInfo The URI route
@@ -65,19 +65,16 @@ public final class DefaultUriRouteMatch<T, R> extends AbstractRouteMatch<T, R> i
 
     @Override
     public Map<String, Object> getVariableValues() {
-        if (variables == null) {
-            Map<String, Object> matchVariables = matchInfo.getVariableValues();
-            if (CollectionUtils.isNotEmpty(matchVariables)) {
-                variables = CollectionUtils.newLinkedHashMap(matchVariables.size());
-                matchVariables.forEach((k, v) -> {
-                    if (v instanceof CharSequence) {
-                        v = URLDecoder.decode(v.toString(), defaultCharset);
-                    }
-                    variables.put(k, v);
-                });
-            } else {
-                variables = Map.of();
-            }
+        Map<String, Object> variables = matchInfo.getVariableValues();
+        if (CollectionUtils.isNotEmpty(variables)) {
+            Map<String, Object> decoded = CollectionUtils.newLinkedHashMap(variables.size());
+            variables.forEach((k, v) -> {
+                if (v instanceof CharSequence) {
+                    v = URLDecoder.decode(v.toString(), defaultCharset);
+                }
+                decoded.put(k, v);
+            });
+            return decoded;
         }
         return variables;
     }
diff --git a/router/src/main/java/io/micronaut/web/router/RouteMatch.java b/router/src/main/java/io/micronaut/web/router/RouteMatch.java
index 248fce9cf8..efac399335 100644
--- a/router/src/main/java/io/micronaut/web/router/RouteMatch.java
+++ b/router/src/main/java/io/micronaut/web/router/RouteMatch.java
@@ -49,9 +49,7 @@ public interface RouteMatch<R> extends Callable<R>, AnnotationMetadataProvider {
      * Fulfill argument values.
      *
      * @param argumentValues The argument values
-     * @deprecated No longer used
      */
-    @Deprecated(forRemoval = true, since = "4.9")
     void fulfill(Map<String, Object> argumentValues);
 
     /**
