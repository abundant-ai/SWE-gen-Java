diff --git a/mockwebserver/api/mockwebserver3.api b/mockwebserver/api/mockwebserver3.api
index 1b1d76c0b..ff41ce1f9 100644
--- a/mockwebserver/api/mockwebserver3.api
+++ b/mockwebserver/api/mockwebserver3.api
@@ -16,7 +16,7 @@ public final class mockwebserver3/MockResponse {
 	public fun <init> (ILokhttp3/Headers;Ljava/lang/String;ZLmockwebserver3/SocketPolicy;I)V
 	public synthetic fun <init> (ILokhttp3/Headers;Ljava/lang/String;ZLmockwebserver3/SocketPolicy;IILkotlin/jvm/internal/DefaultConstructorMarker;)V
 	public synthetic fun <init> (Lmockwebserver3/MockResponse$Builder;Lkotlin/jvm/internal/DefaultConstructorMarker;)V
-	public final fun getBody ()Lmockwebserver3/MockResponseBody;
+	public final fun getBody ()Lokio/Buffer;
 	public final fun getBodyDelayNanos ()J
 	public final fun getCode ()I
 	public final fun getDuplexResponseBody ()Lmockwebserver3/internal/duplex/DuplexResponseBody;
@@ -58,7 +58,6 @@ public final class mockwebserver3/MockResponse$Builder : java/lang/Cloneable {
 	public synthetic fun clone ()Ljava/lang/Object;
 	public fun clone ()Lmockwebserver3/MockResponse$Builder;
 	public final fun code (I)Lmockwebserver3/MockResponse$Builder;
-	public final fun getBody ()Lmockwebserver3/MockResponseBody;
 	public final fun getCode ()I
 	public final fun getDuplexResponseBody ()Lmockwebserver3/internal/duplex/DuplexResponseBody;
 	public final fun getHttp2ErrorCode ()I
@@ -75,7 +74,6 @@ public final class mockwebserver3/MockResponse$Builder : java/lang/Cloneable {
 	public final fun http2ErrorCode (I)Lmockwebserver3/MockResponse$Builder;
 	public final fun inTunnel ()Lmockwebserver3/MockResponse$Builder;
 	public final fun removeHeader (Ljava/lang/String;)Lmockwebserver3/MockResponse$Builder;
-	public final fun setBody (Lmockwebserver3/MockResponseBody;)V
 	public final fun setCode (I)V
 	public final fun setHeader (Ljava/lang/String;Ljava/lang/Object;)Lmockwebserver3/MockResponse$Builder;
 	public final fun setHttp2ErrorCode (I)V
@@ -92,11 +90,6 @@ public final class mockwebserver3/MockResponse$Builder : java/lang/Cloneable {
 public final class mockwebserver3/MockResponse$Companion {
 }
 
-public abstract interface class mockwebserver3/MockResponseBody {
-	public abstract fun getContentLength ()J
-	public abstract fun writeTo (Lokio/BufferedSink;)V
-}
-
 public final class mockwebserver3/MockWebServer : java/io/Closeable {
 	public static final field Companion Lmockwebserver3/MockWebServer$Companion;
 	public fun <init> ()V
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt b/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
index 91ed9785c..da7c2f240 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
@@ -17,7 +17,6 @@ package mockwebserver3
 
 import java.util.concurrent.TimeUnit
 import mockwebserver3.internal.duplex.DuplexResponseBody
-import mockwebserver3.internal.toMockResponseBody
 import okhttp3.Headers
 import okhttp3.Headers.Companion.headersOf
 import okhttp3.WebSocketListener
@@ -48,7 +47,8 @@ class MockResponse {
   val headers: Headers
   val trailers: Headers
 
-  val body: MockResponseBody?
+  val body: Buffer?
+    get() { return field?.clone() }
 
   val inTunnel: Boolean
   val informationalResponses: List<MockResponse>
@@ -101,7 +101,7 @@ class MockResponse {
     this.status = builder.status
     this.headers = builder.headers.build()
     this.trailers = builder.trailers.build()
-    this.body = builder.body
+    this.body = builder.body?.clone()
     this.inTunnel = builder.inTunnel
     this.informationalResponses = builder.informationalResponses.toList()
     this.throttleBytesPerPeriod = builder.throttleBytesPerPeriod
@@ -152,7 +152,7 @@ class MockResponse {
 
     internal var trailers: Headers.Builder
 
-    var body: MockResponseBody?
+    internal var body: Buffer?
 
     var throttleBytesPerPeriod: Long
       private set
@@ -271,7 +271,7 @@ class MockResponse {
 
     fun body(body: Buffer) = apply {
       setHeader("Content-Length", body.size)
-      this.body = body.toMockResponseBody()
+      this.body = body.clone() // Defensive copy.
     }
 
     /** Sets the response body to the UTF-8 encoded bytes of [body]. */
@@ -297,7 +297,7 @@ class MockResponse {
         bytesOut.writeUtf8("\r\n")
       }
       bytesOut.writeUtf8("0\r\n") // Last chunk. Trailers follow!
-      this.body = bytesOut.toMockResponseBody()
+      this.body = bytesOut
     }
 
     /**
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/MockResponseBody.kt b/mockwebserver/src/main/kotlin/mockwebserver3/MockResponseBody.kt
deleted file mode 100644
index 2d0c1b2b3..000000000
--- a/mockwebserver/src/main/kotlin/mockwebserver3/MockResponseBody.kt
+++ /dev/null
@@ -1,34 +0,0 @@
-/*
- * Copyright (c) 2022 Block, Inc.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- *
- */
-package mockwebserver3
-
-import java.io.IOException
-import okio.BufferedSink
-
-/**
- * The body of a [MockResponse].
- *
- * Unlike [okhttp3.ResponseBody], this interface is designed to be implemented by writers and not
- * called by readers.
- */
-interface MockResponseBody {
-  /** The length of this response in bytes, or -1 if unknown. */
-  val contentLength: Long
-
-  @Throws(IOException::class)
-  fun writeTo(sink: BufferedSink)
-}
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt b/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
index 652f7904b..a6c5fdb17 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
@@ -58,10 +58,7 @@ import mockwebserver3.SocketPolicy.SHUTDOWN_INPUT_AT_END
 import mockwebserver3.SocketPolicy.SHUTDOWN_OUTPUT_AT_END
 import mockwebserver3.SocketPolicy.SHUTDOWN_SERVER_AFTER_RESPONSE
 import mockwebserver3.SocketPolicy.STALL_SOCKET_AT_START
-import mockwebserver3.internal.ThrottledSink
-import mockwebserver3.internal.TriggerSink
 import mockwebserver3.internal.duplex.DuplexResponseBody
-import mockwebserver3.internal.sleepNanos
 import okhttp3.Headers
 import okhttp3.Headers.Companion.headersOf
 import okhttp3.HttpUrl
@@ -675,38 +672,29 @@ class MockWebServer : Closeable {
 
       var hasBody = false
       val policy = dispatcher.peek()
-      val requestBodySink = requestBody.withThrottlingAndSocketPolicy(
-        policy = policy,
-        disconnectHalfway = policy.socketPolicy == DISCONNECT_DURING_REQUEST_BODY,
-        expectedByteCount = contentLength,
-        socket = socket,
-      ).buffer()
-      requestBodySink.use {
-        when {
-          policy.socketPolicy == DO_NOT_READ_REQUEST_BODY -> {
-            // Ignore the body completely.
-          }
-
-          contentLength != -1L -> {
-            hasBody = contentLength > 0L
-            requestBodySink.write(source, contentLength)
+      if (policy.socketPolicy == DO_NOT_READ_REQUEST_BODY) {
+        // Ignore the body completely.
+      } else if (contentLength != -1L) {
+        hasBody = contentLength > 0L
+        throttledTransfer(policy, socket, source, requestBody.buffer(), contentLength, true)
+      } else if (chunked) {
+        hasBody = true
+        while (true) {
+          val chunkSize = source.readUtf8LineStrict().trim().toInt(16)
+          if (chunkSize == 0) {
+            readEmptyLine(source)
+            break
           }
-
-          chunked -> {
-            hasBody = true
-            while (true) {
-              val chunkSize = source.readUtf8LineStrict().trim().toInt(16)
-              if (chunkSize == 0) {
-                readEmptyLine(source)
-                break
-              }
-              chunkSizes.add(chunkSize)
-              requestBodySink.write(source, chunkSize.toLong())
-              readEmptyLine(source)
-            }
-          }
-
-          else -> Unit // No request body.
+          chunkSizes.add(chunkSize)
+          throttledTransfer(
+            policy = policy,
+            socket = socket,
+            source = source,
+            sink = requestBody.buffer(),
+            byteCount = chunkSize.toLong(),
+            isRequest = true
+          )
+          readEmptyLine(source)
         }
       }
 
@@ -797,14 +785,7 @@ class MockWebServer : Closeable {
 
     val body = response.body ?: return
     sleepNanos(response.bodyDelayNanos)
-    val responseBodySink = sink.withThrottlingAndSocketPolicy(
-      policy = response,
-      disconnectHalfway = response.socketPolicy == DISCONNECT_DURING_RESPONSE_BODY,
-      expectedByteCount = body.contentLength,
-      socket = socket,
-    ).buffer()
-    body.writeTo(responseBodySink)
-    responseBodySink.emit()
+    throttledTransfer(response, socket, body, sink, body.size, false)
 
     if ("chunked".equals(response.headers["Transfer-Encoding"], ignoreCase = true)) {
       writeHeaders(sink, response.trailers)
@@ -823,38 +804,69 @@ class MockWebServer : Closeable {
     sink.flush()
   }
 
-  /** Returns a sink that applies throttling and disconnecting. */
-  private fun Sink.withThrottlingAndSocketPolicy(
+  private fun sleepNanos(nanos: Long) {
+    val ms = nanos / 1_000_000L
+    val ns = nanos - (ms * 1_000_000L)
+    if (ms > 0L || nanos > 0) {
+      Thread.sleep(ms, ns.toInt())
+    }
+  }
+
+  /**
+   * Transfer bytes from [source] to [sink] until either [byteCount] bytes have
+   * been transferred or [source] is exhausted. The transfer is throttled according to [policy].
+   */
+  @Throws(IOException::class)
+  private fun throttledTransfer(
     policy: MockResponse,
-    disconnectHalfway: Boolean,
-    expectedByteCount: Long,
     socket: Socket,
-  ): Sink {
-    var result: Sink = this
-
-    if (policy.throttlePeriodNanos > 0L) {
-      result = ThrottledSink(
-        delegate = result,
-        bytesPerPeriod = policy.throttleBytesPerPeriod,
-        periodDelayNanos = policy.throttlePeriodNanos,
-      )
+    source: BufferedSource,
+    sink: BufferedSink,
+    byteCount: Long,
+    isRequest: Boolean
+  ) {
+    var byteCountNum = byteCount
+    if (byteCountNum == 0L) return
+
+    val buffer = Buffer()
+    val bytesPerPeriod = policy.throttleBytesPerPeriod
+    val periodDelayNanos = policy.throttlePeriodNanos
+
+    val halfByteCount = byteCountNum / 2
+    val disconnectHalfway = if (isRequest) {
+      policy.socketPolicy === DISCONNECT_DURING_REQUEST_BODY
+    } else {
+      policy.socketPolicy === DISCONNECT_DURING_RESPONSE_BODY
     }
 
-    if (disconnectHalfway) {
-      val halfwayByteCount = when {
-        expectedByteCount != -1L -> expectedByteCount / 2
-        else -> 0L
-      }
-      result = TriggerSink(
-        delegate = result,
-        triggerByteCount = halfwayByteCount,
-      ) {
-        result.flush()
-        socket.close()
+    while (!socket.isClosed) {
+      var b = 0L
+      while (b < bytesPerPeriod) {
+        // Ensure we do not read past the allotted bytes in this period.
+        var toRead = minOf(byteCountNum, bytesPerPeriod - b)
+        // Ensure we do not read past halfway if the policy will kill the connection.
+        if (disconnectHalfway) {
+          toRead = minOf(toRead, byteCountNum - halfByteCount)
+        }
+
+        val read = source.read(buffer, toRead)
+        if (read == -1L) return
+
+        sink.write(buffer, read)
+        sink.flush()
+        b += read
+        byteCountNum -= read
+
+        if (disconnectHalfway && byteCountNum == halfByteCount) {
+          socket.close()
+          return
+        }
+
+        if (byteCountNum == 0L) return
       }
-    }
 
-    return result
+      sleepNanos(periodDelayNanos)
+    }
   }
 
   @Throws(IOException::class)
@@ -986,18 +998,18 @@ class MockWebServer : Closeable {
       val body = Buffer()
       val requestLine = "$method $path HTTP/1.1"
       var exception: IOException? = null
-      if (readBody && !peek.isDuplex && peek.socketPolicy != DO_NOT_READ_REQUEST_BODY) {
+      if (readBody && !peek.isDuplex && peek.socketPolicy !== DO_NOT_READ_REQUEST_BODY) {
         try {
           val contentLengthString = headers["content-length"]
-          val requestBodySink = body.withThrottlingAndSocketPolicy(
+          val byteCount = contentLengthString?.toLong() ?: Long.MAX_VALUE
+          throttledTransfer(
             policy = peek,
-            disconnectHalfway = peek.socketPolicy == DISCONNECT_DURING_REQUEST_BODY,
-            expectedByteCount = contentLengthString?.toLong() ?: Long.MAX_VALUE,
             socket = socket,
-          ).buffer()
-          requestBodySink.use {
-            it.writeAll(stream.getSource())
-          }
+            source = stream.getSource().buffer(),
+            sink = body,
+            byteCount = byteCount,
+            isRequest = true
+          )
         } catch (e: IOException) {
           exception = e
         }
@@ -1056,15 +1068,9 @@ class MockWebServer : Closeable {
       }
       pushPromises(stream, request, response.pushPromises)
       if (body != null) {
-        sleepNanos(bodyDelayNanos)
-        val responseBodySink = stream.getSink().withThrottlingAndSocketPolicy(
-          policy = response,
-          disconnectHalfway = response.socketPolicy == DISCONNECT_DURING_RESPONSE_BODY,
-          expectedByteCount = body.contentLength,
-          socket = socket
-        ).buffer()
-        responseBodySink.use {
-          body.writeTo(responseBodySink)
+        stream.getSink().buffer().use { sink ->
+          sleepNanos(bodyDelayNanos)
+          throttledTransfer(response, socket, body, sink, body.size, false)
         }
       } else if (response.isDuplex) {
         val duplexResponseBody = response.duplexResponseBody!!
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/internal/ThrottledSink.kt b/mockwebserver/src/main/kotlin/mockwebserver3/internal/ThrottledSink.kt
deleted file mode 100644
index f75bf7761..000000000
--- a/mockwebserver/src/main/kotlin/mockwebserver3/internal/ThrottledSink.kt
+++ /dev/null
@@ -1,48 +0,0 @@
-/*
- * Copyright (c) 2022 Block, Inc.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- *
- */
-package mockwebserver3.internal
-
-import okio.Buffer
-import okio.Sink
-
-/**
- * A sink that sleeps [periodDelayNanos] every [bytesPerPeriod] bytes. Unlike [okio.Throttler],
- * this permits any interval to be used.
- */
-internal class ThrottledSink(
-  private val delegate: Sink,
-  private val bytesPerPeriod: Long,
-  private val periodDelayNanos: Long,
-) : Sink by delegate {
-  private var bytesWrittenSinceLastDelay = 0L
-  override fun write(source: Buffer, byteCount: Long) {
-    var bytesLeft = byteCount
-
-    while (bytesLeft > 0) {
-      if (bytesWrittenSinceLastDelay == bytesPerPeriod) {
-        flush()
-        sleepNanos(periodDelayNanos)
-        bytesWrittenSinceLastDelay = 0
-      }
-
-      val toWrite = minOf(bytesLeft, bytesPerPeriod - bytesWrittenSinceLastDelay)
-      bytesWrittenSinceLastDelay += toWrite
-      bytesLeft -= toWrite
-      delegate.write(source, toWrite)
-    }
-  }
-}
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/internal/TriggerSink.kt b/mockwebserver/src/main/kotlin/mockwebserver3/internal/TriggerSink.kt
deleted file mode 100644
index 4de875525..000000000
--- a/mockwebserver/src/main/kotlin/mockwebserver3/internal/TriggerSink.kt
+++ /dev/null
@@ -1,52 +0,0 @@
-/*
- * Copyright (c) 2022 Block, Inc.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- *
- */
-package mockwebserver3.internal
-
-import okio.Buffer
-import okio.Sink
-
-/**
- * A sink that executes [trigger] after [triggerByteCount] bytes are written, and then skips all
- * subsequent bytes.
- */
-internal class TriggerSink(
-  private val delegate: Sink,
-  private val triggerByteCount: Long,
-  private val trigger: () -> Unit,
-) : Sink by delegate {
-  private var bytesWritten = 0L
-
-  override fun write(source: Buffer, byteCount: Long) {
-    if (byteCount == 0L) return // Avoid double-triggering.
-
-    if (bytesWritten == triggerByteCount) {
-      source.skip(byteCount)
-      return
-    }
-
-    val toWrite = minOf(byteCount, triggerByteCount - bytesWritten)
-    bytesWritten += toWrite
-
-    delegate.write(source, toWrite)
-
-    if (bytesWritten == triggerByteCount) {
-      trigger()
-    }
-
-    source.skip(byteCount - toWrite)
-  }
-}
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/internal/mockResponseBodies.kt b/mockwebserver/src/main/kotlin/mockwebserver3/internal/mockResponseBodies.kt
deleted file mode 100644
index 6c1a7cd5f..000000000
--- a/mockwebserver/src/main/kotlin/mockwebserver3/internal/mockResponseBodies.kt
+++ /dev/null
@@ -1,39 +0,0 @@
-/*
- * Copyright (c) 2022 Block, Inc.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- *
- */
-@file:JvmName("MockResponseBodiesKt")
-
-package mockwebserver3.internal
-
-import mockwebserver3.MockResponseBody
-import okio.Buffer
-import okio.BufferedSink
-
-internal fun Buffer.toMockResponseBody(): MockResponseBody {
-  val defensiveCopy = clone()
-  return BufferMockResponseBody(defensiveCopy)
-}
-
-internal class BufferMockResponseBody(
-  val buffer: Buffer,
-) : MockResponseBody {
-  override val contentLength = buffer.size
-
-  override fun writeTo(sink: BufferedSink) {
-    buffer.copyTo(sink.buffer)
-    sink.emitCompleteSegments()
-  }
-}
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/internal/sleep.kt b/mockwebserver/src/main/kotlin/mockwebserver3/internal/sleep.kt
deleted file mode 100644
index 059d7bc2e..000000000
--- a/mockwebserver/src/main/kotlin/mockwebserver3/internal/sleep.kt
+++ /dev/null
@@ -1,25 +0,0 @@
-/*
- * Copyright (c) 2022 Block, Inc.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- *
- */
-package mockwebserver3.internal
-
-internal fun sleepNanos(nanos: Long) {
-  val ms = nanos / 1_000_000L
-  val ns = nanos - (ms * 1_000_000L)
-  if (ms > 0L || nanos > 0) {
-    Thread.sleep(ms, ns.toInt())
-  }
-}
diff --git a/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.java b/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.java
index f7e3a2fed..06e28f164 100644
--- a/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.java
+++ b/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.java
@@ -44,7 +44,6 @@ import okhttp3.TestUtil;
 import okhttp3.testing.PlatformRule;
 import okhttp3.tls.HandshakeCertificates;
 import okhttp3.tls.HeldCertificate;
-import okio.Buffer;
 import org.junit.jupiter.api.AfterEach;
 import org.junit.jupiter.api.BeforeEach;
 import org.junit.jupiter.api.Disabled;
@@ -116,9 +115,7 @@ public final class MockWebServerTest {
     MockResponse.Builder builder = new MockResponse.Builder().body("ABC");
     assertThat(headersToList(builder)).containsExactly("Content-Length: 3");
     MockResponse response = builder.build();
-    Buffer body = new Buffer();
-    response.getBody().writeTo(body);
-    assertThat(body.readUtf8()).isEqualTo("ABC");
+    assertThat(response.getBody().readUtf8()).isEqualTo("ABC");
   }
 
   @Test public void mockResponseAddHeader() {
@@ -577,8 +574,8 @@ public final class MockWebServerTest {
   @Test public void testMockWebServerH2PriorKnowledgeProtocol() {
     server.setProtocols(asList(Protocol.H2_PRIOR_KNOWLEDGE));
 
-    assertThat(server.getProtocols().size()).isEqualTo(1);
-    assertThat(server.getProtocols().get(0)).isEqualTo(Protocol.H2_PRIOR_KNOWLEDGE);
+    assertThat(server.protocols().size()).isEqualTo(1);
+    assertThat(server.protocols().get(0)).isEqualTo(Protocol.H2_PRIOR_KNOWLEDGE);
   }
 
   @Test public void https() throws Exception {
diff --git a/okhttp/src/jvmTest/java/okhttp3/CacheTest.java b/okhttp/src/jvmTest/java/okhttp3/CacheTest.java
index 83e299164..857ef732a 100644
--- a/okhttp/src/jvmTest/java/okhttp3/CacheTest.java
+++ b/okhttp/src/jvmTest/java/okhttp3/CacheTest.java
@@ -2889,14 +2889,12 @@ public final class CacheTest {
    * Shortens the body of {@code response} but not the corresponding headers. Only useful to test
    * how clients respond to the premature conclusion of the HTTP body.
    */
-  private MockResponse.Builder truncateViolently(MockResponse.Builder builder, int numBytesToKeep) throws IOException {
+  private MockResponse.Builder truncateViolently(MockResponse.Builder builder, int numBytesToKeep) {
     MockResponse response = builder.build();
     builder.socketPolicy(DISCONNECT_AT_END);
     Headers headers = response.getHeaders();
-    Buffer fullBody = new Buffer();
-    response.getBody().writeTo(fullBody);
     Buffer truncatedBody = new Buffer();
-    truncatedBody.write(fullBody, numBytesToKeep);
+    truncatedBody.write(response.getBody(), numBytesToKeep);
     builder.body(truncatedBody);
     builder.headers(headers);
     return builder;
diff --git a/okhttp/src/jvmTest/java/okhttp3/EventListenerTest.java b/okhttp/src/jvmTest/java/okhttp3/EventListenerTest.java
index be26ae434..c251a7d9a 100644
--- a/okhttp/src/jvmTest/java/okhttp3/EventListenerTest.java
+++ b/okhttp/src/jvmTest/java/okhttp3/EventListenerTest.java
@@ -1102,7 +1102,6 @@ public final class EventListenerTest {
   }
 
   private class NonCompletingRequestBody extends RequestBody {
-    private final byte[] chunk = new byte[1024 * 512];
     IOException ioe;
 
     @Override public MediaType contentType() {
@@ -1110,19 +1109,28 @@ public final class EventListenerTest {
     }
 
     @Override public long contentLength() {
-      return chunk.length * 32L;
+      return 1024 * 1024 * 4;
     }
 
     @Override public void writeTo(BufferedSink sink) throws IOException {
       try {
-        for (int i = 0; i < contentLength(); i += chunk.length) {
-          sink.write(chunk);
-          sink.flush();
-        }
+        writeChunk(sink);
+        writeChunk(sink);
+        writeChunk(sink);
+        writeChunk(sink);
+        Thread.sleep(1000);
+        writeChunk(sink);
+        writeChunk(sink);
       } catch (IOException e) {
         ioe = e;
+      } catch (InterruptedException e) {
       }
     }
+
+    private void writeChunk(BufferedSink sink) throws IOException {
+      sink.write(new byte[1024 * 512]);
+      sink.flush();
+    }
   }
 
   @Test public void requestBodyMultipleFailuresReportedOnlyOnce() {
diff --git a/okhttp/src/jvmTest/java/okhttp3/URLConnectionTest.kt b/okhttp/src/jvmTest/java/okhttp3/URLConnectionTest.kt
index 578e90ca7..fcb642ae4 100644
--- a/okhttp/src/jvmTest/java/okhttp3/URLConnectionTest.kt
+++ b/okhttp/src/jvmTest/java/okhttp3/URLConnectionTest.kt
@@ -803,8 +803,7 @@ class URLConnectionTest {
   fun contentDisagreesWithChunkedHeaderBodyTooLong() {
     val builder = MockResponse.Builder()
       .chunkedBody("abc", 3)
-    val buffer = Buffer()
-    builder.body!!.writeTo(buffer)
+    val buffer = builder.build().body!!
     buffer.writeUtf8("\r\nYOU SHOULD NOT SEE THIS")
     builder.body(buffer)
     builder.clearHeaders()
@@ -817,9 +816,8 @@ class URLConnectionTest {
   fun contentDisagreesWithChunkedHeaderBodyTooShort() {
     val builder = MockResponse.Builder()
       .chunkedBody("abcdefg", 5)
-    val fullBody = Buffer()
-    builder.body!!.writeTo(fullBody)
     val truncatedBody = Buffer()
+    val fullBody = builder.build().body!!
     truncatedBody.write(fullBody, 4)
     builder.body(truncatedBody)
     builder.clearHeaders()
diff --git a/okhttp/src/jvmTest/java/okhttp3/internal/http2/HttpOverHttp2Test.kt b/okhttp/src/jvmTest/java/okhttp3/internal/http2/HttpOverHttp2Test.kt
index aab20ff93..1821ff228 100644
--- a/okhttp/src/jvmTest/java/okhttp3/internal/http2/HttpOverHttp2Test.kt
+++ b/okhttp/src/jvmTest/java/okhttp3/internal/http2/HttpOverHttp2Test.kt
@@ -1416,8 +1416,8 @@ class HttpOverHttp2Test {
     // doesn't wait to read the client's DATA frame and may send a DATA frame before the client
     // does. So we can't assume the client's empty DATA will be logged first.
     assertThat(countFrames(logs, "FINE: >> 0x00000003     0 DATA          END_STREAM"))
-      .isEqualTo(1L)
-    assertThat(countFrames(logs, "FINE: >> 0x00000003     3 DATA          END_STREAM"))
+      .isEqualTo(2L)
+    assertThat(countFrames(logs, "FINE: >> 0x00000003     3 DATA          "))
       .isEqualTo(1L)
   }
 
