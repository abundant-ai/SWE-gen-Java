diff --git a/platforms/core-configuration/bean-serialization-services/build.gradle.kts b/platforms/core-configuration/bean-serialization-services/build.gradle.kts
index 2276ac1aaa0..2814ee7a6d8 100644
--- a/platforms/core-configuration/bean-serialization-services/build.gradle.kts
+++ b/platforms/core-configuration/bean-serialization-services/build.gradle.kts
@@ -22,7 +22,11 @@ plugins {
 description = "Configuration Cache services supporting bean serialization"
 
 jvmCompile {
-    usesJdkInternals = true
+    compilations {
+        named("main") {
+            usesJdkInternals = true
+        }
+    }
 }
 
 dependencies {
diff --git a/platforms/core-configuration/core-serialization-codecs/build.gradle.kts b/platforms/core-configuration/core-serialization-codecs/build.gradle.kts
index 3c69a372eb8..ba166e773a9 100644
--- a/platforms/core-configuration/core-serialization-codecs/build.gradle.kts
+++ b/platforms/core-configuration/core-serialization-codecs/build.gradle.kts
@@ -21,7 +21,11 @@ plugins {
 description = "Configuration Cache serialization codecs for :core (and family) types"
 
 jvmCompile {
-    usesFutureStdlib = true
+    compilations {
+        named("main") {
+            usesFutureStdlib = true
+        }
+    }
 }
 
 dependencies {
diff --git a/platforms/core-configuration/model-core/build.gradle.kts b/platforms/core-configuration/model-core/build.gradle.kts
index 84a79d12297..035eb28e1e8 100644
--- a/platforms/core-configuration/model-core/build.gradle.kts
+++ b/platforms/core-configuration/model-core/build.gradle.kts
@@ -6,7 +6,11 @@ plugins {
 description = "Implementation of configuration model types and annotation metadata handling (Providers, software model, conventions)"
 
 jvmCompile {
-    usesJdkInternals = true
+    compilations {
+        named("main") {
+            usesJdkInternals = true
+        }
+    }
 }
 
 dependencies {
diff --git a/platforms/core-runtime/base-services/build.gradle.kts b/platforms/core-runtime/base-services/build.gradle.kts
index 8ed884acf0e..bb16a876b7b 100644
--- a/platforms/core-runtime/base-services/build.gradle.kts
+++ b/platforms/core-runtime/base-services/build.gradle.kts
@@ -15,7 +15,11 @@ gradleModule {
 }
 
 jvmCompile {
-    usesFutureStdlib = true
+    compilations {
+        named("main") {
+            usesFutureStdlib = true
+        }
+    }
 }
 
 dependencies {
diff --git a/platforms/core-runtime/classloaders/build.gradle.kts b/platforms/core-runtime/classloaders/build.gradle.kts
index ab177c96204..bb41c25354d 100644
--- a/platforms/core-runtime/classloaders/build.gradle.kts
+++ b/platforms/core-runtime/classloaders/build.gradle.kts
@@ -29,7 +29,11 @@ gradleModule {
 }
 
 jvmCompile {
-    usesFutureStdlib = true
+    compilations {
+        named("main") {
+            usesFutureStdlib = true
+        }
+    }
 }
 
 dependencies {
diff --git a/platforms/core-runtime/serialization/build.gradle.kts b/platforms/core-runtime/serialization/build.gradle.kts
index 2c8f7d0e3c2..cd57d81fb06 100644
--- a/platforms/core-runtime/serialization/build.gradle.kts
+++ b/platforms/core-runtime/serialization/build.gradle.kts
@@ -28,7 +28,11 @@ gradleModule {
 }
 
 jvmCompile {
-    usesFutureStdlib = true
+    compilations {
+        named("main") {
+            usesFutureStdlib = true
+        }
+    }
 }
 
 dependencies {
diff --git a/platforms/ide/tooling-api/build.gradle.kts b/platforms/ide/tooling-api/build.gradle.kts
index 81628ac8074..3639081a45e 100644
--- a/platforms/ide/tooling-api/build.gradle.kts
+++ b/platforms/ide/tooling-api/build.gradle.kts
@@ -13,8 +13,16 @@ gradleModule {
 }
 
 jvmCompile {
-    // JSpecify annotations on static inner type return types
-    usesJdkInternals = true
+    compilations {
+        named("main") {
+            // JSpecify annotations on static inner type return types
+            usesJdkInternals = true
+        }
+        named("crossVersionTest") {
+            // The TAPI tests must be able to run the TAPI client, which is still JVM 8 compatible
+            targetJvmVersion = 8
+        }
+    }
 }
 
 tasks.named<Jar>("sourcesJar") {
diff --git a/platforms/jvm/java-compiler-plugin/build.gradle.kts b/platforms/jvm/java-compiler-plugin/build.gradle.kts
index 641581c4af1..efa327c14df 100644
--- a/platforms/jvm/java-compiler-plugin/build.gradle.kts
+++ b/platforms/jvm/java-compiler-plugin/build.gradle.kts
@@ -5,7 +5,11 @@ plugins {
 description = "A Java compiler plugin used by Gradle's incremental compiler"
 
 jvmCompile {
-    usesJdkInternals = true
+    compilations {
+        named("main") {
+            usesJdkInternals = true
+        }
+    }
 }
 
 tasks.withType<Test>().configureEach {
diff --git a/platforms/jvm/language-java/build.gradle.kts b/platforms/jvm/language-java/build.gradle.kts
index ded7cbe42f4..b2f6c3c0a5f 100644
--- a/platforms/jvm/language-java/build.gradle.kts
+++ b/platforms/jvm/language-java/build.gradle.kts
@@ -5,7 +5,11 @@ plugins {
 description = "Source for JavaCompile, JavaExec and Javadoc tasks, it also contains logic for incremental Java compilation"
 
 jvmCompile {
-    usesJdkInternals = true
+    compilations {
+        named("main") {
+            usesJdkInternals = true
+        }
+    }
 }
 
 errorprone {
diff --git a/subprojects/core/build.gradle.kts b/subprojects/core/build.gradle.kts
index 545bb585434..191d634e1fe 100644
--- a/subprojects/core/build.gradle.kts
+++ b/subprojects/core/build.gradle.kts
@@ -31,6 +31,12 @@ dependencyAnalysis {
         ignoreSourceSet(testInterceptors.name)
     }
 }
+jvmCompile {
+    addCompilationFrom(testInterceptors) {
+        // By default, test interceptors compile to the same JVM version as the production code.
+        targetJvmVersion = compilations.named("main").flatMap { it.targetJvmVersion }
+    }
+}
 
 val testInterceptorsImplementation: Configuration by configurations.getting {
     extendsFrom(configurations.implementation.get())
diff --git a/testing/internal-integ-testing/build.gradle.kts b/testing/internal-integ-testing/build.gradle.kts
index 936475deb3c..da776a2373a 100644
--- a/testing/internal-integ-testing/build.gradle.kts
+++ b/testing/internal-integ-testing/build.gradle.kts
@@ -7,6 +7,15 @@ plugins {
 
 description = "Collection of test fixtures for integration tests, internal use only"
 
+jvmCompile {
+    compilations {
+        named("main") {
+            // These test fixtures are used by the tooling API tests, which still run on JVM 8
+            targetJvmVersion = 8
+        }
+    }
+}
+
 sourceSets {
     main {
         // Incremental Groovy joint-compilation doesn't work with the Error Prone annotation processor
diff --git a/testing/internal-testing/build.gradle.kts b/testing/internal-testing/build.gradle.kts
index 5ca3a4ecaa3..bb84f50c189 100644
--- a/testing/internal-testing/build.gradle.kts
+++ b/testing/internal-testing/build.gradle.kts
@@ -4,6 +4,15 @@ plugins {
 
 description = "Collection of test fixtures for both unit tests and integration tests, internal use only"
 
+jvmCompile {
+    compilations {
+        named("main") {
+            // These test fixtures are used by the tooling API tests, which still run on JVM 8
+            targetJvmVersion = 8
+        }
+    }
+}
+
 sourceSets {
     main {
         // Incremental Groovy joint-compilation doesn't work with the Error Prone annotation processor
diff --git a/testing/smoke-ide-test/build.gradle.kts b/testing/smoke-ide-test/build.gradle.kts
index 7b30b6fe97a..db6e99acc72 100644
--- a/testing/smoke-ide-test/build.gradle.kts
+++ b/testing/smoke-ide-test/build.gradle.kts
@@ -12,6 +12,10 @@ val smokeIdeTestSourceSet = sourceSets.create("smokeIdeTest") {
     runtimeClasspath += sourceSets.main.get().output
 }
 
+jvmCompile {
+    addCompilationFrom(smokeIdeTestSourceSet)
+}
+
 dependencyAnalysis {
     issues {
         ignoreSourceSet(smokeIdeTestSourceSet.name)
diff --git a/testing/smoke-test/build.gradle.kts b/testing/smoke-test/build.gradle.kts
index 1663c4d089d..a28183b8847 100644
--- a/testing/smoke-test/build.gradle.kts
+++ b/testing/smoke-test/build.gradle.kts
@@ -13,6 +13,10 @@ val smokeTestSourceSet = sourceSets.create("smokeTest") {
     runtimeClasspath += sourceSets.main.get().output
 }
 
+jvmCompile {
+    addCompilationFrom(smokeTestSourceSet)
+}
+
 dependencyAnalysis {
     issues {
         ignoreSourceSet(smokeTestSourceSet.name)
