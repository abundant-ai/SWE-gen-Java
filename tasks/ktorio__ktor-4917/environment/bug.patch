diff --git a/ktor-server/ktor-server-config-yaml/jvmAndPosix/test/YamlConfigTest.kt b/ktor-server/ktor-server-config-yaml/jvmAndPosix/test/YamlConfigTest.kt
index debc52e5a..c7f480c66 100644
--- a/ktor-server/ktor-server-config-yaml/jvmAndPosix/test/YamlConfigTest.kt
+++ b/ktor-server/ktor-server-config-yaml/jvmAndPosix/test/YamlConfigTest.kt
@@ -296,73 +296,32 @@ class YamlConfigTest {
 
     @Test
     fun mergedConversion() {
-        val authYamlText = """
-            app:
-                auth:
-                    hashAlgorithm: SHA-256
-                    salt: ktor
-                    users:
-                        - name: test
-                          password: asd
-        """.trimIndent()
-
-        val dbYamlText = """
-            app:
-                database:
-                    driver: org.postgresql.Driver
-                    url: jdbc:postgresql://localhost:5432/ktor
-                    user: ktor
-                    password: ktor
-                    schema: public
-                    maxPoolSize: 3
-                    transactionIsolation: TRANSACTION_REPEATABLE_READ
-                    useServerPrepStmts: true
-                    cachePrepStmts: true
+        val yamlText = """
+            auth:
+                hashAlgorithm: SHA-256
+                salt: ktor
+                users:
+                    - name: test
+                      password: asd
         """.trimIndent()
-
         val mapEntries = listOf(
-            "app.auth.salt" to "SALT&PEPPA",
-            "app.deployment.port" to "8080",
-            "app.deployment.host" to "localhost",
-            "app.database.maxPoolSize" to "2",
-            "app.database.cachePrepStmts" to "true",
-            "app.database.prepStmtCacheSize" to "250",
+            "auth.salt" to "SALT&PEPPA",
+            "deployment.port" to "8080",
+            "deployment.host" to "localhost",
         )
 
-        val authYamlConfig = YamlConfig.from(Yaml.default.decodeFromString<YamlMap>(authYamlText))
-        val dbYamlConfig = YamlConfig.from(Yaml.default.decodeFromString<YamlMap>(dbYamlText))
+        val yaml = Yaml.default.decodeFromString<YamlMap>(yamlText)
+        val yamlConfig = YamlConfig.from(yaml)
         val mapConfig = MapApplicationConfig(mapEntries)
 
-        val yamlMerged = authYamlConfig.mergeWith(dbYamlConfig)
-        val mergedConfig = yamlMerged.mergeWith(mapConfig)
-
-        val expectedSecurity = SecurityConfig("SHA-256", "SALT&PEPPA", listOf(SecurityUser("test", "asd")))
-        val expectedDeployment = DeploymentConfig("localhost", 8080)
-        val expectedDatabase =
-            DatabaseConfig(
-                "org.postgresql.Driver",
-                "jdbc:postgresql://localhost:5432/ktor",
-                "ktor",
-                "ktor",
-                "public",
-                2
-            )
-
+        val mergedConfig = yamlConfig.mergeWith(mapConfig)
         assertEquals(
-            expectedSecurity,
-            mergedConfig.property("app.auth").getAs()
+            SecurityConfig("SHA-256", "SALT&PEPPA", listOf(SecurityUser("test", "asd"))),
+            mergedConfig.property("auth").getAs()
         )
         assertEquals(
-            expectedDeployment,
-            mergedConfig.property("app.deployment").getAs()
-        )
-        assertEquals(
-            expectedDatabase,
-            mergedConfig.property("app.database").getAs()
-        )
-        assertEquals(
-            AppConfig(expectedDeployment, expectedSecurity, expectedDatabase),
-            mergedConfig.property("app").getAs()
+            DeploymentConfig("localhost", 8080),
+            mergedConfig.property("deployment").getAs()
         )
     }
 
@@ -372,13 +331,6 @@ class YamlConfigTest {
         val password: String
     )
 
-    @Serializable
-    data class AppConfig(
-        val deployment: DeploymentConfig,
-        val auth: SecurityConfig,
-        val database: DatabaseConfig,
-    )
-
     @Serializable
     data class SecurityConfig(
         val hashAlgorithm: String,
@@ -391,14 +343,4 @@ class YamlConfigTest {
         val host: String,
         val port: Int,
     )
-
-    @Serializable
-    data class DatabaseConfig(
-        val driver: String,
-        val url: String,
-        val user: String,
-        val password: String,
-        val schema: String,
-        val maxPoolSize: Int,
-    )
 }
diff --git a/ktor-server/ktor-server-core/common/src/io/ktor/server/config/MapConfigDecoder.kt b/ktor-server/ktor-server-core/common/src/io/ktor/server/config/MapConfigDecoder.kt
index b5bc43c73..f8ffe9900 100644
--- a/ktor-server/ktor-server-core/common/src/io/ktor/server/config/MapConfigDecoder.kt
+++ b/ktor-server/ktor-server-core/common/src/io/ktor/server/config/MapConfigDecoder.kt
@@ -141,8 +141,7 @@ private fun Map<String, String>.listSize(path: String): Int =
     (this["$path.size"] ?: "0").toInt()
 
 internal fun Map<String, String>.containsPrefix(prefix: String): Boolean =
-    prefix.isEmpty() ||
-        containsKey(prefix) ||
+    containsKey(prefix) ||
         containsKey("$prefix.size") ||
         keys.any {
             it.startsWith(prefix) &&
diff --git a/ktor-server/ktor-server-core/common/src/io/ktor/server/config/MergedApplicationConfig.kt b/ktor-server/ktor-server-core/common/src/io/ktor/server/config/MergedApplicationConfig.kt
index 51d28fad1..e1650558d 100644
--- a/ktor-server/ktor-server-core/common/src/io/ktor/server/config/MergedApplicationConfig.kt
+++ b/ktor-server/ktor-server-core/common/src/io/ktor/server/config/MergedApplicationConfig.kt
@@ -4,7 +4,6 @@
 
 package io.ktor.server.config
 
-import io.ktor.server.config.ApplicationConfigValue.Type.*
 import io.ktor.server.config.MapApplicationConfig.Companion.flatten
 
 /**
@@ -31,12 +30,9 @@ public fun List<ApplicationConfig>.merge(): ApplicationConfig {
  *
  * @see [withFallback]
  */
-public fun ApplicationConfig.mergeWith(other: ApplicationConfig): ApplicationConfig =
-    when {
-        keys().isEmpty() -> other
-        other.keys().isEmpty() -> this
-        else -> MergedApplicationConfig(other, this)
-    }
+public fun ApplicationConfig.mergeWith(other: ApplicationConfig): ApplicationConfig {
+    return MergedApplicationConfig(other, this)
+}
 
 /**
  * Merge configuration combining all their keys.
@@ -109,14 +105,12 @@ internal class MergedApplicationConfig(
     private fun merge(
         first: ApplicationConfigValue?,
         second: ApplicationConfigValue?,
-    ): ApplicationConfigValue? {
-        val value = when {
-            first == null -> second
-            second == null -> first
-            first.type != OBJECT || second.type != OBJECT -> first
-            else -> mergeMapConfigValues(first, second)
-        }
-        return value
+    ): ApplicationConfigValue? = when {
+        first == null -> second
+        second == null -> first
+        first.type != ApplicationConfigValue.Type.OBJECT ||
+            second.type != ApplicationConfigValue.Type.OBJECT -> first
+        else -> mergeMapConfigValues(first, second)
     }
 
     /**
