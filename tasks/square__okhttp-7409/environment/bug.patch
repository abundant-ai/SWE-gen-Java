diff --git a/.github/workflows/build.yml b/.github/workflows/build.yml
index 6ccbb3b99..2baaa9450 100644
--- a/.github/workflows/build.yml
+++ b/.github/workflows/build.yml
@@ -335,15 +335,11 @@ jobs:
 
       - name: Build okcurl
         uses: gradle/gradle-build-action@v2
-        env:
-          USE_NATIVE_IMAGE_JAVA_PLATFORM_MODULE_SYSTEM: false
         with:
           arguments: okcurl:nativeImage
 
       - name: Build ConsoleLauncher
         uses: gradle/gradle-build-action@v2
-        env:
-          USE_NATIVE_IMAGE_JAVA_PLATFORM_MODULE_SYSTEM: false
         with:
           arguments: -PgraalBuild native-image-tests:nativeImage
 
diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
index 93c464e6d..79d69357f 100644
--- a/gradle/libs.versions.toml
+++ b/gradle/libs.versions.toml
@@ -4,7 +4,7 @@ checkStyle = "10.3.2"
 com-squareup-moshi = "1.13.0"
 com-squareup-okio = "3.2.0"
 de-mannodermaus-junit5 = "1.3.0"
-graalvm = "22.2.0"
+graalvm = "22.1.0"
 org-bouncycastle = "1.71"
 org-conscrypt = "2.5.2"
 org-jetbrains-coroutines = "1.6.4"
@@ -39,7 +39,7 @@ gradlePlugin-binaryCompatibilityValidator = "org.jetbrains.kotlinx.binary-compat
 gradlePlugin-bnd = { module = "biz.aQute.bnd:biz.aQute.bnd.gradle", version.ref = "biz-aQute-bnd" }
 gradlePlugin-dokka = "org.jetbrains.dokka:dokka-gradle-plugin:1.6.21"
 gradlePlugin-errorprone = "net.ltgt.gradle:gradle-errorprone-plugin:2.0.2"
-gradlePlugin-graal = "com.palantir.graal:gradle-graal:0.12.0"
+gradlePlugin-graal = "gradle.plugin.com.palantir.graal:gradle-graal:0.10.0"
 gradlePlugin-kotlin = { module = "org.jetbrains.kotlin:kotlin-gradle-plugin", version.ref = "org-jetbrains-kotlin" }
 gradlePlugin-mavenPublish = "com.vanniktech:gradle-maven-publish-plugin:0.20.0"
 gradlePlugin-shadow = "gradle.plugin.com.github.johnrengelman:shadow:7.1.2"
diff --git a/native-image-tests/build.gradle.kts b/native-image-tests/build.gradle.kts
index ba843c763..fbfe83cd7 100644
--- a/native-image-tests/build.gradle.kts
+++ b/native-image-tests/build.gradle.kts
@@ -57,6 +57,7 @@ graal {
   javaVersion("11")
 
   option("--no-fallback")
+  option("--allow-incomplete-classpath")
   option("--report-unsupported-elements-at-runtime")
   option("-H:+ReportExceptionStackTraces")
 }
diff --git a/native-image-tests/src/main/kotlin/okhttp3/RunTests.kt b/native-image-tests/src/main/kotlin/okhttp3/RunTests.kt
index 3c4985798..e1b6eb432 100644
--- a/native-image-tests/src/main/kotlin/okhttp3/RunTests.kt
+++ b/native-image-tests/src/main/kotlin/okhttp3/RunTests.kt
@@ -136,13 +136,10 @@ fun findTests(selectors: List<DiscoverySelector>): List<TestDescriptor> {
  * https://github.com/junit-team/junit5/issues/2469
  */
 fun treeListener(): TestExecutionListener {
-  val colorPalette = Class.forName("org.junit.platform.console.tasks.ColorPalette").getField("DEFAULT").apply {
-    isAccessible = true
-  }.get(null)
   return Class.forName(
     "org.junit.platform.console.tasks.TreePrintingListener").declaredConstructors.first()
     .apply {
       isAccessible = true
     }
-    .newInstance(PrintWriter(System.out), colorPalette, Theme.UNICODE) as TestExecutionListener
+    .newInstance(PrintWriter(System.out), false, Theme.UNICODE) as TestExecutionListener
 }
diff --git a/native-image-tests/src/main/kotlin/okhttp3/TestRegistration.kt b/native-image-tests/src/main/kotlin/okhttp3/TestRegistration.kt
index 484426e1c..b0fb44d43 100644
--- a/native-image-tests/src/main/kotlin/okhttp3/TestRegistration.kt
+++ b/native-image-tests/src/main/kotlin/okhttp3/TestRegistration.kt
@@ -20,7 +20,6 @@ import org.graalvm.nativeimage.hosted.Feature
 import org.graalvm.nativeimage.hosted.RuntimeClassInitialization
 import org.graalvm.nativeimage.hosted.RuntimeReflection
 import java.io.File
-import java.lang.IllegalStateException
 
 @AutomaticFeature
 class TestRegistration : Feature {
@@ -52,12 +51,14 @@ class TestRegistration : Feature {
   private fun registerJupiterClasses(access: Feature.BeforeAnalysisAccess) {
     registerStandardClass(access, "org.junit.jupiter.params.ParameterizedTestExtension")
     registerStandardClass(access, "org.junit.platform.console.tasks.TreePrintingListener")
+    registerStandardClass(access,
+      "org.junit.jupiter.engine.extension.TimeoutExtension\$ExecutorResource")
   }
 
   private fun registerStandardClass(access: Feature.BeforeAnalysisAccess, name: String) {
-    val clazz: Class<*> = access.findClassByName(name) ?: throw IllegalStateException("Missing class $name")
-    RuntimeReflection.register(clazz)
-    clazz.declaredConstructors.forEach {
+    val listener = access.findClassByName(name)
+    RuntimeReflection.register(listener)
+    listener.declaredConstructors.forEach {
       RuntimeReflection.register(it)
     }
   }
@@ -97,4 +98,4 @@ class TestRegistration : Feature {
       RuntimeReflection.register(it)
     }
   }
-}
+}
\ No newline at end of file
diff --git a/okcurl/build.gradle.kts b/okcurl/build.gradle.kts
index 6c734ade9..567a1e541 100644
--- a/okcurl/build.gradle.kts
+++ b/okcurl/build.gradle.kts
@@ -50,6 +50,7 @@ graal {
   javaVersion("11")
 
   option("--no-fallback")
+  option("--allow-incomplete-classpath")
 
   if (Os.isFamily(Os.FAMILY_WINDOWS)) {
     // May be possible without, but autodetection is problematic on Windows 10
