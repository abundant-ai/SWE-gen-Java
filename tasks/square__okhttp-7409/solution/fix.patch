diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
index 79d69357f..93c464e6d 100644
--- a/gradle/libs.versions.toml
+++ b/gradle/libs.versions.toml
@@ -4,7 +4,7 @@ checkStyle = "10.3.2"
 com-squareup-moshi = "1.13.0"
 com-squareup-okio = "3.2.0"
 de-mannodermaus-junit5 = "1.3.0"
-graalvm = "22.1.0"
+graalvm = "22.2.0"
 org-bouncycastle = "1.71"
 org-conscrypt = "2.5.2"
 org-jetbrains-coroutines = "1.6.4"
@@ -39,7 +39,7 @@ gradlePlugin-binaryCompatibilityValidator = "org.jetbrains.kotlinx.binary-compat
 gradlePlugin-bnd = { module = "biz.aQute.bnd:biz.aQute.bnd.gradle", version.ref = "biz-aQute-bnd" }
 gradlePlugin-dokka = "org.jetbrains.dokka:dokka-gradle-plugin:1.6.21"
 gradlePlugin-errorprone = "net.ltgt.gradle:gradle-errorprone-plugin:2.0.2"
-gradlePlugin-graal = "gradle.plugin.com.palantir.graal:gradle-graal:0.10.0"
+gradlePlugin-graal = "com.palantir.graal:gradle-graal:0.12.0"
 gradlePlugin-kotlin = { module = "org.jetbrains.kotlin:kotlin-gradle-plugin", version.ref = "org-jetbrains-kotlin" }
 gradlePlugin-mavenPublish = "com.vanniktech:gradle-maven-publish-plugin:0.20.0"
 gradlePlugin-shadow = "gradle.plugin.com.github.johnrengelman:shadow:7.1.2"
diff --git a/native-image-tests/build.gradle.kts b/native-image-tests/build.gradle.kts
index fbfe83cd7..ba843c763 100644
--- a/native-image-tests/build.gradle.kts
+++ b/native-image-tests/build.gradle.kts
@@ -57,7 +57,6 @@ graal {
   javaVersion("11")
 
   option("--no-fallback")
-  option("--allow-incomplete-classpath")
   option("--report-unsupported-elements-at-runtime")
   option("-H:+ReportExceptionStackTraces")
 }
diff --git a/native-image-tests/src/main/kotlin/okhttp3/TestRegistration.kt b/native-image-tests/src/main/kotlin/okhttp3/TestRegistration.kt
index b0fb44d43..484426e1c 100644
--- a/native-image-tests/src/main/kotlin/okhttp3/TestRegistration.kt
+++ b/native-image-tests/src/main/kotlin/okhttp3/TestRegistration.kt
@@ -20,6 +20,7 @@ import org.graalvm.nativeimage.hosted.Feature
 import org.graalvm.nativeimage.hosted.RuntimeClassInitialization
 import org.graalvm.nativeimage.hosted.RuntimeReflection
 import java.io.File
+import java.lang.IllegalStateException
 
 @AutomaticFeature
 class TestRegistration : Feature {
@@ -51,14 +52,12 @@ class TestRegistration : Feature {
   private fun registerJupiterClasses(access: Feature.BeforeAnalysisAccess) {
     registerStandardClass(access, "org.junit.jupiter.params.ParameterizedTestExtension")
     registerStandardClass(access, "org.junit.platform.console.tasks.TreePrintingListener")
-    registerStandardClass(access,
-      "org.junit.jupiter.engine.extension.TimeoutExtension\$ExecutorResource")
   }
 
   private fun registerStandardClass(access: Feature.BeforeAnalysisAccess, name: String) {
-    val listener = access.findClassByName(name)
-    RuntimeReflection.register(listener)
-    listener.declaredConstructors.forEach {
+    val clazz: Class<*> = access.findClassByName(name) ?: throw IllegalStateException("Missing class $name")
+    RuntimeReflection.register(clazz)
+    clazz.declaredConstructors.forEach {
       RuntimeReflection.register(it)
     }
   }
@@ -98,4 +97,4 @@ class TestRegistration : Feature {
       RuntimeReflection.register(it)
     }
   }
-}
\ No newline at end of file
+}
diff --git a/okcurl/build.gradle.kts b/okcurl/build.gradle.kts
index 567a1e541..6c734ade9 100644
--- a/okcurl/build.gradle.kts
+++ b/okcurl/build.gradle.kts
@@ -50,7 +50,6 @@ graal {
   javaVersion("11")
 
   option("--no-fallback")
-  option("--allow-incomplete-classpath")
 
   if (Os.isFamily(Os.FAMILY_WINDOWS)) {
     // May be possible without, but autodetection is problematic on Windows 10
