diff --git a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/Adapters.kt b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/Adapters.kt
index 26b4e33aa..7b894e815 100644
--- a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/Adapters.kt
+++ b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/Adapters.kt
@@ -355,8 +355,8 @@ internal object Adapters {
       ByteString::class to OCTET_STRING,
       Unit::class to NULL,
       Nothing::class to OBJECT_IDENTIFIER,
-      String::class to UTF8_STRING,
-      Nothing::class to PRINTABLE_STRING,
+      Nothing::class to UTF8_STRING,
+      String::class to PRINTABLE_STRING,
       Nothing::class to IA5_STRING,
       Nothing::class to UTC_TIME,
       Long::class to GENERALIZED_TIME
diff --git a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/CertificateAdapters.kt b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/CertificateAdapters.kt
index dc86da2a8..27b4fd00a 100644
--- a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/CertificateAdapters.kt
+++ b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/CertificateAdapters.kt
@@ -16,7 +16,6 @@
 package okhttp3.tls.internal.der
 
 import java.math.BigInteger
-import okhttp3.tls.internal.der.Adapters.OCTET_STRING
 
 /**
  * ASN.1 adapters adapted from the specifications in [RFC 5280][rfc_5280].
@@ -51,8 +50,9 @@ internal object CertificateAdapters {
       time,
       decompose = {
         listOf(
-            Adapters.GENERALIZED_TIME to it.notBefore,
-            Adapters.GENERALIZED_TIME to it.notAfter
+            // TODO(jwilson): when to use GENERALIZED_TIME? It will still work in 2050.
+            Adapters.UTC_TIME to it.notBefore,
+            Adapters.UTC_TIME to it.notAfter
         )
       },
       construct = {
@@ -63,6 +63,18 @@ internal object CertificateAdapters {
       }
   )
 
+  val algorithmParameters = Adapters.usingTypeHint { typeHint ->
+    when (typeHint) {
+      // This type is pretty strange. The spec says that for certain algorithms we must encode null
+      // when it is present, and for others we must omit it!
+      // https://tools.ietf.org/html/rfc4055#section-2.1
+      ObjectIdentifiers.sha256WithRSAEncryption -> Adapters.NULL
+      ObjectIdentifiers.rsaEncryption -> Adapters.NULL
+      ObjectIdentifiers.ecPublicKey -> Adapters.OBJECT_IDENTIFIER
+      else -> null
+    }
+  }
+
   /**
    * ```
    * AlgorithmIdentifier ::= SEQUENCE  {
@@ -73,8 +85,8 @@ internal object CertificateAdapters {
    */
   internal val algorithmIdentifier = Adapters.sequence(
       "AlgorithmIdentifier",
-      Adapters.OBJECT_IDENTIFIER,
-      Adapters.any(isOptional = true, optionalValue = null),
+      Adapters.OBJECT_IDENTIFIER.asTypeHint(),
+      algorithmParameters,
       decompose = { listOf(it.algorithm, it.parameters) },
       construct = { AlgorithmIdentifier(it[0] as String, it[1]) }
   )
@@ -126,7 +138,7 @@ internal object CertificateAdapters {
    * GeneralNames ::= SEQUENCE SIZE (1..MAX) OF GeneralName
    * ```
    */
-  internal val subjectAltName = generalName.asSequenceOf()
+  internal val subjectAlternativeName = generalName.asSequenceOf()
 
   /**
    * This uses the preceding extension ID to select which adapter to use for the extension value
@@ -134,11 +146,15 @@ internal object CertificateAdapters {
    */
   internal val extensionValue = Adapters.usingTypeHint { typeHint ->
     when (typeHint) {
-      ObjectIdentifiers.subjectAltName -> subjectAltName
+      ObjectIdentifiers.subjectAlternativeName -> subjectAlternativeName
       ObjectIdentifiers.basicConstraints -> basicConstraints
       else -> null
     }
-  }.withExplicitBox(tagClass = OCTET_STRING.tagClass, tag = OCTET_STRING.tag)
+  }.withExplicitBox(
+      tagClass = Adapters.OCTET_STRING.tagClass,
+      tag = Adapters.OCTET_STRING.tag,
+      forceConstructed = false
+  )
 
   /**
    * ```
@@ -236,7 +252,7 @@ internal object CertificateAdapters {
    */
   internal val tbsCertificate = Adapters.sequence(
       "TBSCertificate",
-      Adapters.INTEGER_AS_LONG.withTag(tag = 0L).optional(defaultValue = 0), // v1 == 0
+      Adapters.INTEGER_AS_LONG.withExplicitBox(tag = 0L).optional(defaultValue = 0), // v1 == 0
       Adapters.INTEGER_AS_BIG_INTEGER,
       algorithmIdentifier,
       name,
diff --git a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/DerAdapter.kt b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/DerAdapter.kt
index 43f252909..f0c32d884 100644
--- a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/DerAdapter.kt
+++ b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/DerAdapter.kt
@@ -69,11 +69,17 @@ internal interface DerAdapter<T> {
   @Suppress("UNCHECKED_CAST") // read() produces a single element of the expected type.
   fun withExplicitBox(
     tagClass: Int = DerHeader.TAG_CLASS_CONTEXT_SPECIFIC,
-    tag: Long
+    tag: Long,
+    forceConstructed: Boolean? = null
   ): BasicDerAdapter<T> {
     val codec = object : BasicDerAdapter.Codec<T> {
       override fun decode(reader: DerReader) = readValue(reader)
-      override fun encode(writer: DerWriter, value: T) = writeValue(writer, value)
+      override fun encode(writer: DerWriter, value: T) {
+        writeValue(writer, value)
+        if (forceConstructed != null) {
+          writer.constructed = forceConstructed
+        }
+      }
     }
 
     return BasicDerAdapter(
diff --git a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/DerWriter.kt b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/DerWriter.kt
index 9c90e1a4f..c76776d0b 100644
--- a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/DerWriter.kt
+++ b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/DerWriter.kt
@@ -40,8 +40,11 @@ internal class DerWriter(sink: BufferedSink) {
   /** Names leading to the current location in the ASN.1 document. */
   private val path = mutableListOf<String>()
 
-  /** False unless we made a recursive call to [write] at the current stack frame. */
-  private var constructed = false
+  /**
+   * False unless we made a recursive call to [write] at the current stack frame. The explicit box
+   * adapter can clear this to synthesize non-constructed values that are embedded in octet strings.
+   */
+  var constructed = false
 
   fun write(name: String, tagClass: Int, tag: Long, block: (BufferedSink) -> Unit) {
     val constructedBit: Int
diff --git a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/ObjectIdentifiers.kt b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/ObjectIdentifiers.kt
index 2998deaad..99d0ed4f0 100644
--- a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/ObjectIdentifiers.kt
+++ b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/ObjectIdentifiers.kt
@@ -17,6 +17,11 @@ package okhttp3.tls.internal.der
 
 /** ASN.1 object identifiers used internally by this implementation. */
 internal object ObjectIdentifiers {
-  val subjectAltName = "2.5.29.17"
-  val basicConstraints = "2.5.29.19"
+  const val subjectAlternativeName = "2.5.29.17"
+  const val basicConstraints = "2.5.29.19"
+  const val commonName = "2.5.4.3"
+  const val organizationalUnitName = "2.5.4.11"
+  const val rsaEncryption = "1.2.840.113549.1.1.1"
+  const val sha256WithRSAEncryption = "1.2.840.113549.1.1.11"
+  const val ecPublicKey = "1.2.840.10045.2.1"
 }
diff --git a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/certificates.kt b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/certificates.kt
index 83a6b2b94..a79306683 100644
--- a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/certificates.kt
+++ b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/der/certificates.kt
@@ -21,7 +21,37 @@ internal data class Certificate(
   val tbsCertificate: TbsCertificate,
   val signatureAlgorithm: AlgorithmIdentifier,
   val signatureValue: BitString
-)
+) {
+  val commonName: Any?
+    get() {
+      return tbsCertificate.subject
+          .flatten()
+          .firstOrNull { it.type == ObjectIdentifiers.commonName }
+          ?.value
+    }
+
+  val organizationalUnitName: Any?
+    get() {
+      return tbsCertificate.subject
+          .flatten()
+          .firstOrNull { it.type == ObjectIdentifiers.organizationalUnitName }
+          ?.value
+    }
+
+  val subjectAlternativeNames: Extension
+    get() {
+      return tbsCertificate.extensions.first {
+        it.extnID == ObjectIdentifiers.subjectAlternativeName
+      }
+    }
+
+  val basicConstraints: Extension
+    get() {
+      return tbsCertificate.extensions.first {
+        it.extnID == ObjectIdentifiers.basicConstraints
+      }
+    }
+}
 
 internal data class TbsCertificate(
   /** Version ::= INTEGER { v1(0), v2(1), v3(2) } */
