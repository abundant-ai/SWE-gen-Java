diff --git a/mockwebserver/api/mockwebserver3.api b/mockwebserver/api/mockwebserver3.api
index ef2f07f75..a66953d49 100644
--- a/mockwebserver/api/mockwebserver3.api
+++ b/mockwebserver/api/mockwebserver3.api
@@ -171,6 +171,7 @@ public final class mockwebserver3/RecordedRequest {
 	public final fun getChunkSizes ()Ljava/util/List;
 	public final fun getFailure ()Ljava/io/IOException;
 	public final fun getHandshake ()Lokhttp3/Handshake;
+	public final fun getHandshakeServerNames ()Ljava/util/List;
 	public final fun getHeaders ()Lokhttp3/Headers;
 	public final fun getMethod ()Ljava/lang/String;
 	public final fun getPath ()Ljava/lang/String;
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/RecordedRequest.kt b/mockwebserver/src/main/kotlin/mockwebserver3/RecordedRequest.kt
index 056c1dd3c..bc50a4273 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/RecordedRequest.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/RecordedRequest.kt
@@ -25,6 +25,7 @@ import okhttp3.Handshake.Companion.handshake
 import okhttp3.Headers
 import okhttp3.HttpUrl
 import okhttp3.HttpUrl.Companion.toHttpUrlOrNull
+import okhttp3.internal.platform.Platform
 import okio.Buffer
 
 /** An HTTP request that came into the mock web server. */
@@ -69,15 +70,24 @@ class RecordedRequest(
   val handshake: Handshake?
   val requestUrl: HttpUrl?
 
+  /**
+   * Returns the name of the server the client requested via the SNI (Server Name Indication)
+   * attribute in the TLS handshake. Unlike the rest of the HTTP exchange, this name is sent in
+   * cleartext and may be monitored or blocked by a proxy or other middlebox.
+   */
+  val handshakeServerNames: List<String>
+
   init {
     if (socket is SSLSocket) {
       try {
         this.handshake = socket.session.handshake()
+        this.handshakeServerNames = Platform.get().getHandshakeServerNames(socket)
       } catch (e: IOException) {
         throw IllegalArgumentException(e)
       }
     } else {
       this.handshake = null
+      this.handshakeServerNames = listOf()
     }
 
     if (requestLine.isNotEmpty()) {
diff --git a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/TlsUtil.kt b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/TlsUtil.kt
index cd759cfc3..496d11a33 100644
--- a/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/TlsUtil.kt
+++ b/okhttp-tls/src/main/kotlin/okhttp3/tls/internal/TlsUtil.kt
@@ -38,6 +38,7 @@ object TlsUtil {
     val heldCertificate = HeldCertificate.Builder()
         .commonName("localhost")
         .addSubjectAlternativeName("localhost")
+        .addSubjectAlternativeName("localhost.localdomain")
         .build()
     return@lazy HandshakeCertificates.Builder()
         .heldCertificate(heldCertificate)
diff --git a/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/Android10Platform.kt b/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/Android10Platform.kt
index 71b56a86e..e887bd733 100644
--- a/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/Android10Platform.kt
+++ b/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/Android10Platform.kt
@@ -24,15 +24,15 @@ import javax.net.ssl.SSLSocketFactory
 import javax.net.ssl.X509TrustManager
 import okhttp3.Protocol
 import okhttp3.internal.SuppressSignatureCheck
-import okhttp3.internal.platform.android.AndroidSocketAdapter
 import okhttp3.internal.platform.android.Android10SocketAdapter
 import okhttp3.internal.platform.android.AndroidCertificateChainCleaner
+import okhttp3.internal.platform.android.AndroidSocketAdapter
 import okhttp3.internal.platform.android.BouncyCastleSocketAdapter
 import okhttp3.internal.platform.android.ConscryptSocketAdapter
 import okhttp3.internal.platform.android.DeferredSocketAdapter
 import okhttp3.internal.tls.CertificateChainCleaner
 
-/** Android 29+. */
+/** Android 10+ (API 29+). */
 @SuppressSignatureCheck
 class Android10Platform : Platform() {
   private val socketAdapters = listOfNotNull(
diff --git a/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/AndroidPlatform.kt b/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/AndroidPlatform.kt
index 5c564a5d4..1d11d9037 100644
--- a/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/AndroidPlatform.kt
+++ b/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/AndroidPlatform.kt
@@ -39,7 +39,7 @@ import okhttp3.internal.tls.BasicTrustRootIndex
 import okhttp3.internal.tls.CertificateChainCleaner
 import okhttp3.internal.tls.TrustRootIndex
 
-/** Android 5+. */
+/** Android 5 to 9 (API 21 to 28). */
 @SuppressSignatureCheck
 class AndroidPlatform : Platform() {
   private val socketAdapters = listOfNotNull(
@@ -107,6 +107,12 @@ class AndroidPlatform : Platform() {
     super.buildTrustRootIndex(trustManager)
   }
 
+  override fun getHandshakeServerNames(sslSocket: SSLSocket): List<String> {
+    // The superclass implementation requires APIs not available until API 24+.
+    if (Build.VERSION.SDK_INT < 24) return listOf()
+    return super.getHandshakeServerNames(sslSocket)
+  }
+
   /**
    * A trust manager for Android applications that customize the trust manager.
    *
diff --git a/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/Platform.kt b/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/Platform.kt
index 9e0c362d6..32826be0d 100644
--- a/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/Platform.kt
+++ b/okhttp/src/jvmMain/kotlin/okhttp3/internal/platform/Platform.kt
@@ -16,6 +16,7 @@
  */
 package okhttp3.internal.platform
 
+import android.annotation.SuppressLint
 import java.io.IOException
 import java.net.InetSocketAddress
 import java.net.Socket
@@ -24,6 +25,8 @@ import java.security.KeyStore
 import java.security.Security
 import java.util.logging.Level
 import java.util.logging.Logger
+import javax.net.ssl.ExtendedSSLSession
+import javax.net.ssl.SNIHostName
 import javax.net.ssl.SSLContext
 import javax.net.ssl.SSLSocket
 import javax.net.ssl.SSLSocketFactory
@@ -123,6 +126,13 @@ open class Platform {
   /** Returns the negotiated protocol, or null if no protocol was negotiated. */
   open fun getSelectedProtocol(sslSocket: SSLSocket): String? = null
 
+  /** For MockWebServer. This returns the inbound SNI names. */
+  @SuppressLint("NewApi")
+  open fun getHandshakeServerNames(sslSocket: SSLSocket): List<String> {
+    val session = sslSocket.session as? ExtendedSSLSession ?: return listOf()
+    return session.requestedServerNames.mapNotNull { (it as? SNIHostName)?.asciiName }
+  }
+
   @Throws(IOException::class)
   open fun connectSocket(socket: Socket, address: InetSocketAddress, connectTimeout: Int) {
     socket.connect(address, connectTimeout)
