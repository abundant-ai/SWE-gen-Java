diff --git a/mockwebserver/api/mockwebserver3.api b/mockwebserver/api/mockwebserver3.api
index ff41ce1f9..057b08ef1 100644
--- a/mockwebserver/api/mockwebserver3.api
+++ b/mockwebserver/api/mockwebserver3.api
@@ -17,11 +17,11 @@ public final class mockwebserver3/MockResponse {
 	public synthetic fun <init> (ILokhttp3/Headers;Ljava/lang/String;ZLmockwebserver3/SocketPolicy;IILkotlin/jvm/internal/DefaultConstructorMarker;)V
 	public synthetic fun <init> (Lmockwebserver3/MockResponse$Builder;Lkotlin/jvm/internal/DefaultConstructorMarker;)V
 	public final fun getBody ()Lokio/Buffer;
-	public final fun getBodyDelayNanos ()J
+	public final fun getBodyDelay (Ljava/util/concurrent/TimeUnit;)J
 	public final fun getCode ()I
 	public final fun getDuplexResponseBody ()Lmockwebserver3/internal/duplex/DuplexResponseBody;
 	public final fun getHeaders ()Lokhttp3/Headers;
-	public final fun getHeadersDelayNanos ()J
+	public final fun getHeadersDelay (Ljava/util/concurrent/TimeUnit;)J
 	public final fun getHttp2ErrorCode ()I
 	public final fun getInTunnel ()Z
 	public final fun getInformationalResponses ()Ljava/util/List;
@@ -31,7 +31,7 @@ public final class mockwebserver3/MockResponse {
 	public final fun getSocketPolicy ()Lmockwebserver3/SocketPolicy;
 	public final fun getStatus ()Ljava/lang/String;
 	public final fun getThrottleBytesPerPeriod ()J
-	public final fun getThrottlePeriodNanos ()J
+	public final fun getThrottlePeriod (Ljava/util/concurrent/TimeUnit;)J
 	public final fun getTrailers ()Lokhttp3/Headers;
 	public final fun getWebSocketListener ()Lokhttp3/WebSocketListener;
 	public final fun isDuplex ()Z
@@ -92,6 +92,13 @@ public final class mockwebserver3/MockResponse$Companion {
 
 public final class mockwebserver3/MockWebServer : java/io/Closeable {
 	public static final field Companion Lmockwebserver3/MockWebServer$Companion;
+	public final fun -deprecated_bodyLimit (J)V
+	public final fun -deprecated_port ()I
+	public final fun -deprecated_protocolNegotiationEnabled (Z)V
+	public final fun -deprecated_protocols ()Ljava/util/List;
+	public final fun -deprecated_protocols (Ljava/util/List;)V
+	public final fun -deprecated_requestCount ()I
+	public final fun -deprecated_serverSocketFactory (Ljavax/net/ServerSocketFactory;)V
 	public fun <init> ()V
 	public fun close ()V
 	public final fun enqueue (Lmockwebserver3/MockResponse;)V
@@ -101,11 +108,11 @@ public final class mockwebserver3/MockWebServer : java/io/Closeable {
 	public final fun getInetSocketAddress ()Ljava/net/InetSocketAddress;
 	public final fun getPort ()I
 	public final fun getProtocolNegotiationEnabled ()Z
-	public final fun getProtocols ()Ljava/util/List;
 	public final fun getRequestCount ()I
 	public final fun getServerSocketFactory ()Ljavax/net/ServerSocketFactory;
 	public final fun getStarted ()Z
 	public final fun noClientAuth ()V
+	public final fun protocols ()Ljava/util/List;
 	public final fun requestClientAuth ()V
 	public final fun requireClientAuth ()V
 	public final fun setBodyLimit (J)V
@@ -131,11 +138,15 @@ public final class mockwebserver3/MockWebServer$Companion {
 }
 
 public final class mockwebserver3/PushPromise {
+	public final fun -deprecated_headers ()Lokhttp3/Headers;
+	public final fun -deprecated_method ()Ljava/lang/String;
+	public final fun -deprecated_path ()Ljava/lang/String;
+	public final fun -deprecated_response ()Lmockwebserver3/MockResponse;
 	public fun <init> (Ljava/lang/String;Ljava/lang/String;Lokhttp3/Headers;Lmockwebserver3/MockResponse;)V
-	public final fun getHeaders ()Lokhttp3/Headers;
-	public final fun getMethod ()Ljava/lang/String;
-	public final fun getPath ()Ljava/lang/String;
-	public final fun getResponse ()Lmockwebserver3/MockResponse;
+	public final fun headers ()Lokhttp3/Headers;
+	public final fun method ()Ljava/lang/String;
+	public final fun path ()Ljava/lang/String;
+	public final fun response ()Lmockwebserver3/MockResponse;
 }
 
 public class mockwebserver3/QueueDispatcher : mockwebserver3/Dispatcher {
@@ -155,6 +166,8 @@ public final class mockwebserver3/QueueDispatcher$Companion {
 }
 
 public final class mockwebserver3/RecordedRequest {
+	public final fun -deprecated_utf8Body ()Ljava/lang/String;
+	public fun <init> (Ljava/lang/String;Lokhttp3/Headers;Ljava/util/List;JLokio/Buffer;ILjava/net/Socket;)V
 	public fun <init> (Ljava/lang/String;Lokhttp3/Headers;Ljava/util/List;JLokio/Buffer;ILjava/net/Socket;Ljava/io/IOException;)V
 	public synthetic fun <init> (Ljava/lang/String;Lokhttp3/Headers;Ljava/util/List;JLokio/Buffer;ILjava/net/Socket;Ljava/io/IOException;ILkotlin/jvm/internal/DefaultConstructorMarker;)V
 	public final fun getBody ()Lokio/Buffer;
@@ -162,12 +175,15 @@ public final class mockwebserver3/RecordedRequest {
 	public final fun getChunkSizes ()Ljava/util/List;
 	public final fun getFailure ()Ljava/io/IOException;
 	public final fun getHandshake ()Lokhttp3/Handshake;
+	public final fun getHeader (Ljava/lang/String;)Ljava/lang/String;
 	public final fun getHeaders ()Lokhttp3/Headers;
 	public final fun getMethod ()Ljava/lang/String;
 	public final fun getPath ()Ljava/lang/String;
 	public final fun getRequestLine ()Ljava/lang/String;
 	public final fun getRequestUrl ()Lokhttp3/HttpUrl;
 	public final fun getSequenceNumber ()I
+	public final fun getTlsVersion ()Lokhttp3/TlsVersion;
+	public final fun getUtf8Body ()Ljava/lang/String;
 	public fun toString ()Ljava/lang/String;
 }
 
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt b/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
index da7c2f240..af10cce60 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/MockResponse.kt
@@ -54,7 +54,8 @@ class MockResponse {
   val informationalResponses: List<MockResponse>
 
   val throttleBytesPerPeriod: Long
-  val throttlePeriodNanos: Long
+  private val throttlePeriodAmount: Long
+  private val throttlePeriodUnit: TimeUnit
 
   val socketPolicy: SocketPolicy
 
@@ -65,8 +66,11 @@ class MockResponse {
    */
   val http2ErrorCode: Int
 
-  val bodyDelayNanos: Long
-  val headersDelayNanos: Long
+  private val bodyDelayAmount: Long
+  private val bodyDelayUnit: TimeUnit
+
+  private val headersDelayAmount: Long
+  private var headersDelayUnit: TimeUnit
 
   val pushPromises: List<PushPromise>
 
@@ -105,11 +109,14 @@ class MockResponse {
     this.inTunnel = builder.inTunnel
     this.informationalResponses = builder.informationalResponses.toList()
     this.throttleBytesPerPeriod = builder.throttleBytesPerPeriod
-    this.throttlePeriodNanos = builder.throttlePeriodNanos
+    this.throttlePeriodAmount = builder.throttlePeriodAmount
+    this.throttlePeriodUnit = builder.throttlePeriodUnit
     this.socketPolicy = builder.socketPolicy
     this.http2ErrorCode = builder.http2ErrorCode
-    this.bodyDelayNanos = builder.bodyDelayNanos
-    this.headersDelayNanos = builder.headersDelayNanos
+    this.bodyDelayAmount = builder.bodyDelayAmount
+    this.bodyDelayUnit = builder.bodyDelayUnit
+    this.headersDelayAmount = builder.headersDelayAmount
+    this.headersDelayUnit = builder.headersDelayUnit
     this.pushPromises = builder.pushPromises.toList()
     this.settings = Settings().apply {
       merge(builder.settings)
@@ -118,6 +125,15 @@ class MockResponse {
     this.duplexResponseBody = builder.duplexResponseBody
   }
 
+  fun getThrottlePeriod(unit: TimeUnit): Long =
+    unit.convert(throttlePeriodAmount, throttlePeriodUnit)
+
+  fun getBodyDelay(unit: TimeUnit): Long =
+    unit.convert(bodyDelayAmount, bodyDelayUnit)
+
+  fun getHeadersDelay(unit: TimeUnit): Long =
+    unit.convert(headersDelayAmount, headersDelayUnit)
+
   fun newBuilder(): Builder = Builder(this)
 
   override fun toString(): String = status
@@ -156,15 +172,18 @@ class MockResponse {
 
     var throttleBytesPerPeriod: Long
       private set
-    internal var throttlePeriodNanos: Long
+    internal var throttlePeriodAmount: Long
+    internal var throttlePeriodUnit: TimeUnit
 
     var socketPolicy: SocketPolicy
 
     var http2ErrorCode: Int
 
-    internal var bodyDelayNanos: Long
+    internal var bodyDelayAmount: Long
+    internal var bodyDelayUnit: TimeUnit
 
-    internal var headersDelayNanos: Long
+    internal var headersDelayAmount: Long
+    internal var headersDelayUnit: TimeUnit
 
     /** The streams the server will push with this response. */
     val pushPromises: MutableList<PushPromise>
@@ -184,11 +203,14 @@ class MockResponse {
         .add("Content-Length", "0")
       this.trailers = Headers.Builder()
       this.throttleBytesPerPeriod = Long.MAX_VALUE
-      this.throttlePeriodNanos = 0L
+      this.throttlePeriodAmount = 1L
+      this.throttlePeriodUnit = TimeUnit.SECONDS
       this.socketPolicy = SocketPolicy.KEEP_OPEN
       this.http2ErrorCode = -1
-      this.bodyDelayNanos = 0L
-      this.headersDelayNanos = 0L
+      this.bodyDelayAmount = 0L
+      this.bodyDelayUnit = TimeUnit.MILLISECONDS
+      this.headersDelayAmount = 0L
+      this.headersDelayUnit = TimeUnit.MILLISECONDS
       this.pushPromises = mutableListOf()
       this.settings = Settings()
       this.webSocketListener = null
@@ -203,11 +225,14 @@ class MockResponse {
       this.trailers = mockResponse.trailers.newBuilder()
       this.body = mockResponse.body
       this.throttleBytesPerPeriod = mockResponse.throttleBytesPerPeriod
-      this.throttlePeriodNanos = mockResponse.throttlePeriodNanos
+      this.throttlePeriodAmount = mockResponse.throttlePeriodAmount
+      this.throttlePeriodUnit = mockResponse.throttlePeriodUnit
       this.socketPolicy = mockResponse.socketPolicy
       this.http2ErrorCode = mockResponse.http2ErrorCode
-      this.bodyDelayNanos = mockResponse.bodyDelayNanos
-      this.headersDelayNanos = mockResponse.headersDelayNanos
+      this.bodyDelayAmount = mockResponse.bodyDelayAmount
+      this.bodyDelayUnit = mockResponse.bodyDelayUnit
+      this.headersDelayAmount = mockResponse.headersDelayAmount
+      this.headersDelayUnit = mockResponse.headersDelayUnit
       this.pushPromises = mockResponse.pushPromises.toMutableList()
       this.settings = Settings().apply {
         merge(mockResponse.settings)
@@ -333,7 +358,8 @@ class MockResponse {
      */
     fun throttleBody(bytesPerPeriod: Long, period: Long, unit: TimeUnit) = apply {
       throttleBytesPerPeriod = bytesPerPeriod
-      throttlePeriodNanos = unit.toNanos(period)
+      throttlePeriodAmount = period
+      throttlePeriodUnit = unit
     }
 
     /**
@@ -341,11 +367,13 @@ class MockResponse {
      * only; response headers are not affected.
      */
     fun bodyDelay(delay: Long, unit: TimeUnit) = apply {
-      bodyDelayNanos = unit.toNanos(delay)
+      bodyDelayAmount = delay
+      bodyDelayUnit = unit
     }
 
     fun headersDelay(delay: Long, unit: TimeUnit) = apply {
-      headersDelayNanos = unit.toNanos(delay)
+      headersDelayAmount = delay
+      headersDelayUnit = unit
     }
 
     /**
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt b/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
index a6c5fdb17..7a9b58da6 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/MockWebServer.kt
@@ -176,7 +176,8 @@ class MockWebServer : Closeable {
    *
    * This list is ignored when [negotiation is disabled][protocolNegotiationEnabled].
    */
-  var protocols: List<Protocol> = immutableListOf(Protocol.HTTP_2, Protocol.HTTP_1_1)
+  @get:JvmName("protocols") var protocols: List<Protocol> =
+    immutableListOf(Protocol.HTTP_2, Protocol.HTTP_1_1)
     set(value) {
       val protocolList = value.toImmutableList()
       require(Protocol.H2_PRIOR_KNOWLEDGE !in protocolList || protocolList.size == 1) {
@@ -201,12 +202,32 @@ class MockWebServer : Closeable {
     }
   }
 
+  @JvmName("-deprecated_port")
+  @Deprecated(
+    message = "moved to val",
+    replaceWith = ReplaceWith(expression = "port"),
+    level = DeprecationLevel.ERROR
+  )
+  fun getPort(): Int = port
+
   fun toProxyAddress(): Proxy {
     before()
     val address = InetSocketAddress(_inetSocketAddress!!.address.canonicalHostName, port)
     return Proxy(Proxy.Type.HTTP, address)
   }
 
+  @JvmName("-deprecated_serverSocketFactory")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith = ReplaceWith(
+      expression = "run { this.serverSocketFactory = serverSocketFactory }"
+    ),
+    level = DeprecationLevel.ERROR
+  )
+  fun setServerSocketFactory(serverSocketFactory: ServerSocketFactory) = run {
+    this.serverSocketFactory = serverSocketFactory
+  }
+
   /**
    * Returns a URL for connecting to this server.
    *
@@ -221,6 +242,44 @@ class MockWebServer : Closeable {
       .resolve(path)!!
   }
 
+  @JvmName("-deprecated_bodyLimit")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith = ReplaceWith(
+      expression = "run { this.bodyLimit = bodyLimit }"
+    ),
+    level = DeprecationLevel.ERROR
+  )
+  fun setBodyLimit(bodyLimit: Long) = run { this.bodyLimit = bodyLimit }
+
+  @JvmName("-deprecated_protocolNegotiationEnabled")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith = ReplaceWith(
+      expression = "run { this.protocolNegotiationEnabled = protocolNegotiationEnabled }"
+    ),
+    level = DeprecationLevel.ERROR
+  )
+  fun setProtocolNegotiationEnabled(protocolNegotiationEnabled: Boolean) = run {
+    this.protocolNegotiationEnabled = protocolNegotiationEnabled
+  }
+
+  @JvmName("-deprecated_protocols")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith = ReplaceWith(expression = "run { this.protocols = protocols }"),
+    level = DeprecationLevel.ERROR
+  )
+  fun setProtocols(protocols: List<Protocol>) = run { this.protocols = protocols }
+
+  @JvmName("-deprecated_protocols")
+  @Deprecated(
+    message = "moved to var",
+    replaceWith = ReplaceWith(expression = "protocols"),
+    level = DeprecationLevel.ERROR
+  )
+  fun protocols(): List<Protocol> = protocols
+
   /**
    * Serve requests with HTTPS rather than otherwise.
    */
@@ -281,6 +340,14 @@ class MockWebServer : Closeable {
   fun takeRequest(timeout: Long, unit: TimeUnit): RecordedRequest? =
     requestQueue.poll(timeout, unit)
 
+  @JvmName("-deprecated_requestCount")
+  @Deprecated(
+    message = "moved to val",
+    replaceWith = ReplaceWith(expression = "requestCount"),
+    level = DeprecationLevel.ERROR
+  )
+  fun getRequestCount(): Int = requestCount
+
   /**
    * Scripts [response] to be returned to a request made in sequence. The first request is
    * served by the first enqueued response; the second request by the second enqueued response; and
@@ -567,8 +634,8 @@ class MockWebServer : Closeable {
 
       var reuseSocket = true
       val requestWantsWebSockets =
-        "Upgrade".equals(request.headers["Connection"], ignoreCase = true) &&
-          "websocket".equals(request.headers["Upgrade"], ignoreCase = true)
+        "Upgrade".equals(request.getHeader("Connection"), ignoreCase = true) &&
+          "websocket".equals(request.getHeader("Upgrade"), ignoreCase = true)
       val responseWantsWebSockets = response.webSocketListener != null
       if (requestWantsWebSockets && responseWantsWebSockets) {
         handleWebSocketUpgrade(socket, source, sink, request, response)
@@ -638,6 +705,7 @@ class MockWebServer : Closeable {
     val headers = Headers.Builder()
     var contentLength = -1L
     var chunked = false
+    var expectContinue = false
     val requestBody = TruncatingBuffer(bodyLimit)
     val chunkSizes = mutableListOf<Int>()
     var failure: IOException? = null
@@ -726,15 +794,15 @@ class MockWebServer : Closeable {
     request: RecordedRequest,
     response: MockResponse
   ) {
-    val key = request.headers["Sec-WebSocket-Key"]
+    val key = request.getHeader("Sec-WebSocket-Key")
     val webSocketResponse = response.newBuilder()
       .setHeader("Sec-WebSocket-Accept", WebSocketProtocol.acceptHeader(key!!))
       .build()
     writeHttpResponse(socket, sink, webSocketResponse)
 
     // Adapt the request and response into our Request and Response domain model.
-    val scheme = if (request.handshake != null) "https" else "http"
-    val authority = request.headers["Host"] // Has host and port.
+    val scheme = if (request.tlsVersion != null) "https" else "http"
+    val authority = request.getHeader("Host") // Has host and port.
     val fancyRequest = Request.Builder()
       .url("$scheme://$authority/")
       .headers(request.headers)
@@ -777,14 +845,14 @@ class MockWebServer : Closeable {
 
   @Throws(IOException::class)
   private fun writeHttpResponse(socket: Socket, sink: BufferedSink, response: MockResponse) {
-    sleepNanos(response.headersDelayNanos)
+    sleepIfDelayed(response.getHeadersDelay(TimeUnit.MILLISECONDS))
     sink.writeUtf8(response.status)
     sink.writeUtf8("\r\n")
 
     writeHeaders(sink, response.headers)
 
     val body = response.body ?: return
-    sleepNanos(response.bodyDelayNanos)
+    sleepIfDelayed(response.getBodyDelay(TimeUnit.MILLISECONDS))
     throttledTransfer(response, socket, body, sink, body.size, false)
 
     if ("chunked".equals(response.headers["Transfer-Encoding"], ignoreCase = true)) {
@@ -804,11 +872,9 @@ class MockWebServer : Closeable {
     sink.flush()
   }
 
-  private fun sleepNanos(nanos: Long) {
-    val ms = nanos / 1_000_000L
-    val ns = nanos - (ms * 1_000_000L)
-    if (ms > 0L || nanos > 0) {
-      Thread.sleep(ms, ns.toInt())
+  private fun sleepIfDelayed(delayMs: Long) {
+    if (delayMs != 0L) {
+      Thread.sleep(delayMs)
     }
   }
 
@@ -830,7 +896,7 @@ class MockWebServer : Closeable {
 
     val buffer = Buffer()
     val bytesPerPeriod = policy.throttleBytesPerPeriod
-    val periodDelayNanos = policy.throttlePeriodNanos
+    val periodDelayMs = policy.getThrottlePeriod(TimeUnit.MILLISECONDS)
 
     val halfByteCount = byteCountNum / 2
     val disconnectHalfway = if (isRequest) {
@@ -865,7 +931,7 @@ class MockWebServer : Closeable {
         if (byteCountNum == 0L) return
       }
 
-      sleepNanos(periodDelayNanos)
+      sleepIfDelayed(periodDelayMs)
     }
   }
 
@@ -988,7 +1054,7 @@ class MockWebServer : Closeable {
 
       val peek = dispatcher.peek()
       for (response in peek.informationalResponses) {
-        sleepNanos(response.headersDelayNanos)
+        sleepIfDelayed(response.getHeadersDelay(TimeUnit.MILLISECONDS))
         stream.writeHeaders(response.toHttp2Headers(), outFinished = false, flushHeaders = true)
         if (response.code == 100) {
           readBody = true
@@ -1049,18 +1115,18 @@ class MockWebServer : Closeable {
         return
       }
 
-      val bodyDelayNanos = response.bodyDelayNanos
+      val bodyDelayMs = response.getBodyDelay(TimeUnit.MILLISECONDS)
       val trailers = response.trailers
       val body = response.body
       val outFinished = (body == null &&
         response.pushPromises.isEmpty() &&
         !response.isDuplex)
-      val flushHeaders = body == null || bodyDelayNanos != 0L
+      val flushHeaders = body == null || bodyDelayMs != 0L
       require(!outFinished || trailers.size == 0) {
         "unsupported: no body and non-empty trailers $trailers"
       }
 
-      sleepNanos(response.headersDelayNanos)
+      sleepIfDelayed(response.getHeadersDelay(TimeUnit.MILLISECONDS))
       stream.writeHeaders(response.toHttp2Headers(), outFinished, flushHeaders)
 
       if (trailers.size > 0) {
@@ -1069,7 +1135,7 @@ class MockWebServer : Closeable {
       pushPromises(stream, request, response.pushPromises)
       if (body != null) {
         stream.getSink().buffer().use { sink ->
-          sleepNanos(bodyDelayNanos)
+          sleepIfDelayed(bodyDelayMs)
           throttledTransfer(response, socket, body, sink, body.size, false)
         }
       } else if (response.isDuplex) {
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/PushPromise.kt b/mockwebserver/src/main/kotlin/mockwebserver3/PushPromise.kt
index 474830bb8..286f19924 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/PushPromise.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/PushPromise.kt
@@ -19,8 +19,37 @@ import okhttp3.Headers
 
 /** An HTTP request initiated by the server. */
 class PushPromise(
-  val method: String,
-  val path: String,
-  val headers: Headers,
-  val response: MockResponse,
-)
+  @get:JvmName("method") val method: String,
+  @get:JvmName("path") val path: String,
+  @get:JvmName("headers") val headers: Headers,
+  @get:JvmName("response") val response: MockResponse
+) {
+
+  @JvmName("-deprecated_method")
+  @Deprecated(
+      message = "moved to val",
+      replaceWith = ReplaceWith(expression = "method"),
+      level = DeprecationLevel.ERROR)
+  fun method(): String = method
+
+  @JvmName("-deprecated_path")
+  @Deprecated(
+      message = "moved to val",
+      replaceWith = ReplaceWith(expression = "path"),
+      level = DeprecationLevel.ERROR)
+  fun path(): String = path
+
+  @JvmName("-deprecated_headers")
+  @Deprecated(
+      message = "moved to val",
+      replaceWith = ReplaceWith(expression = "headers"),
+      level = DeprecationLevel.ERROR)
+  fun headers(): Headers = headers
+
+  @JvmName("-deprecated_response")
+  @Deprecated(
+      message = "moved to val",
+      replaceWith = ReplaceWith(expression = "response"),
+      level = DeprecationLevel.ERROR)
+  fun response(): MockResponse = response
+}
diff --git a/mockwebserver/src/main/kotlin/mockwebserver3/RecordedRequest.kt b/mockwebserver/src/main/kotlin/mockwebserver3/RecordedRequest.kt
index 056c1dd3c..98dda2b5a 100644
--- a/mockwebserver/src/main/kotlin/mockwebserver3/RecordedRequest.kt
+++ b/mockwebserver/src/main/kotlin/mockwebserver3/RecordedRequest.kt
@@ -25,10 +25,11 @@ import okhttp3.Handshake.Companion.handshake
 import okhttp3.Headers
 import okhttp3.HttpUrl
 import okhttp3.HttpUrl.Companion.toHttpUrlOrNull
+import okhttp3.TlsVersion
 import okio.Buffer
 
 /** An HTTP request that came into the mock web server. */
-class RecordedRequest(
+class RecordedRequest @JvmOverloads constructor(
   val requestLine: String,
 
   /** All headers. */
@@ -69,6 +70,18 @@ class RecordedRequest(
   val handshake: Handshake?
   val requestUrl: HttpUrl?
 
+  @get:JvmName("-deprecated_utf8Body")
+  @Deprecated(
+      message = "Use body.readUtf8()",
+      replaceWith = ReplaceWith("body.readUtf8()"),
+      level = DeprecationLevel.ERROR)
+  val utf8Body: String
+    get() = body.readUtf8()
+
+  /** Returns the connection's TLS version or null if the connection doesn't use SSL. */
+  val tlsVersion: TlsVersion?
+    get() = handshake?.tlsVersion
+
   init {
     if (socket is SSLSocket) {
       try {
@@ -108,5 +121,14 @@ class RecordedRequest(
     }
   }
 
+  @Deprecated(
+      message = "Use body.readUtf8()",
+      replaceWith = ReplaceWith("body.readUtf8()"),
+      level = DeprecationLevel.WARNING)
+  fun getUtf8Body(): String = body.readUtf8()
+
+  /** Returns the first header named [name], or null if no such header exists. */
+  fun getHeader(name: String): String? = headers.values(name).firstOrNull()
+
   override fun toString(): String = requestLine
 }
diff --git a/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.java b/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.java
index 06e28f164..da03bdebf 100644
--- a/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.java
+++ b/mockwebserver/src/test/java/mockwebserver3/MockWebServerTest.java
@@ -160,7 +160,7 @@ public final class MockWebServerTest {
 
     RecordedRequest request = server.takeRequest();
     assertThat(request.getRequestLine()).isEqualTo("GET / HTTP/1.1");
-    assertThat(request.getHeaders().get("Accept-Language")).isEqualTo("en-US");
+    assertThat(request.getHeader("Accept-Language")).isEqualTo("en-US");
 
     // Server has no more requests.
     assertThat(server.takeRequest(100, MILLISECONDS)).isNull();
diff --git a/okhttp-sse/src/test/java/okhttp3/sse/internal/EventSourceHttpTest.java b/okhttp-sse/src/test/java/okhttp3/sse/internal/EventSourceHttpTest.java
index 2e7fbf98e..4c3d0110f 100644
--- a/okhttp-sse/src/test/java/okhttp3/sse/internal/EventSourceHttpTest.java
+++ b/okhttp-sse/src/test/java/okhttp3/sse/internal/EventSourceHttpTest.java
@@ -156,7 +156,7 @@ public final class EventSourceHttpTest {
     listener.assertEvent(null, null, "hey");
     listener.assertClose();
 
-    assertThat(server.takeRequest().getHeaders().get("Accept")).isEqualTo("text/plain");
+    assertThat(server.takeRequest().getHeader("Accept")).isEqualTo("text/plain");
   }
 
   @Test public void setsMissingAccept() throws InterruptedException {
@@ -172,7 +172,7 @@ public final class EventSourceHttpTest {
     listener.assertEvent(null, null, "hey");
     listener.assertClose();
 
-    assertThat(server.takeRequest().getHeaders().get("Accept")).isEqualTo("text/event-stream");
+    assertThat(server.takeRequest().getHeader("Accept")).isEqualTo("text/event-stream");
   }
 
   private EventSource newEventSource() {
diff --git a/okhttp/src/jvmTest/java/okhttp3/CacheTest.java b/okhttp/src/jvmTest/java/okhttp3/CacheTest.java
index 857ef732a..e7992d24d 100644
--- a/okhttp/src/jvmTest/java/okhttp3/CacheTest.java
+++ b/okhttp/src/jvmTest/java/okhttp3/CacheTest.java
@@ -652,8 +652,8 @@ public final class CacheTest {
         .addHeader("Last-Modified: " + lastModifiedDate)
         .addHeader("Date: " + formatDate(-15, TimeUnit.SECONDS))
         .build());
-    assertThat(conditionalRequest.getHeaders().get("If-Modified-Since"))
-        .isEqualTo(lastModifiedDate);
+    assertThat(conditionalRequest.getHeader("If-Modified-Since")).isEqualTo(
+        lastModifiedDate);
   }
 
   @Test public void defaultExpirationDateFullyCachedForMoreThan24Hours() throws Exception {
@@ -695,8 +695,8 @@ public final class CacheTest {
         .addHeader("Last-Modified: " + lastModifiedDate)
         .addHeader("Expires: " + formatDate(-1, TimeUnit.HOURS))
         .build());
-    assertThat(conditionalRequest.getHeaders().get("If-Modified-Since"))
-        .isEqualTo(lastModifiedDate);
+    assertThat(conditionalRequest.getHeader("If-Modified-Since")).isEqualTo(
+        lastModifiedDate);
   }
 
   @Test public void expirationDateInThePastWithNoLastModifiedHeader() throws Exception {
@@ -726,8 +726,8 @@ public final class CacheTest {
         .addHeader("Last-Modified: " + lastModifiedDate)
         .addHeader("Cache-Control: max-age=60")
         .build());
-    assertThat(conditionalRequest.getHeaders().get("If-Modified-Since"))
-        .isEqualTo(lastModifiedDate);
+    assertThat(conditionalRequest.getHeader("If-Modified-Since")).isEqualTo(
+        lastModifiedDate);
   }
 
   @Test public void maxAgeInThePastWithDateHeaderButNoLastModifiedHeader() throws Exception {
@@ -954,7 +954,7 @@ public final class CacheTest {
     RecordedRequest conditionalRequest = assertConditionallyCached(new MockResponse.Builder()
         .addHeader("ETag: v1")
         .build());
-    assertThat(conditionalRequest.getHeaders().get("If-None-Match")).isEqualTo("v1");
+    assertThat(conditionalRequest.getHeader("If-None-Match")).isEqualTo("v1");
   }
 
   /** If both If-Modified-Since and If-None-Match conditions apply, send only If-None-Match. */
@@ -965,8 +965,8 @@ public final class CacheTest {
         .addHeader("Last-Modified: " + lastModifiedDate)
         .addHeader("Expires: " + formatDate(-1, TimeUnit.HOURS))
         .build());
-    assertThat(conditionalRequest.getHeaders().get("If-None-Match")).isEqualTo("v1");
-    assertThat(conditionalRequest.getHeaders().get("If-Modified-Since")).isNull();
+    assertThat(conditionalRequest.getHeader("If-None-Match")).isEqualTo("v1");
+    assertThat(conditionalRequest.getHeader("If-Modified-Since")).isNull();
   }
 
   @Test public void etagAndExpirationDateInTheFuture() throws Exception {
@@ -990,8 +990,8 @@ public final class CacheTest {
         .addHeader("Expires: " + formatDate(1, TimeUnit.HOURS))
         .addHeader("Cache-Control: no-cache")
         .build());
-    assertThat(conditionalRequest.getHeaders().get("If-Modified-Since"))
-        .isEqualTo(lastModifiedDate);
+    assertThat(conditionalRequest.getHeader("If-Modified-Since")).isEqualTo(
+        lastModifiedDate);
   }
 
   @Test public void pragmaNoCache() throws Exception {
@@ -1007,8 +1007,8 @@ public final class CacheTest {
         .addHeader("Expires: " + formatDate(1, TimeUnit.HOURS))
         .addHeader("Pragma: no-cache")
         .build());
-    assertThat(conditionalRequest.getHeaders().get("If-Modified-Since"))
-        .isEqualTo(lastModifiedDate);
+    assertThat(conditionalRequest.getHeader("If-Modified-Since")).isEqualTo(
+        lastModifiedDate);
   }
 
   @Test public void cacheControlNoStore() throws Exception {
@@ -1468,8 +1468,8 @@ public final class CacheTest {
     String ifModifiedSinceDate = formatDate(-24, TimeUnit.HOURS);
     RecordedRequest request =
         assertClientSuppliedCondition(response, "If-Modified-Since", ifModifiedSinceDate);
-    assertThat(request.getHeaders().get("If-Modified-Since")).isEqualTo(ifModifiedSinceDate);
-    assertThat(request.getHeaders().get("If-None-Match")).isNull();
+    assertThat(request.getHeader("If-Modified-Since")).isEqualTo(ifModifiedSinceDate);
+    assertThat(request.getHeader("If-None-Match")).isNull();
   }
 
   @Test public void clientSuppliedIfNoneMatchSinceWithCachedResult() throws Exception {
@@ -1480,8 +1480,8 @@ public final class CacheTest {
         .addHeader("Cache-Control: max-age=0")
         .build();
     RecordedRequest request = assertClientSuppliedCondition(response, "If-None-Match", "v1");
-    assertThat(request.getHeaders().get("If-None-Match")).isEqualTo("v1");
-    assertThat(request.getHeaders().get("If-Modified-Since")).isNull();
+    assertThat(request.getHeader("If-None-Match")).isEqualTo("v1");
+    assertThat(request.getHeader("If-Modified-Since")).isNull();
   }
 
   private RecordedRequest assertClientSuppliedCondition(MockResponse seed, String conditionName,
@@ -1536,11 +1536,11 @@ public final class CacheTest {
 
     // The first request has no conditions.
     RecordedRequest request1 = server.takeRequest();
-    assertThat(request1.getHeaders().get("If-Modified-Since")).isNull();
+    assertThat(request1.getHeader("If-Modified-Since")).isNull();
 
     // The 2nd request uses the server's date format.
     RecordedRequest request2 = server.takeRequest();
-    assertThat(request2.getHeaders().get("If-Modified-Since")).isEqualTo(lastModifiedString);
+    assertThat(request2.getHeader("If-Modified-Since")).isEqualTo(lastModifiedString);
   }
 
   @Test public void clientSuppliedConditionWithoutCachedResult() throws Exception {
@@ -2613,10 +2613,10 @@ public final class CacheTest {
     assertThat(get(url).body().string()).isEqualTo("B");
     assertThat(get(url).body().string()).isEqualTo("B");
 
-    assertThat(server.takeRequest().getHeaders().get("If-None-Match")).isNull();
-    assertThat(server.takeRequest().getHeaders().get("If-None-Match")).isEqualTo("v1");
-    assertThat(server.takeRequest().getHeaders().get("If-None-Match")).isEqualTo("v1");
-    assertThat(server.takeRequest().getHeaders().get("If-None-Match")).isEqualTo("v2");
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isNull();
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isEqualTo("v1");
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isEqualTo("v1");
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isEqualTo("v2");
   }
 
   @Test public void combinedCacheHeadersCanBeNonAscii() throws Exception {
@@ -2663,8 +2663,8 @@ public final class CacheTest {
     Response response2 = get(server.url("/"));
     assertThat(response2.body().string()).isEqualTo("abcd");
 
-    assertThat(server.takeRequest().getHeaders().get("If-None-Match")).isNull();
-    assertThat(server.takeRequest().getHeaders().get("If-None-Match")).isEqualTo("α");
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isNull();
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isEqualTo("α");
   }
 
   @Test public void conditionalHitHeadersCombined() throws Exception {
@@ -2825,8 +2825,8 @@ public final class CacheTest {
         .addHeader("Last-Modified: " + lastModifiedDate)
         .addHeader("Date: " + formatDate(-15, TimeUnit.SECONDS))
         .build());
-    assertThat(conditionalRequest.getHeaders().get("If-Modified-Since"))
-        .isEqualTo(lastModifiedDate);
+    assertThat(conditionalRequest.getHeader("If-Modified-Since")).isEqualTo(
+        lastModifiedDate);
   }
 
   @Test
diff --git a/okhttp/src/jvmTest/java/okhttp3/CallTest.kt b/okhttp/src/jvmTest/java/okhttp3/CallTest.kt
index be756609b..ee0bb67a0 100644
--- a/okhttp/src/jvmTest/java/okhttp3/CallTest.kt
+++ b/okhttp/src/jvmTest/java/okhttp3/CallTest.kt
@@ -168,9 +168,9 @@ open class CallTest {
       .assertReceivedResponseAtMillis(sentAt, receivedAt)
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.method).isEqualTo("GET")
-    assertThat(recordedRequest.headers["User-Agent"]).isEqualTo("SyncApiTest")
+    assertThat(recordedRequest.getHeader("User-Agent")).isEqualTo("SyncApiTest")
     assertThat(recordedRequest.body.size).isEqualTo(0)
-    assertThat(recordedRequest.headers["Content-Length"]).isNull()
+    assertThat(recordedRequest.getHeader("Content-Length")).isNull()
   }
 
   @Test
@@ -271,9 +271,9 @@ open class CallTest {
       .assertHeader("Content-Type", "text/plain")
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.method).isEqualTo("HEAD")
-    assertThat(recordedRequest.headers["User-Agent"]).isEqualTo("SyncApiTest")
+    assertThat(recordedRequest.getHeader("User-Agent")).isEqualTo("SyncApiTest")
     assertThat(recordedRequest.body.size).isEqualTo(0)
-    assertThat(recordedRequest.headers["Content-Length"]).isNull()
+    assertThat(recordedRequest.getHeader("Content-Length")).isNull()
   }
 
   @Test
@@ -350,8 +350,8 @@ open class CallTest {
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.method).isEqualTo("POST")
     assertThat(recordedRequest.body.readUtf8()).isEqualTo("def")
-    assertThat(recordedRequest.headers["Content-Length"]).isEqualTo("3")
-    assertThat(recordedRequest.headers["Content-Type"]).isEqualTo("text/plain; charset=utf-8")
+    assertThat(recordedRequest.getHeader("Content-Length")).isEqualTo("3")
+    assertThat(recordedRequest.getHeader("Content-Type")).isEqualTo("text/plain; charset=utf-8")
   }
 
   @Test
@@ -379,8 +379,8 @@ open class CallTest {
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.method).isEqualTo("POST")
     assertThat(recordedRequest.body.size).isEqualTo(0)
-    assertThat(recordedRequest.headers["Content-Length"]).isEqualTo("0")
-    assertThat(recordedRequest.headers["Content-Type"]).isNull()
+    assertThat(recordedRequest.getHeader("Content-Length")).isEqualTo("0")
+    assertThat(recordedRequest.getHeader("Content-Type")).isNull()
   }
 
   @Test
@@ -447,11 +447,11 @@ open class CallTest {
     val recordedRequest1 = server.takeRequest()
     assertThat(recordedRequest1.method).isEqualTo("POST")
     assertThat(recordedRequest1.body.readUtf8()).isEqualTo(body)
-    assertThat(recordedRequest1.headers["Authorization"]).isNull()
+    assertThat(recordedRequest1.getHeader("Authorization")).isNull()
     val recordedRequest2 = server.takeRequest()
     assertThat(recordedRequest2.method).isEqualTo("POST")
     assertThat(recordedRequest2.body.readUtf8()).isEqualTo(body)
-    assertThat(recordedRequest2.headers["Authorization"]).isEqualTo(credential)
+    assertThat(recordedRequest2.getHeader("Authorization")).isEqualTo(credential)
   }
 
   @Test
@@ -521,8 +521,8 @@ open class CallTest {
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.method).isEqualTo("DELETE")
     assertThat(recordedRequest.body.size).isEqualTo(0)
-    assertThat(recordedRequest.headers["Content-Length"]).isEqualTo("0")
-    assertThat(recordedRequest.headers["Content-Type"]).isNull()
+    assertThat(recordedRequest.getHeader("Content-Length")).isEqualTo("0")
+    assertThat(recordedRequest.getHeader("Content-Type")).isNull()
   }
 
   @Test
@@ -565,8 +565,8 @@ open class CallTest {
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.method).isEqualTo("PUT")
     assertThat(recordedRequest.body.readUtf8()).isEqualTo("def")
-    assertThat(recordedRequest.headers["Content-Length"]).isEqualTo("3")
-    assertThat(recordedRequest.headers["Content-Type"]).isEqualTo(
+    assertThat(recordedRequest.getHeader("Content-Length")).isEqualTo("3")
+    assertThat(recordedRequest.getHeader("Content-Type")).isEqualTo(
       "text/plain; charset=utf-8"
     )
   }
@@ -596,8 +596,8 @@ open class CallTest {
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.method).isEqualTo("PATCH")
     assertThat(recordedRequest.body.readUtf8()).isEqualTo("def")
-    assertThat(recordedRequest.headers["Content-Length"]).isEqualTo("3")
-    assertThat(recordedRequest.headers["Content-Type"]).isEqualTo("text/plain; charset=utf-8")
+    assertThat(recordedRequest.getHeader("Content-Length")).isEqualTo("3")
+    assertThat(recordedRequest.getHeader("Content-Type")).isEqualTo("text/plain; charset=utf-8")
   }
 
   @Test
@@ -625,8 +625,8 @@ open class CallTest {
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.method).isEqualTo("CUSTOM")
     assertThat(recordedRequest.body.readUtf8()).isEqualTo("def")
-    assertThat(recordedRequest.headers["Content-Length"]).isEqualTo("3")
-    assertThat(recordedRequest.headers["Content-Type"])
+    assertThat(recordedRequest.getHeader("Content-Length")).isEqualTo("3")
+    assertThat(recordedRequest.getHeader("Content-Type"))
       .isEqualTo("text/plain; charset=utf-8")
   }
 
@@ -639,8 +639,8 @@ open class CallTest {
       .build()
     executeSynchronously(request).assertCode(200)
     val recordedRequest = server.takeRequest()
-    assertThat(recordedRequest.headers["Content-Type"]).isNull()
-    assertThat(recordedRequest.headers["Content-Length"]).isEqualTo("3")
+    assertThat(recordedRequest.getHeader("Content-Type")).isNull()
+    assertThat(recordedRequest.getHeader("Content-Length")).isEqualTo("3")
     assertThat(recordedRequest.body.readUtf8()).isEqualTo("abc")
   }
 
@@ -671,7 +671,7 @@ open class CallTest {
     } catch (e: IllegalStateException) {
       assertThat(e.message).isEqualTo("Already Executed")
     }
-    assertThat(server.takeRequest().headers["User-Agent"]).isEqualTo("SyncApiTest")
+    assertThat(server.takeRequest().getHeader("User-Agent")).isEqualTo("SyncApiTest")
   }
 
   @Test
@@ -700,7 +700,7 @@ open class CallTest {
     } catch (e: IllegalStateException) {
       assertThat(e.message).isEqualTo("Already Executed")
     }
-    assertThat(server.takeRequest().headers["User-Agent"]).isEqualTo("SyncApiTest")
+    assertThat(server.takeRequest().getHeader("User-Agent")).isEqualTo("SyncApiTest")
     callback.await(request.url).assertSuccessful()
   }
 
@@ -752,7 +752,7 @@ open class CallTest {
       .assertCode(200)
       .assertHeader("Content-Type", "text/plain")
       .assertBody("abc")
-    assertThat(server.takeRequest().headers["User-Agent"]).isEqualTo("AsyncApiTest")
+    assertThat(server.takeRequest().getHeader("User-Agent")).isEqualTo("AsyncApiTest")
   }
 
   @Test
@@ -1495,8 +1495,8 @@ open class CallTest {
       .assertBody("abc")
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.body.readUtf8()).isEqualTo("def")
-    assertThat(recordedRequest.headers["Content-Length"]).isEqualTo("3")
-    assertThat(recordedRequest.headers["Content-Type"]).isEqualTo("text/plain; charset=utf-8")
+    assertThat(recordedRequest.getHeader("Content-Length")).isEqualTo("3")
+    assertThat(recordedRequest.getHeader("Content-Type")).isEqualTo("text/plain; charset=utf-8")
   }
 
   @Test
@@ -1610,7 +1610,7 @@ open class CallTest {
       .assertCode(200)
       .assertBody("A")
     val request1ReceivedAt = System.currentTimeMillis()
-    assertThat(server.takeRequest().headers["If-None-Match"]).isNull()
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isNull()
 
     // Hit that stored response. It's different, but Vary says it doesn't matter.
     Thread.sleep(10) // Make sure the timestamps are unique.
@@ -1684,7 +1684,7 @@ open class CallTest {
       .assertHeader("Donut", "a")
       .assertBody("A")
     val request1ReceivedAt = System.currentTimeMillis()
-    assertThat(server.takeRequest().headers["If-None-Match"]).isNull()
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isNull()
 
     // Hit that stored response. It's different, but Vary says it doesn't matter.
     Thread.sleep(10) // Make sure the timestamps are unique.
@@ -1693,7 +1693,7 @@ open class CallTest {
       "/", "Accept-Language", "en-US", "Accept-Charset", "UTF-8"
     )
     val request2ReceivedAt = System.currentTimeMillis()
-    assertThat(server.takeRequest().headers["If-None-Match"]).isEqualTo("v1")
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isEqualTo("v1")
 
     // Check the merged response. The request is the application's original request.
     cacheHit.assertCode(200)
@@ -1748,11 +1748,11 @@ open class CallTest {
     val request1 = Request(server.url("/"))
     client.newCall(request1).enqueue(callback)
     callback.await(request1.url).assertCode(200).assertBody("A")
-    assertThat(server.takeRequest().headers["If-None-Match"]).isNull()
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isNull()
     val request2 = Request(server.url("/"))
     client.newCall(request2).enqueue(callback)
     callback.await(request2.url).assertCode(200).assertBody("A")
-    assertThat(server.takeRequest().headers["If-None-Match"]).isEqualTo("v1")
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isEqualTo("v1")
   }
 
   @Test
@@ -1781,7 +1781,7 @@ open class CallTest {
       .assertCode(200)
       .assertBody("A")
     val request1ReceivedAt = System.currentTimeMillis()
-    assertThat(server.takeRequest().headers["If-None-Match"]).isNull()
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isNull()
 
     // Different request, but Vary says it doesn't matter.
     Thread.sleep(10) // Make sure the timestamps are unique.
@@ -1790,7 +1790,7 @@ open class CallTest {
       "/", "Accept-Language", "en-US", "Accept-Charset", "UTF-8"
     )
     val request2ReceivedAt = System.currentTimeMillis()
-    assertThat(server.takeRequest().headers["If-None-Match"]).isEqualTo("v1")
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isEqualTo("v1")
 
     // Check the user response. It has the application's original request.
     cacheMiss.assertCode(200)
@@ -1834,11 +1834,11 @@ open class CallTest {
     val request1 = Request(server.url("/"))
     client.newCall(request1).enqueue(callback)
     callback.await(request1.url).assertCode(200).assertBody("A")
-    assertThat(server.takeRequest().headers["If-None-Match"]).isNull()
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isNull()
     val request2 = Request(server.url("/"))
     client.newCall(request2).enqueue(callback)
     callback.await(request2.url).assertCode(200).assertBody("B")
-    assertThat(server.takeRequest().headers["If-None-Match"]).isEqualTo("v1")
+    assertThat(server.takeRequest().getHeader("If-None-Match")).isEqualTo("v1")
   }
 
   @Test
@@ -2225,7 +2225,7 @@ open class CallTest {
       .build()
     executeSynchronously("/").assertCode(200)
     val recordedRequest = server.takeRequest()
-    assertThat(recordedRequest.headers["Cookie"]).isEqualTo("a=b; c=d")
+    assertThat(recordedRequest.getHeader("Cookie")).isEqualTo("a=b; c=d")
   }
 
   @Test
@@ -2250,9 +2250,9 @@ open class CallTest {
     val response = client.newCall(Request(server.url("/page1"))).execute()
     assertThat(response.body.string()).isEqualTo("Page 2")
     val request1 = server.takeRequest()
-    assertThat(request1.headers["Cookie"]).isEqualTo("c=cookie")
+    assertThat(request1.getHeader("Cookie")).isEqualTo("c=cookie")
     val request2 = server2.takeRequest()
-    assertThat(request2.headers["Cookie"]).isNull()
+    assertThat(request2.getHeader("Cookie")).isNull()
   }
 
   @Test
@@ -2272,7 +2272,7 @@ open class CallTest {
     val response = client.newCall(request).execute()
     assertThat(response.body.string()).isEqualTo("Page 2")
     val redirectRequest = server2.takeRequest()
-    assertThat(redirectRequest.headers["Authorization"]).isNull()
+    assertThat(redirectRequest.getHeader("Authorization")).isNull()
     assertThat(redirectRequest.path).isEqualTo("/b")
   }
 
@@ -2792,7 +2792,7 @@ open class CallTest {
 
     // The request did not offer gzip support.
     val recordedRequest = server.takeRequest()
-    assertThat(recordedRequest.headers["Accept-Encoding"]).isNull()
+    assertThat(recordedRequest.getHeader("Accept-Encoding")).isNull()
   }
 
   @Test
@@ -2837,7 +2837,7 @@ open class CallTest {
     server.enqueue(MockResponse())
     executeSynchronously("/")
     val recordedRequest = server.takeRequest()
-    assertThat(recordedRequest.headers["User-Agent"]).matches(userAgent)
+    assertThat(recordedRequest.getHeader("User-Agent")).matches(userAgent)
   }
 
   @Test
@@ -3174,13 +3174,13 @@ open class CallTest {
       "encrypted response from the origin server"
     )
     val connect = server.takeRequest()
-    assertThat(connect.headers["Private"]).isNull()
-    assertThat(connect.headers["User-Agent"]).isEqualTo(userAgent)
-    assertThat(connect.headers["Proxy-Connection"]).isEqualTo("Keep-Alive")
-    assertThat(connect.headers["Host"]).isEqualTo("android.com:443")
+    assertThat(connect.getHeader("Private")).isNull()
+    assertThat(connect.getHeader("User-Agent")).isEqualTo(userAgent)
+    assertThat(connect.getHeader("Proxy-Connection")).isEqualTo("Keep-Alive")
+    assertThat(connect.getHeader("Host")).isEqualTo("android.com:443")
     val get = server.takeRequest()
-    assertThat(get.headers["Private"]).isEqualTo("Secret")
-    assertThat(get.headers["User-Agent"]).isEqualTo("App 1.0")
+    assertThat(get.getHeader("Private")).isEqualTo("Secret")
+    assertThat(get.getHeader("User-Agent")).isEqualTo("App 1.0")
     assertThat(hostnameVerifier.calls).containsExactly("verify android.com")
   }
 
@@ -3244,13 +3244,13 @@ open class CallTest {
     assertThat(response.body.string()).isEqualTo("response body")
     val connect1 = server.takeRequest()
     assertThat(connect1.requestLine).isEqualTo("CONNECT android.com:443 HTTP/1.1")
-    assertThat(connect1.headers["Proxy-Authorization"]).isNull()
+    assertThat(connect1.getHeader("Proxy-Authorization")).isNull()
     val connect2 = server.takeRequest()
     assertThat(connect2.requestLine).isEqualTo("CONNECT android.com:443 HTTP/1.1")
-    assertThat(connect2.headers["Proxy-Authorization"]).isEqualTo("password")
+    assertThat(connect2.getHeader("Proxy-Authorization")).isEqualTo("password")
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET /foo HTTP/1.1")
-    assertThat(get.headers["Proxy-Authorization"]).isNull()
+    assertThat(get.getHeader("Proxy-Authorization")).isNull()
   }
 
   /** Confirm that the proxy authenticator works for unencrypted HTTP proxies.  */
@@ -3274,10 +3274,10 @@ open class CallTest {
     assertThat(response.body.string()).isEqualTo("response body")
     val get1 = server.takeRequest()
     assertThat(get1.requestLine).isEqualTo("GET http://android.com/foo HTTP/1.1")
-    assertThat(get1.headers["Proxy-Authorization"]).isNull()
+    assertThat(get1.getHeader("Proxy-Authorization")).isNull()
     val get2 = server.takeRequest()
     assertThat(get2.requestLine).isEqualTo("GET http://android.com/foo HTTP/1.1")
-    assertThat(get2.headers["Proxy-Authorization"]).isEqualTo("password")
+    assertThat(get2.getHeader("Proxy-Authorization")).isEqualTo("password")
   }
 
   /**
@@ -3382,9 +3382,9 @@ open class CallTest {
     val response = client.newCall(request).execute()
     assertThat(response.body.string()).isEqualTo("response body")
     val connect1 = server.takeRequest()
-    assertThat(connect1.headers["Proxy-Authorization"]).isNull()
+    assertThat(connect1.getHeader("Proxy-Authorization")).isNull()
     val connect2 = server.takeRequest()
-    assertThat(connect2.headers["Proxy-Authorization"]).isEqualTo("password")
+    assertThat(connect2.getHeader("Proxy-Authorization")).isEqualTo("password")
   }
 
   /** Confirm that we can send authentication information without being prompted first.  */
@@ -3416,11 +3416,11 @@ open class CallTest {
     executeSynchronously(request).assertSuccessful()
     val connect = server.takeRequest()
     assertThat(connect.method).isEqualTo("CONNECT")
-    assertThat(connect.headers["Proxy-Authorization"]).isEqualTo(credential)
+    assertThat(connect.getHeader("Proxy-Authorization")).isEqualTo(credential)
     assertThat(connect.path).isEqualTo("/")
     val get = server.takeRequest()
     assertThat(get.method).isEqualTo("GET")
-    assertThat(get.headers["Proxy-Authorization"]).isNull()
+    assertThat(get.getHeader("Proxy-Authorization")).isNull()
     assertThat(get.path).isEqualTo("/foo")
   }
 
@@ -3458,10 +3458,10 @@ open class CallTest {
     executeSynchronously(request).assertSuccessful()
     val connect1 = server.takeRequest()
     assertThat(connect1.method).isEqualTo("CONNECT")
-    assertThat(connect1.headers["Proxy-Authorization"]).isEqualTo(credential)
+    assertThat(connect1.getHeader("Proxy-Authorization")).isEqualTo(credential)
     val connect2 = server.takeRequest()
     assertThat(connect2.method).isEqualTo("CONNECT")
-    assertThat(connect2.headers["Proxy-Authorization"]).isEqualTo(credential)
+    assertThat(connect2.getHeader("Proxy-Authorization")).isEqualTo(credential)
     assertThat(challengeSchemes).containsExactly("OkHttp-Preemptive", "Basic")
   }
 
@@ -3693,12 +3693,12 @@ open class CallTest {
     assertThat(response.body.string()).isEqualTo("response body")
     val connect = server.takeRequest()
     assertThat(connect.requestLine).isEqualTo("CONNECT [::1]:$port HTTP/1.1")
-    assertThat(connect.headers["Host"]).isEqualTo("[::1]:$port")
-    assertThat(connect.headers[":authority"]).isNull()
+    assertThat(connect.getHeader("Host")).isEqualTo("[::1]:$port")
+    assertThat(connect.getHeader(":authority")).isNull()
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET / HTTP/1.1")
-    assertThat(get.headers["Host"]).isEqualTo("[::1]:$port")
-    assertThat(get.headers[":authority"]).isNull()
+    assertThat(get.getHeader("Host")).isEqualTo("[::1]:$port")
+    assertThat(get.getHeader(":authority")).isNull()
     assertThat(get.requestUrl).isEqualTo(url)
   }
 
@@ -3720,14 +3720,14 @@ open class CallTest {
     assertThat(connect.requestLine).isEqualTo(
       "CONNECT [::1]:$port HTTP/1.1"
     )
-    assertThat(connect.headers["Host"]).isEqualTo(
+    assertThat(connect.getHeader("Host")).isEqualTo(
       "[::1]:$port"
     )
-    assertThat(connect.headers[":authority"]).isNull()
+    assertThat(connect.getHeader(":authority")).isNull()
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET / HTTP/1.1")
-    assertThat(get.headers["Host"]).isNull()
-    assertThat(get.headers[":authority"]).isEqualTo(
+    assertThat(get.getHeader("Host")).isNull()
+    assertThat(get.getHeader(":authority")).isEqualTo(
       "[::1]:$port"
     )
     assertThat(get.requestUrl).isEqualTo(url)
@@ -3751,16 +3751,16 @@ open class CallTest {
     assertThat(connect.requestLine).isEqualTo(
       "CONNECT 127.0.0.1:$port HTTP/1.1"
     )
-    assertThat(connect.headers["Host"]).isEqualTo(
+    assertThat(connect.getHeader("Host")).isEqualTo(
       "127.0.0.1:$port"
     )
-    assertThat(connect.headers[":authority"]).isNull()
+    assertThat(connect.getHeader(":authority")).isNull()
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET / HTTP/1.1")
-    assertThat(get.headers["Host"]).isEqualTo(
+    assertThat(get.getHeader("Host")).isEqualTo(
       "127.0.0.1:$port"
     )
-    assertThat(get.headers[":authority"]).isNull()
+    assertThat(get.getHeader(":authority")).isNull()
     assertThat(get.requestUrl).isEqualTo(url)
   }
 
@@ -3780,12 +3780,12 @@ open class CallTest {
     assertThat(response.body.string()).isEqualTo("response body")
     val connect = server.takeRequest()
     assertThat(connect.requestLine).isEqualTo("CONNECT 127.0.0.1:$port HTTP/1.1")
-    assertThat(connect.headers["Host"]).isEqualTo("127.0.0.1:$port")
-    assertThat(connect.headers[":authority"]).isNull()
+    assertThat(connect.getHeader("Host")).isEqualTo("127.0.0.1:$port")
+    assertThat(connect.getHeader(":authority")).isNull()
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET / HTTP/1.1")
-    assertThat(get.headers["Host"]).isNull()
-    assertThat(get.headers[":authority"]).isEqualTo("127.0.0.1:$port")
+    assertThat(get.getHeader("Host")).isNull()
+    assertThat(get.getHeader(":authority")).isEqualTo("127.0.0.1:$port")
     assertThat(get.requestUrl).isEqualTo(url)
   }
 
@@ -3805,12 +3805,12 @@ open class CallTest {
     assertThat(response.body.string()).isEqualTo("response body")
     val connect = server.takeRequest()
     assertThat(connect.requestLine).isEqualTo("CONNECT any-host-name:$port HTTP/1.1")
-    assertThat(connect.headers["Host"]).isEqualTo("any-host-name:$port")
-    assertThat(connect.headers[":authority"]).isNull()
+    assertThat(connect.getHeader("Host")).isEqualTo("any-host-name:$port")
+    assertThat(connect.getHeader(":authority")).isNull()
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET / HTTP/1.1")
-    assertThat(get.headers["Host"]).isEqualTo("any-host-name:$port")
-    assertThat(get.headers[":authority"]).isNull()
+    assertThat(get.getHeader("Host")).isEqualTo("any-host-name:$port")
+    assertThat(get.getHeader(":authority")).isNull()
     assertThat(get.requestUrl).isEqualTo(url)
   }
 
@@ -3830,12 +3830,12 @@ open class CallTest {
     assertThat(response.body.string()).isEqualTo("response body")
     val connect = server.takeRequest()
     assertThat(connect.requestLine).isEqualTo("CONNECT any-host-name:$port HTTP/1.1")
-    assertThat(connect.headers["Host"]).isEqualTo("any-host-name:$port")
-    assertThat(connect.headers[":authority"]).isNull()
+    assertThat(connect.getHeader("Host")).isEqualTo("any-host-name:$port")
+    assertThat(connect.getHeader(":authority")).isNull()
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET / HTTP/1.1")
-    assertThat(get.headers["Host"]).isNull()
-    assertThat(get.headers[":authority"]).isEqualTo("any-host-name:$port")
+    assertThat(get.getHeader("Host")).isNull()
+    assertThat(get.getHeader(":authority")).isEqualTo("any-host-name:$port")
     assertThat(get.requestUrl).isEqualTo(url)
   }
 
@@ -3997,7 +3997,7 @@ open class CallTest {
 
     // Confirm that the IP address was used in the host header.
     val recordedRequest = server.takeRequest()
-    assertThat(recordedRequest.headers["Host"]).isEqualTo("$localIpAddress:${server.port}")
+    assertThat(recordedRequest.getHeader("Host")).isEqualTo("$localIpAddress:${server.port}")
   }
 
   @Test
diff --git a/okhttp/src/jvmTest/java/okhttp3/CookiesTest.java b/okhttp/src/jvmTest/java/okhttp3/CookiesTest.java
index 46c6157a1..29dcbd134 100644
--- a/okhttp/src/jvmTest/java/okhttp3/CookiesTest.java
+++ b/okhttp/src/jvmTest/java/okhttp3/CookiesTest.java
@@ -168,7 +168,7 @@ public class CookiesTest {
     get(serverUrl);
     RecordedRequest request = server.takeRequest();
 
-    assertThat(request.getHeaders().get("Cookie")).isEqualTo("a=android; b=banana");
+    assertThat(request.getHeader("Cookie")).isEqualTo("a=android; b=banana");
   }
 
   @Test public void cookieHandlerLikeAndroid() throws Exception {
@@ -193,7 +193,7 @@ public class CookiesTest {
     get(serverUrl);
     RecordedRequest request = server.takeRequest();
 
-    assertThat(request.getHeaders().get("Cookie")).isEqualTo("a=android; b=banana");
+    assertThat(request.getHeader("Cookie")).isEqualTo("a=android; b=banana");
   }
 
   @Test public void receiveAndSendMultipleCookies() throws Exception {
@@ -210,11 +210,11 @@ public class CookiesTest {
 
     get(urlWithIpAddress(server, "/"));
     RecordedRequest request1 = server.takeRequest();
-    assertThat(request1.getHeaders().get("Cookie")).isNull();
+    assertThat(request1.getHeader("Cookie")).isNull();
 
     get(urlWithIpAddress(server, "/"));
     RecordedRequest request2 = server.takeRequest();
-    assertThat(request2.getHeaders().get("Cookie")).isEqualTo("a=android; b=banana");
+    assertThat(request2.getHeader("Cookie")).isEqualTo("a=android; b=banana");
   }
 
   @Test public void testRedirectsDoNotIncludeTooManyCookies() throws Exception {
@@ -245,7 +245,7 @@ public class CookiesTest {
     get(redirectSourceUrl);
     RecordedRequest request = redirectSource.takeRequest();
 
-    assertThat(request.getHeaders().get("Cookie")).isEqualTo("c=cookie");
+    assertThat(request.getHeader("Cookie")).isEqualTo("c=cookie");
 
     for (String header : redirectTarget.takeRequest().getHeaders().names()) {
       if (header.startsWith("Cookie")) {
@@ -272,9 +272,9 @@ public class CookiesTest {
     get(server.url("/"));
 
     RecordedRequest request = server.takeRequest();
-    assertThat(request.getHeaders().get("Cookie")).isEqualTo("Bar=bar; Baz=baz");
-    assertThat(request.getHeaders().get("Cookie2")).isNull();
-    assertThat(request.getHeaders().get("Quux")).isNull();
+    assertThat(request.getHeader("Cookie")).isEqualTo("Bar=bar; Baz=baz");
+    assertThat(request.getHeader("Cookie2")).isNull();
+    assertThat(request.getHeader("Quux")).isNull();
   }
 
   @Test public void acceptOriginalServerMatchesSubdomain() throws Exception {
@@ -347,9 +347,9 @@ public class CookiesTest {
     get(server.url("/"));
 
     RecordedRequest request = server.takeRequest();
-    assertThat(request.getHeaders().get("Cookie")).isEqualTo("Bar=\"; Baz=baz");
-    assertThat(request.getHeaders().get("Cookie2")).isNull();
-    assertThat(request.getHeaders().get("Quux")).isNull();
+    assertThat(request.getHeader("Cookie")).isEqualTo("Bar=\"; Baz=baz");
+    assertThat(request.getHeader("Cookie2")).isNull();
+    assertThat(request.getHeader("Quux")).isNull();
   }
 
   private HttpUrl urlWithIpAddress(MockWebServer server, String path) throws Exception {
diff --git a/okhttp/src/jvmTest/java/okhttp3/InterceptorTest.java b/okhttp/src/jvmTest/java/okhttp3/InterceptorTest.java
index df512a851..c8e2acbb1 100644
--- a/okhttp/src/jvmTest/java/okhttp3/InterceptorTest.java
+++ b/okhttp/src/jvmTest/java/okhttp3/InterceptorTest.java
@@ -283,8 +283,8 @@ public final class InterceptorTest {
 
     RecordedRequest recordedRequest = server.takeRequest();
     assertThat(recordedRequest.getBody().readUtf8()).isEqualTo("ABC");
-    assertThat(recordedRequest.getHeaders().get("Original-Header")).isEqualTo("foo");
-    assertThat(recordedRequest.getHeaders().get("OkHttp-Intercepted")).isEqualTo("yep");
+    assertThat(recordedRequest.getHeader("Original-Header")).isEqualTo("foo");
+    assertThat(recordedRequest.getHeader("OkHttp-Intercepted")).isEqualTo("yep");
     assertThat(recordedRequest.getMethod()).isEqualTo("POST");
   }
 
diff --git a/okhttp/src/jvmTest/java/okhttp3/URLConnectionTest.kt b/okhttp/src/jvmTest/java/okhttp3/URLConnectionTest.kt
index fcb642ae4..5695d139b 100644
--- a/okhttp/src/jvmTest/java/okhttp3/URLConnectionTest.kt
+++ b/okhttp/src/jvmTest/java/okhttp3/URLConnectionTest.kt
@@ -68,6 +68,7 @@ import okhttp3.internal.addHeaderLenient
 import okhttp3.internal.http.HTTP_PERM_REDIRECT
 import okhttp3.internal.http.HTTP_TEMP_REDIRECT
 import okhttp3.internal.platform.Platform.Companion.get
+import okhttp3.internal.toHexString
 import okhttp3.internal.userAgent
 import okhttp3.testing.Flaky
 import okhttp3.testing.PlatformRule
@@ -145,8 +146,8 @@ class URLConnectionTest {
     response.close()
     val recordedRequest = server.takeRequest()
     assertThat(recordedRequest.headers.values("D")).isEqualTo(listOf("e", "f"))
-    assertThat(recordedRequest.headers["G"]).isNull()
-    assertThat(recordedRequest.headers["null"]).isNull()
+    assertThat(recordedRequest.getHeader("G")).isNull()
+    assertThat(recordedRequest.getHeader("null")).isNull()
   }
 
   @Test
@@ -595,7 +596,7 @@ class URLConnectionTest {
     assertThat(failHandshakeRequest.requestLine).isEmpty()
     val fallbackRequest = server.takeRequest()
     assertThat(fallbackRequest.requestLine).isEqualTo("GET /foo HTTP/1.1")
-    assertThat(fallbackRequest.handshake?.tlsVersion).isIn(TlsVersion.TLS_1_2, TlsVersion.TLS_1_3)
+    assertThat(fallbackRequest.tlsVersion).isIn(TlsVersion.TLS_1_2, TlsVersion.TLS_1_3)
   }
 
   @Test
@@ -653,9 +654,9 @@ class URLConnectionTest {
       TlsVersion.TLS_1_3
     ) // v1.2 on OpenJDK 8.
     val request1 = server.takeRequest()
-    assertThat(tlsVersions).contains(request1.handshake?.tlsVersion)
+    assertThat(tlsVersions).contains(request1.tlsVersion)
     val request2 = server.takeRequest()
-    assertThat(tlsVersions).contains(request2.handshake?.tlsVersion)
+    assertThat(tlsVersions).contains(request2.tlsVersion)
   }
 
   /**
@@ -709,7 +710,7 @@ class URLConnectionTest {
     assertThat(request.requestLine).isEqualTo(
       "GET http://android.com/foo HTTP/1.1"
     )
-    assertThat(request.headers["Host"]).isEqualTo("android.com")
+    assertThat(request.getHeader("Host")).isEqualTo("android.com")
   }
 
   @Test
@@ -902,10 +903,10 @@ class URLConnectionTest {
     assertThat(connect.requestLine).overridingErrorMessage(
       "Connect line failure on proxy"
     ).isEqualTo("CONNECT android.com:443 HTTP/1.1")
-    assertThat(connect.headers["Host"]).isEqualTo("android.com:443")
+    assertThat(connect.getHeader("Host")).isEqualTo("android.com:443")
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET /foo HTTP/1.1")
-    assertThat(get.headers["Host"]).isEqualTo("android.com")
+    assertThat(get.getHeader("Host")).isEqualTo("android.com")
     assertThat(hostnameVerifier.calls).isEqualTo(
       Arrays.asList("verify android.com")
     )
@@ -945,7 +946,7 @@ class URLConnectionTest {
     assertThat(connect.requestLine).isEqualTo(
       "CONNECT android.com:443 HTTP/1.1"
     )
-    assertThat(connect.headers["Host"]).isEqualTo("android.com:443")
+    assertThat(connect.getHeader("Host")).isEqualTo("android.com:443")
   }
 
   private fun initResponseCache() {
@@ -979,13 +980,13 @@ class URLConnectionTest {
     )
     assertContent("encrypted response from the origin server", response)
     val connect = server.takeRequest()
-    assertThat(connect.headers["Private"]).isNull()
-    assertThat(connect.headers["Proxy-Authorization"]).isNull()
-    assertThat(connect.headers["User-Agent"]).isEqualTo(userAgent)
-    assertThat(connect.headers["Host"]).isEqualTo("android.com:443")
-    assertThat(connect.headers["Proxy-Connection"]).isEqualTo("Keep-Alive")
+    assertThat(connect.getHeader("Private")).isNull()
+    assertThat(connect.getHeader("Proxy-Authorization")).isNull()
+    assertThat(connect.getHeader("User-Agent")).isEqualTo(userAgent)
+    assertThat(connect.getHeader("Host")).isEqualTo("android.com:443")
+    assertThat(connect.getHeader("Proxy-Connection")).isEqualTo("Keep-Alive")
     val get = server.takeRequest()
-    assertThat(get.headers["Private"]).isEqualTo("Secret")
+    assertThat(get.getHeader("Private")).isEqualTo("Secret")
     assertThat(hostnameVerifier.calls).isEqualTo(listOf("verify android.com"))
   }
 
@@ -1018,14 +1019,14 @@ class URLConnectionTest {
     assertContent("A", response)
     val connect1 = server.takeRequest()
     assertThat(connect1.requestLine).isEqualTo("CONNECT android.com:443 HTTP/1.1")
-    assertThat(connect1.headers["Proxy-Authorization"]).isNull()
+    assertThat(connect1.getHeader("Proxy-Authorization")).isNull()
     val connect2 = server.takeRequest()
     assertThat(connect2.requestLine).isEqualTo("CONNECT android.com:443 HTTP/1.1")
-    assertThat(connect2.headers["Proxy-Authorization"])
+    assertThat(connect2.getHeader("Proxy-Authorization"))
       .isEqualTo("Basic ${RecordingAuthenticator.BASE_64_CREDENTIALS}")
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET /foo HTTP/1.1")
-    assertThat(get.headers["Proxy-Authorization"]).isNull()
+    assertThat(get.getHeader("Proxy-Authorization")).isNull()
   }
 
   // Don't disconnect after building a tunnel with CONNECT
@@ -1319,7 +1320,7 @@ class URLConnectionTest {
     assertThat(response.header("Content-Encoding")).isNull()
     assertThat(response.body.contentLength()).isEqualTo(-1L)
     val request = server.takeRequest()
-    assertThat(request.headers["Accept-Encoding"]).isEqualTo("gzip")
+    assertThat(request.getHeader("Accept-Encoding")).isEqualTo("gzip")
   }
 
   @Test
@@ -1341,7 +1342,7 @@ class URLConnectionTest {
     assertThat(readAscii(gunzippedIn, Int.MAX_VALUE)).isEqualTo("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
     assertThat(response.body.contentLength()).isEqualTo(bodyBytes.size)
     val request = server.takeRequest()
-    assertThat(request.headers["Accept-Encoding"]).isEqualTo("gzip")
+    assertThat(request.getHeader("Accept-Encoding")).isEqualTo("gzip")
   }
 
   @Test
@@ -1380,7 +1381,7 @@ class URLConnectionTest {
     )
     assertThat(readAscii(response.body.byteStream(), Int.MAX_VALUE)).isEqualTo("ABCDE")
     val request = server.takeRequest()
-    assertThat(request.headers["Accept-Encoding"]).isEqualTo("custom")
+    assertThat(request.getHeader("Accept-Encoding")).isEqualTo("custom")
   }
 
   /**
@@ -1585,7 +1586,7 @@ class URLConnectionTest {
 
     // No authorization header for the request...
     val recordedRequest = server.takeRequest()
-    assertThat(recordedRequest.headers["Authorization"]).isNull()
+    assertThat(recordedRequest.getHeader("Authorization")).isNull()
     assertThat(recordedRequest.body.readUtf8()).isEqualTo("ABCD")
   }
 
@@ -1634,11 +1635,11 @@ class URLConnectionTest {
     val recordedRequest1 = server.takeRequest()
     assertThat(recordedRequest1.method).isEqualTo("POST")
     assertThat(recordedRequest1.body.readUtf8()).isEqualTo(body)
-    assertThat(recordedRequest1.headers["Authorization"]).isNull()
+    assertThat(recordedRequest1.getHeader("Authorization")).isNull()
     val recordedRequest2 = server.takeRequest()
     assertThat(recordedRequest2.method).isEqualTo("POST")
     assertThat(recordedRequest2.body.readUtf8()).isEqualTo(body)
-    assertThat(recordedRequest2.headers["Authorization"]).isEqualTo(credential)
+    assertThat(recordedRequest2.getHeader("Authorization")).isEqualTo(credential)
   }
 
   @Test
@@ -1928,13 +1929,13 @@ class URLConnectionTest {
 
     // No authorization header for the first request...
     var request = server.takeRequest()
-    assertThat(request.headers["Authorization"]).isNull()
+    assertThat(request.getHeader("Authorization")).isNull()
 
     // ...but the three requests that follow include an authorization header.
     for (i in 0..2) {
       request = server.takeRequest()
       assertThat(request.requestLine).isEqualTo("POST / HTTP/1.1")
-      assertThat(request.headers["Authorization"]).isEqualTo(
+      assertThat(request.getHeader("Authorization")).isEqualTo(
         "Basic " + RecordingAuthenticator.BASE_64_CREDENTIALS
       )
       assertThat(request.body.readUtf8()).isEqualTo("ABCD")
@@ -1966,13 +1967,13 @@ class URLConnectionTest {
 
     // No authorization header for the first request...
     var request = server.takeRequest()
-    assertThat(request.headers["Authorization"]).isNull()
+    assertThat(request.getHeader("Authorization")).isNull()
 
     // ...but the three requests that follow requests include an authorization header.
     for (i in 0..2) {
       request = server.takeRequest()
       assertThat(request.requestLine).isEqualTo("GET / HTTP/1.1")
-      assertThat(request.headers["Authorization"])
+      assertThat(request.getHeader("Authorization"))
         .isEqualTo("Basic ${RecordingAuthenticator.BASE_64_CREDENTIALS}")
     }
   }
@@ -2014,17 +2015,17 @@ class URLConnectionTest {
 
     // No authorization header for the first request...
     val request1 = server.takeRequest()
-    assertThat(request1.headers["Authorization"]).isNull()
+    assertThat(request1.getHeader("Authorization")).isNull()
 
     // UTF-8 encoding for the first credential.
     val request2 = server.takeRequest()
-    assertThat(request2.headers["Authorization"]).isEqualTo(
+    assertThat(request2.getHeader("Authorization")).isEqualTo(
       "Basic dXNlcm5hbWU6bcO2dG9yaGVhZA=="
     )
 
     // ISO-8859-1 encoding for the second credential.
     val request3 = server.takeRequest()
-    assertThat(request3.headers["Authorization"])
+    assertThat(request3.getHeader("Authorization"))
       .isEqualTo("Basic dXNlcm5hbWU6bfZ0b3JoZWFk")
   }
 
@@ -2056,13 +2057,13 @@ class URLConnectionTest {
 
     // no authorization header for the first request...
     var request = server.takeRequest()
-    assertThat(request.headers["Authorization"]).isNull()
+    assertThat(request.getHeader("Authorization")).isNull()
 
     // ...but the three requests that follow requests include an authorization header
     for (i in 0..2) {
       request = server.takeRequest()
       assertThat(request.requestLine).isEqualTo("GET / HTTP/1.1")
-      assertThat(request.headers["Authorization"]).isEqualTo(
+      assertThat(request.getHeader("Authorization")).isEqualTo(
         "Basic ${RecordingAuthenticator.BASE_64_CREDENTIALS}"
       )
     }
@@ -2296,8 +2297,8 @@ class URLConnectionTest {
     assertContent("This is the 2nd server, again!", getResponse(Request(server2.url("/"))))
     val server1Host = server.hostName + ":" + server.port
     val server2Host = server2.hostName + ":" + server2.port
-    assertThat(server.takeRequest().headers["Host"]).isEqualTo(server1Host)
-    assertThat(server2.takeRequest().headers["Host"]).isEqualTo(server2Host)
+    assertThat(server.takeRequest().getHeader("Host")).isEqualTo(server1Host)
+    assertThat(server2.takeRequest().getHeader("Host")).isEqualTo(server2Host)
     assertThat(server.takeRequest().sequenceNumber)
       .overridingErrorMessage("Expected connection reuse")
       .isEqualTo(1)
@@ -2360,7 +2361,7 @@ class URLConnectionTest {
       .build()
     assertContent("Page 2", getResponse(newRequest("/a")))
     val redirectRequest = server2.takeRequest()
-    assertThat(redirectRequest.headers["Authorization"]).isNull()
+    assertThat(redirectRequest.getHeader("Authorization")).isNull()
     assertThat(redirectRequest.path).isEqualTo("/b")
   }
 
@@ -2445,9 +2446,9 @@ class URLConnectionTest {
       .isEqualTo("POST /page1 HTTP/1.1")
     val page2 = server.takeRequest()
     assertThat(page2.requestLine).isEqualTo("GET /page2 HTTP/1.1")
-    assertThat(page2.headers["Content-Length"]).isNull()
-    assertThat(page2.headers["Content-Type"]).isNull()
-    assertThat(page2.headers["Transfer-Encoding"]).isNull()
+    assertThat(page2.getHeader("Content-Length")).isNull()
+    assertThat(page2.getHeader("Content-Type")).isNull()
+    assertThat(page2.getHeader("Transfer-Encoding")).isNull()
   }
 
   @Test
@@ -3094,7 +3095,7 @@ class URLConnectionTest {
     )
     assertThat(readAscii(response.body.byteStream(), Int.MAX_VALUE)).isEqualTo("A")
     val request = server.takeRequest()
-    assertThat(request.headers["Content-Length"]).isEqualTo("3")
+    assertThat(request.getHeader("Content-Length")).isEqualTo("3")
     response.body.close()
   }
 
@@ -3501,8 +3502,8 @@ class URLConnectionTest {
       .authenticator(authenticator)
       .build()
     assertContent("A", getResponse(newRequest("/private")))
-    assertThat(server.takeRequest().headers["Authorization"]).isNull()
-    assertThat(server.takeRequest().headers["Authorization"]).isEqualTo(credential)
+    assertThat(server.takeRequest().getHeader("Authorization")).isNull()
+    assertThat(server.takeRequest().getHeader("Authorization")).isEqualTo(credential)
     assertThat(authenticator.onlyRoute().proxy).isEqualTo(Proxy.NO_PROXY)
     val response = authenticator.onlyResponse()
     assertThat(response.request.url.toUrl().path).isEqualTo("/private")
@@ -3526,8 +3527,8 @@ class URLConnectionTest {
       .authenticator(authenticator)
       .build()
     assertContent("A", getResponse(newRequest("/private")))
-    assertThat(server.takeRequest().headers["Authorization"]).isNull()
-    assertThat(server.takeRequest().headers["Authorization"]).isEqualTo(
+    assertThat(server.takeRequest().getHeader("Authorization")).isNull()
+    assertThat(server.takeRequest().getHeader("Authorization")).isEqualTo(
       "oauthed abc123"
     )
     val response = authenticator.onlyResponse()
@@ -3678,7 +3679,7 @@ class URLConnectionTest {
     assertContent("", response)
     val zeroLengthPayload = server.takeRequest()
     assertThat(zeroLengthPayload.method).isEqualTo(method)
-    assertThat(zeroLengthPayload.headers["content-length"]).isEqualTo("0")
+    assertThat(zeroLengthPayload.getHeader("content-length")).isEqualTo("0")
     assertThat(zeroLengthPayload.bodySize).isEqualTo(0L)
   }
 
@@ -3740,7 +3741,7 @@ class URLConnectionTest {
     )
     assertContent("", response)
     val request = server.takeRequest()
-    assertThat(request.headers["Content-Length"]).isEqualTo(
+    assertThat(request.getHeader("Content-Length")).isEqualTo(
       java.lang.Long.toString(contentLength)
     )
   }
@@ -3848,7 +3849,7 @@ class URLConnectionTest {
     )
     assertContent("abc", getResponse(newRequest("/")))
     val request = server.takeRequest()
-    assertThat(request.headers["User-Agent"]).isEqualTo(userAgent)
+    assertThat(request.getHeader("User-Agent")).isEqualTo(userAgent)
   }
 
   @Test
diff --git a/okhttp/src/jvmTest/java/okhttp3/internal/http2/HttpOverHttp2Test.kt b/okhttp/src/jvmTest/java/okhttp3/internal/http2/HttpOverHttp2Test.kt
index 1821ff228..ea8c1f730 100644
--- a/okhttp/src/jvmTest/java/okhttp3/internal/http2/HttpOverHttp2Test.kt
+++ b/okhttp/src/jvmTest/java/okhttp3/internal/http2/HttpOverHttp2Test.kt
@@ -165,8 +165,8 @@ class HttpOverHttp2Test {
     assertThat(response.protocol).isEqualTo(protocol)
     val request = server.takeRequest()
     assertThat(request.requestLine).isEqualTo("GET /foo HTTP/1.1")
-      assertThat(request.headers[":scheme"]).isEqualTo(scheme)
-      assertThat(request.headers[":authority"]).isEqualTo("${server.hostName}:${server.port}")
+    assertThat(request.getHeader(":scheme")).isEqualTo(scheme)
+    assertThat(request.getHeader(":authority")).isEqualTo("${server.hostName}:${server.port}")
   }
 
   @ParameterizedTest @ArgumentsSource(ProtocolParamProvider::class)
@@ -249,7 +249,7 @@ class HttpOverHttp2Test {
     val request = server.takeRequest()
     assertThat(request.requestLine).isEqualTo("POST /foo HTTP/1.1")
     org.junit.jupiter.api.Assertions.assertArrayEquals(postBytes, request.body.readByteArray())
-      assertThat(request.headers["Content-Length"]).isNull()
+    assertThat(request.getHeader("Content-Length")).isNull()
   }
 
   @ParameterizedTest @ArgumentsSource(ProtocolParamProvider::class)
@@ -276,7 +276,7 @@ class HttpOverHttp2Test {
     val request = server.takeRequest()
     assertThat(request.requestLine).isEqualTo("POST /foo HTTP/1.1")
     org.junit.jupiter.api.Assertions.assertArrayEquals(postBytes, request.body.readByteArray())
-    assertThat(request.headers["Content-Length"]!!.toInt()).isEqualTo(
+    assertThat(request.getHeader("Content-Length")!!.toInt()).isEqualTo(
       postBytes.size.toLong()
     )
   }
@@ -309,7 +309,7 @@ class HttpOverHttp2Test {
     val request = server.takeRequest()
     assertThat(request.requestLine).isEqualTo("POST /foo HTTP/1.1")
     org.junit.jupiter.api.Assertions.assertArrayEquals(postBytes, request.body.readByteArray())
-    assertThat(request.headers["Content-Length"]!!.toInt())
+    assertThat(request.getHeader("Content-Length")!!.toInt())
       .isEqualTo(postBytes.size.toLong())
   }
 
@@ -483,10 +483,10 @@ class HttpOverHttp2Test {
     val response = call.execute()
     assertThat(response.body.string()).isEqualTo("Successful auth!")
     val denied = server.takeRequest()
-      assertThat(denied.headers["Authorization"]).isNull()
+    assertThat(denied.getHeader("Authorization")).isNull()
     val accepted = server.takeRequest()
     assertThat(accepted.requestLine).isEqualTo("GET / HTTP/1.1")
-      assertThat(accepted.headers["Authorization"]).isEqualTo(credential)
+    assertThat(accepted.getHeader("Authorization")).isEqualTo(credential)
   }
 
   @ParameterizedTest @ArgumentsSource(ProtocolParamProvider::class)
@@ -763,7 +763,7 @@ class HttpOverHttp2Test {
     val response = call.execute()
     assertThat(response.body.string()).isEqualTo("")
     val request = server.takeRequest()
-      assertThat(request.headers["Cookie"]).isEqualTo("a=b")
+    assertThat(request.getHeader("Cookie")).isEqualTo("a=b")
   }
 
   @ParameterizedTest @ArgumentsSource(ProtocolParamProvider::class)
@@ -1336,13 +1336,13 @@ class HttpOverHttp2Test {
     assertThat(response.message).isEqualTo("")
     val request = server.takeRequest()
     assertThat(request.requestLine).isEqualTo("GET /foo HTTP/1.1")
-      assertThat(request.headers[":scheme"]).isEqualTo(scheme)
-      assertThat(request.headers[":authority"]).isEqualTo(
+    assertThat(request.getHeader(":scheme")).isEqualTo(scheme)
+    assertThat(request.getHeader(":authority")).isEqualTo(
       server.hostName + ":" + server.port
     )
     val pushedRequest = server.takeRequest()
     assertThat(pushedRequest.requestLine).isEqualTo("GET /foo/bar HTTP/1.1")
-      assertThat(pushedRequest.headers["foo"]).isEqualTo("bar")
+    assertThat(pushedRequest.getHeader("foo")).isEqualTo("bar")
   }
 
   @ParameterizedTest @ArgumentsSource(ProtocolParamProvider::class)
@@ -1365,15 +1365,15 @@ class HttpOverHttp2Test {
     assertThat(response.message).isEqualTo("")
     val request = server.takeRequest()
     assertThat(request.requestLine).isEqualTo("GET /foo HTTP/1.1")
-      assertThat(request.headers[":scheme"]).isEqualTo(scheme)
-      assertThat(request.headers[":authority"]).isEqualTo(
+    assertThat(request.getHeader(":scheme")).isEqualTo(scheme)
+    assertThat(request.getHeader(":authority")).isEqualTo(
       server.hostName + ":" + server.port
     )
     val pushedRequest = server.takeRequest()
     assertThat(pushedRequest.requestLine).isEqualTo(
       "HEAD /foo/bar HTTP/1.1"
     )
-      assertThat(pushedRequest.headers["foo"]).isEqualTo("bar")
+    assertThat(pushedRequest.getHeader("foo")).isEqualTo("bar")
   }
 
   @ParameterizedTest @ArgumentsSource(ProtocolParamProvider::class)
@@ -1878,7 +1878,7 @@ class HttpOverHttp2Test {
     val response = call.execute()
     assertThat(response.body.string()).isEqualTo("")
     val recordedRequest = server.takeRequest()
-      assertThat(recordedRequest.headers[":authority"]).isEqualTo("privateobject.com")
+    assertThat(recordedRequest.getHeader(":authority")).isEqualTo("privateobject.com")
   }
 
   private fun gzip(bytes: String): Buffer {
@@ -2004,8 +2004,8 @@ class HttpOverHttp2Test {
 
     val request = server.takeRequest()
     assertThat(request.requestLine).isEqualTo("GET /foo HTTP/1.1")
-      assertThat(request.headers[":scheme"]).isEqualTo(scheme)
-      assertThat(request.headers[":authority"]).isEqualTo("android.com")
+    assertThat(request.getHeader(":scheme")).isEqualTo(scheme)
+    assertThat(request.getHeader(":authority")).isEqualTo("android.com")
   }
 
   /** Respond to a proxy authorization challenge.  */
@@ -2040,15 +2040,15 @@ class HttpOverHttp2Test {
 
     val connect1 = server.takeRequest()
     assertThat(connect1.requestLine).isEqualTo("CONNECT android.com:$port HTTP/1.1")
-      assertThat(connect1.headers["Proxy-Authorization"]).isNull()
+    assertThat(connect1.getHeader("Proxy-Authorization")).isNull()
 
     val connect2 = server.takeRequest()
     assertThat(connect2.requestLine).isEqualTo("CONNECT android.com:$port HTTP/1.1")
-      assertThat(connect2.headers["Proxy-Authorization"]).isEqualTo("password")
+    assertThat(connect2.getHeader("Proxy-Authorization")).isEqualTo("password")
 
     val get = server.takeRequest()
     assertThat(get.requestLine).isEqualTo("GET /foo HTTP/1.1")
-      assertThat(get.headers["Proxy-Authorization"]).isNull()
+    assertThat(get.getHeader("Proxy-Authorization")).isNull()
   }
 
   companion object {
diff --git a/okhttp/src/jvmTest/java/okhttp3/internal/ws/WebSocketHttpTest.java b/okhttp/src/jvmTest/java/okhttp3/internal/ws/WebSocketHttpTest.java
index ab7811071..507fc66ff 100644
--- a/okhttp/src/jvmTest/java/okhttp3/internal/ws/WebSocketHttpTest.java
+++ b/okhttp/src/jvmTest/java/okhttp3/internal/ws/WebSocketHttpTest.java
@@ -942,7 +942,7 @@ public final class WebSocketHttpTest {
     closeWebSockets(client, server);
 
     RecordedRequest upgradeRequest = webServer.takeRequest();
-    assertThat(upgradeRequest.getHeaders().get("Sec-WebSocket-Extensions"))
+    assertThat(upgradeRequest.getHeader("Sec-WebSocket-Extensions"))
         .isEqualTo("permessage-deflate");
   }
 
@@ -967,7 +967,7 @@ public final class WebSocketHttpTest {
   }
 
   private MockResponse.Builder upgradeResponse(RecordedRequest request) {
-    String key = request.getHeaders().get("Sec-WebSocket-Key");
+    String key = request.getHeader("Sec-WebSocket-Key");
     return new MockResponse.Builder()
         .status("HTTP/1.1 101 Switching Protocols")
         .setHeader("Connection", "Upgrade")
diff --git a/samples/compare/src/test/kotlin/okhttp3/compare/ApacheHttpClientTest.kt b/samples/compare/src/test/kotlin/okhttp3/compare/ApacheHttpClientTest.kt
index 96f23ea49..cde2e23a3 100644
--- a/samples/compare/src/test/kotlin/okhttp3/compare/ApacheHttpClientTest.kt
+++ b/samples/compare/src/test/kotlin/okhttp3/compare/ApacheHttpClientTest.kt
@@ -52,9 +52,9 @@ class ApacheHttpClientTest {
     }
 
     val recorded = server.takeRequest()
-      assertThat(recorded.headers["Accept"]).isEqualTo("text/plain")
-      assertThat(recorded.headers["Accept-Encoding"]).isEqualTo("gzip, x-gzip, deflate")
-      assertThat(recorded.headers["Connection"]).isEqualTo("keep-alive")
-      assertThat(recorded.headers["User-Agent"]).startsWith("Apache-HttpClient/")
+    assertThat(recorded.getHeader("Accept")).isEqualTo("text/plain")
+    assertThat(recorded.getHeader("Accept-Encoding")).isEqualTo("gzip, x-gzip, deflate")
+    assertThat(recorded.getHeader("Connection")).isEqualTo("keep-alive")
+    assertThat(recorded.getHeader("User-Agent")).startsWith("Apache-HttpClient/")
   }
 }
diff --git a/samples/compare/src/test/kotlin/okhttp3/compare/JavaHttpClientTest.kt b/samples/compare/src/test/kotlin/okhttp3/compare/JavaHttpClientTest.kt
index 9b85f2265..7f701c31a 100644
--- a/samples/compare/src/test/kotlin/okhttp3/compare/JavaHttpClientTest.kt
+++ b/samples/compare/src/test/kotlin/okhttp3/compare/JavaHttpClientTest.kt
@@ -57,12 +57,12 @@ class JavaHttpClientTest {
     assertThat(response.body()).isEqualTo("hello, Java HTTP Client")
 
     val recorded = server.takeRequest()
-      assertThat(recorded.headers["Accept"]).isEqualTo("text/plain")
-      assertThat(recorded.headers["Accept-Encoding"]).isNull() // No built-in gzip.
-      assertThat(recorded.headers["Connection"]).isEqualTo("Upgrade, HTTP2-Settings")
-      assertThat(recorded.headers["Content-Length"]).isEqualTo("0")
-      assertThat(recorded.headers["HTTP2-Settings"]).isNotNull()
-      assertThat(recorded.headers["Upgrade"]).isEqualTo("h2c") // HTTP/2 over plaintext!
-      assertThat(recorded.headers["User-Agent"]).matches("Java-http-client/.*")
+    assertThat(recorded.getHeader("Accept")).isEqualTo("text/plain")
+    assertThat(recorded.getHeader("Accept-Encoding")).isNull() // No built-in gzip.
+    assertThat(recorded.getHeader("Connection")).isEqualTo("Upgrade, HTTP2-Settings")
+    assertThat(recorded.getHeader("Content-Length")).isEqualTo("0")
+    assertThat(recorded.getHeader("HTTP2-Settings")).isNotNull()
+    assertThat(recorded.getHeader("Upgrade")).isEqualTo("h2c") // HTTP/2 over plaintext!
+    assertThat(recorded.getHeader("User-Agent")).matches("Java-http-client/.*")
   }
 }
diff --git a/samples/compare/src/test/kotlin/okhttp3/compare/JettyHttpClientTest.kt b/samples/compare/src/test/kotlin/okhttp3/compare/JettyHttpClientTest.kt
index f49b2df35..3835c045b 100644
--- a/samples/compare/src/test/kotlin/okhttp3/compare/JettyHttpClientTest.kt
+++ b/samples/compare/src/test/kotlin/okhttp3/compare/JettyHttpClientTest.kt
@@ -51,9 +51,9 @@ class JettyHttpClientTest {
     assertThat(response.contentAsString).isEqualTo("hello, Jetty HTTP Client")
 
     val recorded = server.takeRequest()
-      assertThat(recorded.headers["Accept"]).isEqualTo("text/plain")
-      assertThat(recorded.headers["Accept-Encoding"]).isEqualTo("gzip")
-      assertThat(recorded.headers["Connection"]).isNull()
-      assertThat(recorded.headers["User-Agent"]).matches("Jetty/.*")
+    assertThat(recorded.getHeader("Accept")).isEqualTo("text/plain")
+    assertThat(recorded.getHeader("Accept-Encoding")).isEqualTo("gzip")
+    assertThat(recorded.getHeader("Connection")).isNull()
+    assertThat(recorded.getHeader("User-Agent")).matches("Jetty/.*")
   }
 }
diff --git a/samples/compare/src/test/kotlin/okhttp3/compare/OkHttpClientTest.kt b/samples/compare/src/test/kotlin/okhttp3/compare/OkHttpClientTest.kt
index b1dd7587e..da65e91ce 100644
--- a/samples/compare/src/test/kotlin/okhttp3/compare/OkHttpClientTest.kt
+++ b/samples/compare/src/test/kotlin/okhttp3/compare/OkHttpClientTest.kt
@@ -48,9 +48,9 @@ class OkHttpClientTest {
     assertThat(response.body.string()).isEqualTo("hello, OkHttp")
 
     val recorded = server.takeRequest()
-      assertThat(recorded.headers["Accept"]).isEqualTo("text/plain")
-      assertThat(recorded.headers["Accept-Encoding"]).isEqualTo("gzip")
-      assertThat(recorded.headers["Connection"]).isEqualTo("Keep-Alive")
-      assertThat(recorded.headers["User-Agent"]).matches("okhttp/.*")
+    assertThat(recorded.getHeader("Accept")).isEqualTo("text/plain")
+    assertThat(recorded.getHeader("Accept-Encoding")).isEqualTo("gzip")
+    assertThat(recorded.getHeader("Connection")).isEqualTo("Keep-Alive")
+    assertThat(recorded.getHeader("User-Agent")).matches("okhttp/.*")
   }
 }
