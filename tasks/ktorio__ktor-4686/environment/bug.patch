diff --git a/ktor-client/ktor-client-core/common/src/io/ktor/client/request/forms/formDsl.kt b/ktor-client/ktor-client-core/common/src/io/ktor/client/request/forms/formDsl.kt
index dbaf86739..ef14c5b53 100644
--- a/ktor-client/ktor-client-core/common/src/io/ktor/client/request/forms/formDsl.kt
+++ b/ktor-client/ktor-client-core/common/src/io/ktor/client/request/forms/formDsl.kt
@@ -9,7 +9,6 @@ import io.ktor.http.content.*
 import io.ktor.utils.io.*
 import io.ktor.utils.io.core.*
 import kotlinx.io.*
-import kotlinx.io.Buffer
 import kotlin.contracts.*
 
 /**
@@ -50,10 +49,8 @@ public fun formData(vararg values: FormPart<*>): List<PartData> {
                 PartData.BinaryItem({ ByteReadPacket(value) }, {}, partHeaders.build())
             }
             is Source -> {
-                if (value is Buffer) {
-                    partHeaders.append(HttpHeaders.ContentLength, value.remaining.toString())
-                }
-                PartData.BinaryItem({ value.peek() }, { value.close() }, partHeaders.build())
+                partHeaders.append(HttpHeaders.ContentLength, value.remaining.toString())
+                PartData.BinaryItem({ value.copy() }, { value.close() }, partHeaders.build())
             }
             is InputProvider -> {
                 val size = value.size
diff --git a/ktor-client/ktor-client-core/common/test/MultiPartFormDataContentTest.kt b/ktor-client/ktor-client-core/common/test/MultiPartFormDataContentTest.kt
index 1eef14ec3..c46a0f0b7 100644
--- a/ktor-client/ktor-client-core/common/test/MultiPartFormDataContentTest.kt
+++ b/ktor-client/ktor-client-core/common/test/MultiPartFormDataContentTest.kt
@@ -3,22 +3,17 @@
  */
 
 import io.ktor.client.request.forms.*
-import io.ktor.http.Headers
-import io.ktor.http.HttpHeaders
 import io.ktor.test.dispatcher.*
 import io.ktor.utils.io.*
 import io.ktor.utils.io.charsets.*
 import kotlinx.coroutines.*
-import kotlinx.coroutines.test.runTest
 import kotlinx.io.*
-import kotlinx.io.files.Path
-import kotlin.random.Random
 import kotlin.test.*
 
 class MultiPartFormDataContentTest {
 
     @Test
-    fun testMultiPartFormDataContentHasCorrectPrefix() = runTest {
+    fun testMultiPartFormDataContentHasCorrectPrefix() = testSuspend {
         val formData = MultiPartFormDataContent(
             formData {
                 append("Hello", "World")
@@ -38,7 +33,7 @@ class MultiPartFormDataContentTest {
     }
 
     @Test
-    fun testEmptyByteReadChannel() = runTest {
+    fun testEmptyByteReadChannel() = testSuspend {
         val data = MultiPartFormDataContent(
             formData {
                 append("channel", ChannelProvider { ByteReadChannel.Empty })
@@ -60,7 +55,7 @@ class MultiPartFormDataContentTest {
     }
 
     @Test
-    fun testByteReadChannelWithString() = runTest {
+    fun testByteReadChannelWithString() = testSuspend {
         val content = "body"
         val data = MultiPartFormDataContent(
             formData {
@@ -84,7 +79,7 @@ class MultiPartFormDataContentTest {
     }
 
     @Test
-    fun testNumberQuoted() = runTest {
+    fun testNumberQuoted() = testSuspend {
         val data = MultiPartFormDataContent(
             formData {
                 append("not_a_forty_two", 1337)
@@ -107,7 +102,7 @@ class MultiPartFormDataContentTest {
     }
 
     @Test
-    fun testBooleanQuoted() = runTest {
+    fun testBooleanQuoted() = testSuspend {
         val data = MultiPartFormDataContent(
             formData {
                 append("is_forty_two", false)
@@ -130,7 +125,7 @@ class MultiPartFormDataContentTest {
     }
 
     @Test
-    fun testStringsList() = runTest {
+    fun testStringsList() = testSuspend {
         val data = MultiPartFormDataContent(
             formData {
                 append("platforms[]", listOf("windows", "linux", "osx"))
@@ -163,7 +158,7 @@ class MultiPartFormDataContentTest {
     }
 
     @Test
-    fun testStringsArray() = runTest {
+    fun testStringsArray() = testSuspend {
         val data = MultiPartFormDataContent(
             formData {
                 append("platforms[]", arrayOf("windows", "linux", "osx"))
@@ -196,7 +191,7 @@ class MultiPartFormDataContentTest {
     }
 
     @Test
-    fun testStringsListBadKey() = runTest {
+    fun testStringsListBadKey() = testSuspend {
         val attempt = {
             MultiPartFormDataContent(
                 formData {
@@ -211,7 +206,7 @@ class MultiPartFormDataContentTest {
     }
 
     @Test
-    fun testByteReadChannelOverBufferSize() = runTest {
+    fun testByteReadChannelOverBufferSize() = testSuspend {
         val body = ByteArray(4089) { 'k'.code.toByte() }
         val data = MultiPartFormDataContent(
             formData {
@@ -233,36 +228,6 @@ class MultiPartFormDataContentTest {
         )
     }
 
-    @Test
-    fun testFileContentFromSource() = runTest {
-        val expected = "This content should appear in the multipart body."
-        val fileSource = try {
-            with(kotlinx.io.files.SystemFileSystem) {
-                val file = Path(kotlinx.io.files.SystemTemporaryDirectory, "temp${Random.nextInt(1000, 9999)}.txt")
-                sink(file).buffered().use { it.writeString(expected) }
-                source(file).buffered()
-            }
-        } catch (_: Throwable) {
-            // filesystem is not supported for web platforms (yet)
-            return@runTest
-        }
-        val data = MultiPartFormDataContent(
-            formData {
-                append(
-                    key = "key",
-                    value = fileSource,
-                    headers = Headers.build {
-                        append(HttpHeaders.ContentType, "text/plain")
-                        append(HttpHeaders.ContentDisposition, "filename=\"file.txt\"")
-                    },
-                )
-            }
-        )
-        assertTrue("File contents should be present in the multipart body.") {
-            data.readString().contains(expected)
-        }
-    }
-
     private suspend fun MultiPartFormDataContent.readString(charset: Charset = Charsets.UTF_8): String {
         val bytes = readBytes()
         return bytes.decodeToString(0, 0 + bytes.size)
diff --git a/ktor-io/common/src/io/ktor/utils/io/core/ByteReadPacket.kt b/ktor-io/common/src/io/ktor/utils/io/core/ByteReadPacket.kt
index 6fad093c4..4fc4b8851 100644
--- a/ktor-io/common/src/io/ktor/utils/io/core/ByteReadPacket.kt
+++ b/ktor-io/common/src/io/ktor/utils/io/core/ByteReadPacket.kt
@@ -49,15 +49,8 @@ public fun Source.readAvailable(out: kotlinx.io.Buffer): Int {
     return result.toInt()
 }
 
-/**
- * Returns a copy of the current buffer attached to this Source.
- */
-@Deprecated(
-    "Use peek() or buffer.copy() instead, depending on your use case.",
-    ReplaceWith("peek()", "kotlinx.io.Source")
-)
 @OptIn(InternalIoApi::class)
-public fun Source.copy(): Source = peek()
+public fun Source.copy(): Source = buffer.copy()
 
 @OptIn(InternalIoApi::class)
 public fun Source.readShortLittleEndian(): Short {
diff --git a/ktor-io/jvm/src/io/ktor/utils/io/streams/Streams.kt b/ktor-io/jvm/src/io/ktor/utils/io/streams/Streams.kt
index bc7148b92..d68c8d5cd 100644
--- a/ktor-io/jvm/src/io/ktor/utils/io/streams/Streams.kt
+++ b/ktor-io/jvm/src/io/ktor/utils/io/streams/Streams.kt
@@ -18,7 +18,7 @@ public fun Source.inputStream(): InputStream = asInputStream()
 
 @OptIn(InternalIoApi::class)
 public fun OutputStream.writePacket(packet: Source) {
-    packet.transferTo(this.asSink())
+    packet.buffer.copyTo(this)
 }
 
 public fun OutputStream.writePacket(block: Sink.() -> Unit) {
diff --git a/ktor-server/ktor-server-jetty-jakarta/jvm/test/io/ktor/tests/server/jetty/jakarta/JettyIdleTimeoutTest.kt b/ktor-server/ktor-server-jetty-jakarta/jvm/test/io/ktor/tests/server/jetty/jakarta/JettyIdleTimeoutTest.kt
index d1a4ee5e5..99cc90a64 100644
--- a/ktor-server/ktor-server-jetty-jakarta/jvm/test/io/ktor/tests/server/jetty/jakarta/JettyIdleTimeoutTest.kt
+++ b/ktor-server/ktor-server-jetty-jakarta/jvm/test/io/ktor/tests/server/jetty/jakarta/JettyIdleTimeoutTest.kt
@@ -27,7 +27,7 @@ class JettyIdleTimeoutTest : EngineTestBase<JettyApplicationEngine, JettyApplica
 
     override fun configure(configuration: JettyApplicationEngineBase.Configuration) {
         super.configure(configuration)
-        configuration.idleTimeout = 100.milliseconds
+        configuration.idleTimeout = 10.milliseconds
     }
 
     @Test
diff --git a/ktor-server/ktor-server-jetty/jvm/test/io/ktor/tests/server/jetty/JettyIdleTimeoutTest.kt b/ktor-server/ktor-server-jetty/jvm/test/io/ktor/tests/server/jetty/JettyIdleTimeoutTest.kt
index 275dafb79..f187ae19a 100644
--- a/ktor-server/ktor-server-jetty/jvm/test/io/ktor/tests/server/jetty/JettyIdleTimeoutTest.kt
+++ b/ktor-server/ktor-server-jetty/jvm/test/io/ktor/tests/server/jetty/JettyIdleTimeoutTest.kt
@@ -27,7 +27,7 @@ class JettyIdleTimeoutTest : EngineTestBase<JettyApplicationEngine, JettyApplica
 
     override fun configure(configuration: JettyApplicationEngineBase.Configuration) {
         super.configure(configuration)
-        configuration.idleTimeout = 100.milliseconds
+        configuration.idleTimeout = 10.milliseconds
     }
 
     @Test
diff --git a/ktor-server/ktor-server-test-base/jvm/src/io/ktor/server/test/base/HighLoadHttpGenerator.kt b/ktor-server/ktor-server-test-base/jvm/src/io/ktor/server/test/base/HighLoadHttpGenerator.kt
index 88634116e..69ffe87f1 100644
--- a/ktor-server/ktor-server-test-base/jvm/src/io/ktor/server/test/base/HighLoadHttpGenerator.kt
+++ b/ktor-server/ktor-server-test-base/jvm/src/io/ktor/server/test/base/HighLoadHttpGenerator.kt
@@ -67,7 +67,7 @@ class HighLoadHttpGenerator(
     private val request = RequestResponseBuilder().apply(builder).build()
 
     private val requestByteBuffer = ByteBuffer.allocateDirect(request.remaining.toInt())!!.apply {
-        request.peek().readFully(this)
+        request.copy().readFully(this)
         clear()
     }
 
diff --git a/ktor-server/ktor-server-test-suites/jvm/src/io/ktor/server/testing/suites/SustainabilityTestSuite.kt b/ktor-server/ktor-server-test-suites/jvm/src/io/ktor/server/testing/suites/SustainabilityTestSuite.kt
index 4688b9527..6375ed53e 100644
--- a/ktor-server/ktor-server-test-suites/jvm/src/io/ktor/server/testing/suites/SustainabilityTestSuite.kt
+++ b/ktor-server/ktor-server-test-suites/jvm/src/io/ktor/server/testing/suites/SustainabilityTestSuite.kt
@@ -120,7 +120,7 @@ abstract class SustainabilityTestSuite<TEngine : ApplicationEngine, TConfigurati
                         emptyLine()
                     }.build().use { request ->
                         repeat(repeatCount) {
-                            getOutputStream().writePacket(request.peek())
+                            getOutputStream().writePacket(request.copy())
                             getOutputStream().write(body)
                             getOutputStream().flush()
                         }
diff --git a/ktor-shared/ktor-websockets/jvm/src/io/ktor/websocket/internals/BytePacketUtils.kt b/ktor-shared/ktor-websockets/jvm/src/io/ktor/websocket/internals/BytePacketUtils.kt
index 63df6a0bd..828476dca 100644
--- a/ktor-shared/ktor-websockets/jvm/src/io/ktor/websocket/internals/BytePacketUtils.kt
+++ b/ktor-shared/ktor-websockets/jvm/src/io/ktor/websocket/internals/BytePacketUtils.kt
@@ -7,9 +7,8 @@ package io.ktor.websocket.internals
 import io.ktor.utils.io.core.*
 import kotlinx.io.*
 
-@OptIn(InternalIoApi::class)
 internal fun Source.endsWith(data: ByteArray): Boolean {
-    buffer.copy().apply {
+    copy().apply {
         discard(remaining - data.size)
         return readByteArray().contentEquals(data)
     }
diff --git a/ktor-utils/common/src/io/ktor/util/Base64.kt b/ktor-utils/common/src/io/ktor/util/Base64.kt
index 24177342f..6d56fe00c 100644
--- a/ktor-utils/common/src/io/ktor/util/Base64.kt
+++ b/ktor-utils/common/src/io/ktor/util/Base64.kt
@@ -104,7 +104,7 @@ public fun String.decodeBase64Bytes(): ByteArray = buildPacket {
 public fun Source.decodeBase64Bytes(): Input = buildPacket {
     val data = ByteArray(4)
 
-    while (!exhausted()) {
+    while (remaining > 0) {
         val read = readAvailable(data)
 
         val chunk = data.foldIndexed(0) { index, result, current ->
diff --git a/ktor-utils/common/src/io/ktor/util/ByteChannels.kt b/ktor-utils/common/src/io/ktor/util/ByteChannels.kt
index 59e89c715..91403a67a 100644
--- a/ktor-utils/common/src/io/ktor/util/ByteChannels.kt
+++ b/ktor-utils/common/src/io/ktor/util/ByteChannels.kt
@@ -5,6 +5,7 @@
 package io.ktor.util
 
 import io.ktor.utils.io.*
+import io.ktor.utils.io.core.*
 import io.ktor.utils.io.pool.*
 import kotlinx.coroutines.*
 
@@ -63,8 +64,8 @@ public fun ByteReadChannel.copyToBoth(first: ByteWriteChannel, second: ByteWrite
             while (!isClosedForRead && (!first.isClosedForWrite || !second.isClosedForWrite)) {
                 readRemaining(CHUNK_BUFFER_SIZE).use {
                     try {
-                        first.writePacket(it.peek())
-                        second.writePacket(it.peek())
+                        first.writePacket(it.copy())
+                        second.writePacket(it.copy())
                     } catch (cause: Throwable) {
                         this@copyToBoth.cancel(cause)
                         first.close(cause)
